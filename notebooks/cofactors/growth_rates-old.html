<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Importing multiple plates with different layouts &mdash; Vivarium E. coli 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=8d563738"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Vivarium E. coli
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/composites.html">Composites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/experiments.html">Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs.html">Working with Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/stores.html">Stores</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/api_ref.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Vivarium E. coli</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Importing multiple plates with different layouts</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/cofactors/growth_rates-old.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="k">def</span> <span class="nf">regress</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">yvar</span><span class="p">,</span> <span class="n">xvars</span><span class="p">):</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">yvar</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">xvars</span><span class="p">]</span>
    <span class="n">X</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span>

<span class="k">def</span> <span class="nf">regress_error</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">yvar</span><span class="p">,</span> <span class="n">xvars</span><span class="p">):</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">yvar</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">xvars</span><span class="p">]</span>
    <span class="n">X</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">output</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
    <span class="n">output</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">bse</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">,</span> <span class="s2">&quot;intercept&quot;</span><span class="p">,</span> <span class="s2">&quot;slope_e&quot;</span><span class="p">,</span> <span class="s2">&quot;intercept_e&quot;</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Importing-multiple-plates-with-different-layouts">
<h1>Importing multiple plates with different layouts<a class="headerlink" href="#Importing-multiple-plates-with-different-layouts" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
            <span class="c1"># [&quot;growth_data/cyrus_blue_020824.txt&quot;,</span>
            <span class="c1">#   {&quot;A&quot;: &quot;met&quot;, &quot;B&quot;: &quot;none&quot;, &quot;C&quot;: &quot;B12&quot;, &quot;D&quot;: &quot;Zn&quot;,&quot;E&quot;: &quot;met&quot;, &quot;F&quot;: &quot;none&quot;, &quot;G&quot;: &quot;Zn&quot;, &quot;H&quot;: &quot;B12&quot;},</span>
            <span class="c1">#   [[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;]],</span>
            <span class="c1">#   [[&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;], [&quot;E&quot;, &quot;F&quot;, &quot;G&quot;, &quot;H&quot;]],</span>
            <span class="c1">#   {&quot;YkgM1&quot;: [0, 0], &quot;MG1655&quot;: [1, 0]},</span>
            <span class="c1">#  12],</span>

            <span class="c1">#  [&quot;growth_data/cyrus_pink_020924.txt&quot;,</span>
            <span class="c1">#  {&quot;A&quot;: &quot;met&quot;, &quot;B&quot;: &quot;none&quot;, &quot;C&quot;: &quot;B12&quot;, &quot;D&quot;: &quot;Zn&quot;,&quot;E&quot;: &quot;met+B12&quot;, &quot;F&quot;: &quot;met+Zn&quot;, &quot;G&quot;: &quot;met+B12+Zn&quot;, &quot;H&quot;: &quot;blank&quot;},</span>
            <span class="c1">#  [[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;]],</span>
            <span class="c1">#  [[&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;]],</span>
            <span class="c1">#  {&quot;MG1655&quot;: [0, 0]},</span>
            <span class="c1">#   12],</span>

             <span class="c1"># [&quot;growth_data/cyrus_blue_021324.txt&quot;,</span>
             <span class="c1"># {&quot;A&quot;: &quot;met&quot;, &quot;B&quot;: &quot;none&quot;, &quot;C&quot;: &quot;B12&quot;, &quot;D&quot;: &quot;Zn&quot;,&quot;E&quot;: &quot;met+B12&quot;, &quot;F&quot;: &quot;met+Zn&quot;, &quot;G&quot;: &quot;met+B12+Zn&quot;, &quot;H&quot;: &quot;blank&quot;},</span>
             <span class="c1"># [[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;]],</span>
             <span class="c1"># [[&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;]],</span>
             <span class="c1"># {&quot;MG1655&quot;: [0, 0]},</span>
             <span class="c1">#  12],</span>

             <span class="p">[</span><span class="s2">&quot;growth_data/cyrus_blue_021424.txt&quot;</span><span class="p">,</span>
             <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;met&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;B12&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="s2">&quot;Zn&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="s2">&quot;met+B12&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="s2">&quot;met+Zn&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="s2">&quot;met+B12+Zn&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="s2">&quot;blank&quot;</span><span class="p">},</span>
             <span class="p">[[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">]],</span>
             <span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">]],</span>
             <span class="p">{</span><span class="s2">&quot;MG1655&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]},</span>
              <span class="mi">12</span><span class="p">],</span>
        <span class="p">]</span>




<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>

    <span class="n">fname</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">additive</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">genotype_col</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">genotype_row</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">genotype_combinations</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">n_replicate</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">al</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">additive</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">include_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">al</span> <span class="o">=</span> <span class="n">al</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;Row&quot;</span><span class="p">,</span> <span class="s2">&quot;column_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Additive&quot;</span><span class="p">})</span>
    <span class="n">al</span> <span class="o">=</span> <span class="n">al</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">Plate</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plate </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>

    <span class="n">gl</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">genotype</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">genotype_combinations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="n">gl</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">genotype</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">genotype_row</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">genotype_col</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>

    <span class="n">gl</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">gl</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;column_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;column_1&quot;</span><span class="p">:</span> <span class="s2">&quot;Well&quot;</span><span class="p">})</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">Plate</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plate </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># growth_data/cyrus_mutant_013124.txt</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">Plate</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;Plate 1&quot;</span><span class="p">))</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">N_replicate</span> <span class="o">=</span> <span class="n">n_replicate</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gl</span>
        <span class="n">adf</span> <span class="o">=</span> <span class="n">al</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">df_add</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">df_add</span> <span class="o">=</span> <span class="n">df_add</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">Plate</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plate </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
        <span class="n">df_add</span> <span class="o">=</span> <span class="n">df_add</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">N_replicate</span> <span class="o">=</span> <span class="n">n_replicate</span><span class="p">)</span>
        <span class="n">df_add</span> <span class="o">=</span> <span class="n">df_add</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df_add</span><span class="p">])</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">gdf</span><span class="p">,</span> <span class="n">gl</span><span class="p">])</span>
        <span class="n">adf</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">adf</span><span class="p">,</span> <span class="n">al</span><span class="p">])</span>

<span class="c1"># time conversion</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">to_time</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">minute</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span>

<span class="c1"># get minimum OD measured</span>
<span class="n">init_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.5</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Time&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Plate&quot;</span><span class="p">],</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;Initial_OD&quot;</span><span class="p">)</span>
<span class="n">init_df</span> <span class="o">=</span> <span class="n">init_df</span><span class="o">.</span><span class="n">group_by</span><span class="p">([</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Well&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="n">init_df</span>

<span class="c1"># blank_df.head(3)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 99)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>A1</th><th>A2</th><th>A3</th><th>A4</th><th>A5</th><th>A6</th><th>A7</th><th>A8</th><th>A9</th><th>A10</th><th>A11</th><th>A12</th><th>B1</th><th>B2</th><th>B3</th><th>B4</th><th>B5</th><th>B6</th><th>B7</th><th>B8</th><th>B9</th><th>B10</th><th>B11</th><th>B12</th><th>C1</th><th>C2</th><th>C3</th><th>C4</th><th>C5</th><th>C6</th><th>C7</th><th>C8</th><th>C9</th><th>C10</th><th>C11</th><th>C12</th><th>&hellip;</th><th>F2</th><th>F3</th><th>F4</th><th>F5</th><th>F6</th><th>F7</th><th>F8</th><th>F9</th><th>F10</th><th>F11</th><th>F12</th><th>G1</th><th>G2</th><th>G3</th><th>G4</th><th>G5</th><th>G6</th><th>G7</th><th>G8</th><th>G9</th><th>G10</th><th>G11</th><th>G12</th><th>H1</th><th>H2</th><th>H3</th><th>H4</th><th>H5</th><th>H6</th><th>H7</th><th>H8</th><th>H9</th><th>H10</th><th>H11</th><th>H12</th><th>Plate</th><th>N_replicate</th></tr><tr><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>&hellip;</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>str</td><td>i32</td></tr></thead><tbody><tr><td>0.011111</td><td>0.195</td><td>0.201</td><td>0.206</td><td>0.208</td><td>0.201</td><td>0.19</td><td>0.185</td><td>0.191</td><td>0.178</td><td>0.185</td><td>0.18</td><td>0.181</td><td>0.21</td><td>0.21</td><td>0.205</td><td>0.199</td><td>0.198</td><td>0.2</td><td>0.184</td><td>0.183</td><td>0.181</td><td>0.19</td><td>0.183</td><td>0.19</td><td>0.206</td><td>0.206</td><td>0.203</td><td>0.216</td><td>0.204</td><td>0.187</td><td>0.181</td><td>0.185</td><td>0.189</td><td>0.174</td><td>0.185</td><td>0.189</td><td>&hellip;</td><td>0.207</td><td>0.211</td><td>0.197</td><td>0.198</td><td>0.251</td><td>0.253</td><td>0.194</td><td>0.181</td><td>0.187</td><td>0.178</td><td>0.186</td><td>0.196</td><td>0.203</td><td>0.233</td><td>0.278</td><td>0.203</td><td>0.195</td><td>0.177</td><td>0.181</td><td>0.181</td><td>0.185</td><td>0.185</td><td>0.177</td><td>0.276</td><td>0.279</td><td>0.203</td><td>0.213</td><td>0.219</td><td>0.206</td><td>0.174</td><td>0.174</td><td>0.183</td><td>0.175</td><td>0.174</td><td>0.179</td><td>&quot;Plate 1&quot;</td><td>12</td></tr><tr><td>0.036111</td><td>0.193</td><td>0.201</td><td>0.206</td><td>0.207</td><td>0.2</td><td>0.189</td><td>0.183</td><td>0.19</td><td>0.177</td><td>0.184</td><td>0.179</td><td>0.181</td><td>0.211</td><td>0.211</td><td>0.205</td><td>0.198</td><td>0.198</td><td>0.198</td><td>0.183</td><td>0.182</td><td>0.18</td><td>0.188</td><td>0.183</td><td>0.189</td><td>0.206</td><td>0.206</td><td>0.203</td><td>0.215</td><td>0.203</td><td>0.186</td><td>0.179</td><td>0.184</td><td>0.188</td><td>0.174</td><td>0.185</td><td>0.188</td><td>&hellip;</td><td>0.208</td><td>0.211</td><td>0.197</td><td>0.197</td><td>0.25</td><td>0.253</td><td>0.193</td><td>0.181</td><td>0.186</td><td>0.178</td><td>0.186</td><td>0.196</td><td>0.203</td><td>0.247</td><td>0.278</td><td>0.202</td><td>0.194</td><td>0.176</td><td>0.18</td><td>0.18</td><td>0.185</td><td>0.186</td><td>0.177</td><td>0.279</td><td>0.278</td><td>0.204</td><td>0.213</td><td>0.218</td><td>0.205</td><td>0.174</td><td>0.173</td><td>0.182</td><td>0.175</td><td>0.174</td><td>0.179</td><td>&quot;Plate 1&quot;</td><td>12</td></tr><tr><td>0.061111</td><td>0.192</td><td>0.2</td><td>0.205</td><td>0.207</td><td>0.2</td><td>0.189</td><td>0.183</td><td>0.189</td><td>0.176</td><td>0.184</td><td>0.179</td><td>0.181</td><td>0.212</td><td>0.21</td><td>0.205</td><td>0.198</td><td>0.198</td><td>0.198</td><td>0.183</td><td>0.181</td><td>0.179</td><td>0.188</td><td>0.183</td><td>0.19</td><td>0.206</td><td>0.205</td><td>0.203</td><td>0.214</td><td>0.202</td><td>0.185</td><td>0.179</td><td>0.184</td><td>0.187</td><td>0.174</td><td>0.185</td><td>0.188</td><td>&hellip;</td><td>0.208</td><td>0.211</td><td>0.197</td><td>0.196</td><td>0.251</td><td>0.253</td><td>0.193</td><td>0.18</td><td>0.186</td><td>0.178</td><td>0.185</td><td>0.195</td><td>0.202</td><td>0.269</td><td>0.278</td><td>0.202</td><td>0.193</td><td>0.176</td><td>0.179</td><td>0.18</td><td>0.184</td><td>0.186</td><td>0.177</td><td>0.282</td><td>0.275</td><td>0.203</td><td>0.213</td><td>0.218</td><td>0.205</td><td>0.173</td><td>0.173</td><td>0.182</td><td>0.175</td><td>0.174</td><td>0.179</td><td>&quot;Plate 1&quot;</td><td>12</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># melt to experiments</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;N_replicate&quot;</span><span class="p">],</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">mdf</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Row&quot;</span><span class="p">))</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">mdf</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Column&quot;</span><span class="p">))</span>

<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">adf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Row&quot;</span><span class="p">])</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Well&quot;</span><span class="p">])</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">init_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="s2">&quot;Plate&quot;</span><span class="p">])</span>

<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>   <span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Column&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int32</span><span class="p">)</span>  <span class="o">+</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;N_replicate&quot;</span><span class="p">)</span>  <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span>  <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;N_replicate&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">))</span>

<span class="c1"># mdf = mdf.with_columns(((pl.col(&quot;Column&quot;).cast(pl.Int32)+3) % 4 + 1).alias(&quot;Replicate&quot;))</span>
<span class="c1"># mdf = mdf.with_columns(((pl.col(&quot;Column&quot;).cast(pl.Int32)+11) % 12 + 1).alias(&quot;Replicate&quot;))</span>
<span class="c1"># mdf.group_by([&quot;Plate&quot;,&quot;Additive&quot;,&quot;Genotype&quot;]).size()</span>
<span class="n">mdf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (56_196, 11)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Plate</th><th>N_replicate</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Initial_OD</th><th>Replicate</th></tr><tr><td>f64</td><td>str</td><td>i32</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i32</td></tr></thead><tbody><tr><td>0.011111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.195</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>0.036111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.193</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>0.061111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.192</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>0.086111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.192</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>0.111111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.192</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>0.136111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.192</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>0.161111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.191</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>0.186111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.191</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>0.211111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.191</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>0.236111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.191</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>0.261111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.191</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>0.286111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.191</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>16.436111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>1.048</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr><tr><td>16.461111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>1.049</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr><tr><td>16.486111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>1.048</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr><tr><td>16.511111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>1.049</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr><tr><td>16.536111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>1.05</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr><tr><td>16.561111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>1.05</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr><tr><td>16.586111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>1.05</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr><tr><td>16.611111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>1.051</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr><tr><td>16.636111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>1.053</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr><tr><td>16.661111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>1.052</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr><tr><td>16.686111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>1.053</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr><tr><td>16.711111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;G12&quot;</td><td>null</td><td>&quot;G&quot;</td><td>&quot;12&quot;</td><td>&quot;met+B12+Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.173</td><td>12</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span>
    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Initial_OD&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">),</span>
<span class="p">])</span>

<span class="n">mdf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 12)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Plate</th><th>N_replicate</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Initial_OD</th><th>Replicate</th><th>Initial_corrected_OD</th></tr><tr><td>f64</td><td>str</td><td>i32</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i32</td><td>f64</td></tr></thead><tbody><tr><td>0.011111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.195</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td><td>0.008</td></tr><tr><td>0.036111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.193</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td><td>0.006</td></tr><tr><td>0.061111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.192</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td><td>0.005</td></tr><tr><td>0.086111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.192</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td><td>0.005</td></tr><tr><td>0.111111</td><td>&quot;Plate 1&quot;</td><td>12</td><td>&quot;A1&quot;</td><td>0.192</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;MG1655&quot;</td><td>0.187</td><td>1</td><td>0.005</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;talk&quot;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Row&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Column&quot;</span><span class="p">,</span> \
            <span class="c1"># row=&quot;Genotype&quot;,</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="c1"># col_wrap=4,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x10574b1f0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_5_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_5_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.5</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">f_mdf</span> <span class="o">=</span> <span class="n">f_mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span>
    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">())</span>
    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">f_mdf</span> <span class="o">=</span> <span class="n">f_mdf</span><span class="o">.</span><span class="n">drop_nulls</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Column&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Row&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
                <span class="n">data</span><span class="o">=</span><span class="n">f_mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">))</span>

<span class="c1"># plt.savefig(&quot;weird_plate.png&quot;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[7], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> <span class="ansi-yellow-bg">warnings</span><span style="color: rgb(98,98,98)">.</span>catch_warnings():
<span class="ansi-green-intense-fg ansi-bold">      2</span>     warnings<span style="color: rgb(98,98,98)">.</span>simplefilter(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">ignore</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      4</span>     sns<span style="color: rgb(98,98,98)">.</span>relplot(x<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Time</span><span style="color: rgb(175,0,0)">&#34;</span>, y<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Log_initial_corrected_OD</span><span style="color: rgb(175,0,0)">&#34;</span>, hue<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Plate</span><span style="color: rgb(175,0,0)">&#34;</span>, kind<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">line</span><span style="color: rgb(175,0,0)">&#34;</span>, row<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Column</span><span style="color: rgb(175,0,0)">&#34;</span>, col<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Row</span><span style="color: rgb(175,0,0)">&#34;</span>, height<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">3</span>, \
<span class="ansi-green-intense-fg ansi-bold">      5</span>                 data<span style="color: rgb(98,98,98)">=</span>f_mdf<span style="color: rgb(98,98,98)">.</span>filter(pl<span style="color: rgb(98,98,98)">.</span>col(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Time</span><span style="color: rgb(175,0,0)">&#34;</span>) <span style="color: rgb(98,98,98)">&lt;</span> <span style="color: rgb(98,98,98)">20</span>))

<span class="ansi-red-fg">NameError</span>: name &#39;warnings&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gr_df</span> <span class="o">=</span> <span class="n">f_mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">minimum_start_times</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">4.5</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">([</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Well&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">)</span>
<span class="n">minimum_end_times</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">([</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Well&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)</span>

<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_start_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Well&quot;</span><span class="p">])</span>
<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_end_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Well&quot;</span><span class="p">])</span>
<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)))</span>
<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">))</span>
<span class="n">gr_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># regress and pick top x</span>
<span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">gr_df</span> \
<span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">,</span><span class="s1">&#39;Replicate&#39;</span><span class="p">,</span> <span class="s1">&#39;Plate&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress_error</span><span class="p">,</span> <span class="s1">&#39;Log_initial_corrected_OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">top_gr</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">predicted_gr</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;slope&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">,</span> <span class="s1">&#39;Plate&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">nth</span><span class="p">[</span><span class="n">M</span><span class="p">:</span><span class="n">N</span><span class="p">])</span>
<span class="n">top_gr</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>

<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">top_gr</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="s2">&quot;Genotype&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
                <span class="n">data</span><span class="o">=</span><span class="n">gr_df</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># plt.savefig(&quot;plates.png&quot;)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">gr_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">scatter_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.relplot(x=&quot;Time&quot;, y=&quot;Log_initial_corrected_OD&quot;, kind=&quot;line&quot;, row=&quot;Replicate&quot;, col=&quot;Additive&quot;, height=3, \</span>
<span class="c1">#             data=f_mdf.filter(pl.col(&quot;Time&quot;) &lt; 15))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.set_context(&quot;paper&quot;)</span>

<span class="c1"># sns.relplot(x=&quot;Time&quot;, y=&quot;Initial_corrected_OD&quot;, hue=&quot;Plate&quot;, style=&quot;Replicate&quot;, kind=&quot;scatter&quot;, col=&quot;Additive&quot;, \</span>
<span class="c1">#             # row=&quot;Genotype&quot;, height=3, \</span>
<span class="c1">#             col_wrap=4,</span>
<span class="c1">#             data=mdf)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">gr_df</span> \
<span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">,</span><span class="s1">&#39;Replicate&#39;</span><span class="p">,</span> <span class="s1">&#39;Plate&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress_error</span><span class="p">,</span> <span class="s1">&#39;Log_initial_corrected_OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span>
<span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span>
<span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">predicted_gr</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>


<span class="n">gr_mean_std</span> <span class="o">=</span> <span class="n">predicted_gr</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;slope&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">]})</span>
<span class="n">gr_mean_std</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">gr_mean_std</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">gr_mean_std</span><span class="p">[</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">gr_mean_std</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span>
<span class="c1"># gr_mean_std = gr_mean_std.reset_index()</span>

<span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span>
<span class="n">predicted_gr</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="n">filter_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">predicted_gr</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Genotype&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;MG1655&quot;</span><span class="p">))</span>
    <span class="n">filter_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">filter_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span>
                    <span class="n">height</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
    <span class="n">g</span><span class="o">.</span><span class="n">map_dataframe</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">,</span>
                    <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Minimum doubling time, average (bar) and individual measurements (point), n=3&quot;</span><span class="p">)</span>
    <span class="c1"># g.map(sns.stripplot, &quot;sex&quot;, &quot;total_bill&quot;, &quot;smoker&quot;,</span>
    <span class="c1">#       palette=[&quot;#404040&quot;], alpha=0.6, dodge=True)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

   <span class="c1">#  g.savefig(&quot;story1.png&quot;)</span>
</pre></div>
</div>
</div>
</section>
<section id="Importing-multiple-plates">
<h1>Importing multiple plates<a class="headerlink" href="#Importing-multiple-plates" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># files = [&quot;growth_data/cyrus_mutant_020124.txt&quot;, &quot;growth_data/cyrus_mutants_020224.txt&quot;, &quot;growth_data/cyrus_mutants_020624.txt&quot;]</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;growth_data/cyrus_blue_020824.txt&quot;</span><span class="p">,</span>
        <span class="c1"># &quot;growth_data/cyrus_pink_020924.txt&quot;</span>
        <span class="p">]</span>
<span class="c1"># files = [&quot;growth_data/cyrus_mutant_020124.txt&quot;,</span>
<span class="c1">#          &quot;growth_data/cyrus_mutants_020224.txt&quot;,</span>
<span class="c1">#          &quot;growth_data/cyrus_mutants_020624.txt&quot;,</span>
<span class="c1">#          &quot;growth_data/cyrus_indigo_020724.txt&quot;,</span>
<span class="c1">#          &quot;growth_data/cyrus_pink_020724.txt&quot;,</span>
<span class="c1">#          &quot;growth_data/cyrus_blue_failed_020724.txt&quot;</span>
<span class="c1">#         ]</span>

<span class="c1"># additive = {&quot;A&quot;: &quot;met&quot;, &quot;B&quot;: &quot;none&quot;, &quot;C&quot;: &quot;B12&quot;, &quot;D&quot;: &quot;Zn&quot;,&quot;E&quot;: &quot;met+B12&quot;, &quot;F&quot;: &quot;met+Zn&quot;, &quot;G&quot;: &quot;met+B12+Zn&quot;, &quot;H&quot;: &quot;blank&quot;}</span>
<span class="n">additive</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;met&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;B12&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="s2">&quot;Zn&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="s2">&quot;met&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="s2">&quot;Zn&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="s2">&quot;B12&quot;</span><span class="p">}</span>
<span class="n">adf</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">additive</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">include_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">adf</span> <span class="o">=</span> <span class="n">adf</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;Row&quot;</span><span class="p">,</span> <span class="s2">&quot;column_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Additive&quot;</span><span class="p">})</span>

<span class="n">genotype_row</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">]]</span>
<span class="c1"># genotype_col = [[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;], [&quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;], [&quot;9&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;]]</span>
<span class="n">genotype_col</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">]]</span>
<span class="c1"># genotype_row = [[&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;]]</span>

<span class="c1"># genotype_combinations = {&quot;YkgM1&quot;: [0, 0], &quot;YkgM2&quot;: [0, 1], &quot;MetH&quot;: [0, 2], &quot;Zur&quot;: [1, 0], &quot;MetE&quot;: [1, 1], &quot;MG1655&quot;: [1, 2]}</span>
<span class="n">genotype_combinations</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;YkgM1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;MG1655&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}</span>
<span class="c1"># genotype_combinations = {&quot;MG1655&quot;: [0, 0]}</span>

<span class="n">gdf</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">genotype</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">genotype_combinations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

    <span class="n">gdf</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">genotype</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">genotype_row</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">genotype_col</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>

<span class="n">gdf</span>

<span class="n">gdf</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;column_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;column_1&quot;</span><span class="p">:</span> <span class="s2">&quot;Well&quot;</span><span class="p">})</span>


<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># growth_data/cyrus_mutant_013124.txt</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">Plate</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;Plate 1&quot;</span><span class="p">))</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">df_add</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">df_add</span> <span class="o">=</span> <span class="n">df_add</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">Plate</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plate </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
        <span class="n">df_add</span> <span class="o">=</span> <span class="n">df_add</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df_add</span><span class="p">])</span>

<span class="c1"># time conversion</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">to_time</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">minute</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span>


<span class="c1"># blank_df.head(3)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[176]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mdf.n_unique(subset=[&quot;Plate&quot;,&quot;Additive&quot;,&quot;Genotype&quot;])</span>

<span class="c1"># mdf.group_by([&quot;Plate&quot;,&quot;Additive&quot;,&quot;Genotype&quot;]).n_unique()</span>

<span class="c1"># mdf.to_pandas().groupby([&quot;Plate&quot;,&quot;Additive&quot;,&quot;Genotype&quot;]).count()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[177]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial measurement</span>
<span class="n">init_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Time&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">:</span><span class="mi">200</span><span class="p">,:]</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Plate&quot;</span><span class="p">],</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;Initial_OD&quot;</span><span class="p">)</span>
<span class="n">init_df</span> <span class="o">=</span> <span class="n">init_df</span><span class="o">.</span><span class="n">group_by</span><span class="p">([</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Well&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="c1"># melt to experiments</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;Plate&quot;</span><span class="p">],</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">mdf</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Row&quot;</span><span class="p">))</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">mdf</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Column&quot;</span><span class="p">))</span>

<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">adf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Row&quot;</span><span class="p">)</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">init_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="s2">&quot;Plate&quot;</span><span class="p">])</span>

<span class="c1"># mdf = mdf.with_columns(((pl.col(&quot;Column&quot;).cast(pl.Int32)+3) % 4 + 1).alias(&quot;Replicate&quot;))</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Column&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int32</span><span class="p">)</span><span class="o">+</span><span class="mi">11</span><span class="p">)</span> <span class="o">%</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">))</span>

<span class="n">mdf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[177]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 10)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Plate</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Initial_OD</th><th>Replicate</th></tr><tr><td>f64</td><td>str</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i32</td></tr></thead><tbody><tr><td>0.011111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.096</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td></tr><tr><td>0.036111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.096</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td></tr><tr><td>0.061111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.096</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td></tr><tr><td>0.086111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.096</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td></tr><tr><td>0.111111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.096</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[178]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span>
    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Initial_OD&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">),</span>
    <span class="c1"># (</span>
    <span class="c1">#     (pl.col(&quot;OD&quot;) - pl.col(&quot;Background_OD&quot;)) / (pl.col(&quot;Initial_OD&quot;) - pl.col(&quot;Background_OD&quot;))</span>
    <span class="c1"># ).alias(&quot;Normalized_OD&quot;)</span>
<span class="p">])</span>

<span class="n">mdf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[178]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 11)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Plate</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Initial_OD</th><th>Replicate</th><th>Initial_corrected_OD</th></tr><tr><td>f64</td><td>str</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i32</td><td>f64</td></tr></thead><tbody><tr><td>0.011111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.096</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.0</td></tr><tr><td>0.036111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.096</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.0</td></tr><tr><td>0.061111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.096</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.0</td></tr><tr><td>0.086111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.096</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.0</td></tr><tr><td>0.111111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.096</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.0</td></tr></tbody></table></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[179]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> \
            <span class="c1"># row=&quot;Genotype&quot;, height=3, \</span>
            <span class="n">col_wrap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[179]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x2e1e8bf40&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_22_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_22_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[180]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">f_mdf</span> <span class="o">=</span> <span class="n">f_mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span>
    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">())</span>
    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">f_mdf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[180]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 12)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Plate</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Initial_OD</th><th>Replicate</th><th>Initial_corrected_OD</th><th>Log_initial_corrected_OD</th></tr><tr><td>f64</td><td>str</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i32</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>2.211111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.097</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.001</td><td>-6.907755</td></tr><tr><td>2.336111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.097</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.001</td><td>-6.907755</td></tr><tr><td>2.361111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.097</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.001</td><td>-6.907755</td></tr><tr><td>2.536111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.097</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.001</td><td>-6.907755</td></tr><tr><td>2.561111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.097</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.001</td><td>-6.907755</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[181]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.relplot(x=&quot;Time&quot;, y=&quot;Log_initial_corrected_OD&quot;, hue=&quot;Plate&quot;, style=&quot;Replicate&quot;, kind=&quot;line&quot;, col=&quot;Additive&quot;, row=&quot;Genotype&quot;, height=3, \</span>
<span class="c1">#             data=f_mdf.filter(pl.col(&quot;Time&quot;) &lt; 10), alpha=0.3)</span>

<span class="c1"># sns.relplot(x=&quot;Time&quot;, y=&quot;Log_initial_corrected_OD&quot;, hue=&quot;Additive&quot;, kind=&quot;line&quot;, row=&quot;Replicate&quot;, col=&quot;Genotype&quot;, height=3, \</span>
<span class="c1">#             data=f_mdf.filter(pl.col(&quot;Time&quot;) &lt; 15), alpha=0.3)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">f_mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">))</span>

<span class="c1"># plt.savefig(&quot;Plate_comparison.png&quot;)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[181]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x2e1e8a2f0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_24_2.png" src="../../_images/notebooks_cofactors_growth_rates-old_24_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[182]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># good_wells = [&quot;A7&quot;, &quot;A8&quot;, &quot;A10&quot;,</span>
<span class="c1">#               &quot;B8&quot;, &quot;B9&quot;, &quot;B10&quot;, &quot;B12&quot;,</span>
<span class="c1">#               &quot;C9&quot;, &quot;C10&quot;, &quot;C11&quot;, &quot;C12&quot;,</span>
<span class="c1">#               &quot;D1&quot;,&quot;D5&quot;, &quot;D8&quot;, &quot;D12&quot;,</span>
<span class="c1">#               &quot;E10&quot;, &quot;E11&quot;,</span>
<span class="c1">#               &quot;F3&quot;, &quot;F4&quot;, &quot;F5&quot;, &quot;F7&quot;, &quot;F8&quot;, &quot;F9&quot;,</span>
<span class="c1">#               &quot;G9&quot;, &quot;G10&quot;]</span>

<span class="c1"># f_mdf = f_mdf.filter(pl.col(&quot;Well&quot;).is_in(good_wells))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[183]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># removing_outliers = f_mdf.filter(</span>
<span class="c1">#     (</span>
<span class="c1">#         (pl.col(&quot;Column&quot;).is_in([&quot;9&quot;, &quot;10&quot;, &quot;11&quot;])) &amp; (pl.col(&quot;Genotype&quot;) == &quot;MG1655&quot;)</span>
<span class="c1">#     )</span>
<span class="c1">#     # |</span>
<span class="c1">#     # (</span>
<span class="c1">#     #     (pl.col(&quot;Column&quot;).is_in([&quot;8&quot;, &quot;9&quot;,&quot;11&quot;, &quot;12&quot;])) &amp; (pl.col(&quot;Genotype&quot;) == &quot;YkgM1&quot;)</span>
<span class="c1">#     # )</span>
<span class="c1"># )</span>

<span class="c1"># f_mdf = removing_outliers</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[184]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gr_df</span> <span class="o">=</span> <span class="n">f_mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">minimum_start_times</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">4.5</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">([</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Well&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">)</span>
<span class="n">minimum_end_times</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">([</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Well&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)</span>

<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_start_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Well&quot;</span><span class="p">])</span>
<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_end_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Well&quot;</span><span class="p">])</span>
<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)))</span>
<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">))</span>
<span class="n">gr_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[184]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 15)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Plate</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Initial_OD</th><th>Replicate</th><th>Initial_corrected_OD</th><th>Log_initial_corrected_OD</th><th>Time_exp_start</th><th>Time_exp_end</th><th>Corrected_time</th></tr><tr><td>f64</td><td>str</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i32</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>5.961111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.109</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.013</td><td>-4.342806</td><td>5.936111</td><td>7.736111</td><td>0.025</td></tr><tr><td>5.986111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.109</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.013</td><td>-4.342806</td><td>5.936111</td><td>7.736111</td><td>0.05</td></tr><tr><td>6.011111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.108</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.012</td><td>-4.422849</td><td>5.936111</td><td>7.736111</td><td>0.075</td></tr><tr><td>6.036111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.111</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.015</td><td>-4.199705</td><td>5.936111</td><td>7.736111</td><td>0.1</td></tr><tr><td>6.061111</td><td>&quot;Plate 1&quot;</td><td>&quot;A1&quot;</td><td>0.11</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.096</td><td>1</td><td>0.014</td><td>-4.268698</td><td>5.936111</td><td>7.736111</td><td>0.125</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[185]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># regress and pick top x</span>
<span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">gr_df</span> \
<span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">,</span><span class="s1">&#39;Replicate&#39;</span><span class="p">,</span> <span class="s1">&#39;Plate&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress_error</span><span class="p">,</span> <span class="s1">&#39;Log_initial_corrected_OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">top_gr</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">predicted_gr</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;slope&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">,</span> <span class="s1">&#39;Plate&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">nth</span><span class="p">[:</span><span class="n">N</span><span class="p">])</span>
<span class="n">top_gr</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>

<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">top_gr</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="s2">&quot;Genotype&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/var/folders/dx/0239zgvj0tgf46b5h8l7v_fc0000gn/T/ipykernel_88080/1459300289.py:3: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .to_pandas().groupby([&#39;Genotype&#39;, &#39;Additive&#39;,&#39;Replicate&#39;, &#39;Plate&#39;]).apply(regress_error, &#39;Log_initial_corrected_OD&#39;, [&#39;Corrected_time&#39;]).reset_index()
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[186]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.relplot(x=&quot;Corrected_time&quot;, y=&quot;Log_initial_corrected_OD&quot;, hue=&quot;Plate&quot;, kind=&quot;line&quot;, col=&quot;Additive&quot;, style=&quot;Replicate&quot;, row=&quot;Genotype&quot;, height=3, \</span>
<span class="c1">#             data=gr_df)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">gr_df</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># plt.savefig(&quot;shaky.png&quot;)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[186]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.0, 3.0)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_29_2.png" src="../../_images/notebooks_cofactors_growth_rates-old_29_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[187]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">gr_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">scatter_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[187]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.0, 3.0)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_30_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_30_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[188]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.lmplot(x=&quot;Corrected_time&quot;, y=&quot;Log_initial_corrected_OD&quot;, hue=&quot;Additive&quot;, row=&quot;Genotype&quot;, height=3, aspect=2, \</span>
<span class="c1">#             data=gr_df.to_pandas(), scatter_kws = {&quot;alpha&quot;: 0.1})</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">gr_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">scatter_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[188]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.0, 1.5)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_31_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_31_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[189]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">gr_df</span> \
<span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">,</span><span class="s1">&#39;Replicate&#39;</span><span class="p">,</span> <span class="s1">&#39;Plate&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress_error</span><span class="p">,</span> <span class="s1">&#39;Log_initial_corrected_OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span>
<span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span>
<span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">predicted_gr</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>


<span class="n">gr_mean_std</span> <span class="o">=</span> <span class="n">predicted_gr</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;slope&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">]})</span>
<span class="n">gr_mean_std</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">gr_mean_std</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">gr_mean_std</span><span class="p">[</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">gr_mean_std</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span>
<span class="c1"># gr_mean_std = gr_mean_std.reset_index()</span>

<span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span>
<span class="n">predicted_gr</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/var/folders/dx/0239zgvj0tgf46b5h8l7v_fc0000gn/T/ipykernel_88080/544480332.py:2: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .to_pandas().groupby([&#39;Genotype&#39;, &#39;Additive&#39;,&#39;Replicate&#39;, &#39;Plate&#39;]).apply(regress_error, &#39;Log_initial_corrected_OD&#39;, [&#39;Corrected_time&#39;])
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[189]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Genotype</th>
      <th>Additive</th>
      <th>Replicate</th>
      <th>Plate</th>
      <th>slope</th>
      <th>intercept</th>
      <th>slope_e</th>
      <th>intercept_e</th>
      <th>doubling_time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>MG1655</td>
      <td>B12</td>
      <td>9</td>
      <td>Plate 1</td>
      <td>1.052209</td>
      <td>-4.419591</td>
      <td>0.008307</td>
      <td>0.006565</td>
      <td>0.658754</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MG1655</td>
      <td>B12</td>
      <td>10</td>
      <td>Plate 1</td>
      <td>1.024863</td>
      <td>-4.455974</td>
      <td>0.007288</td>
      <td>0.006075</td>
      <td>0.676332</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MG1655</td>
      <td>B12</td>
      <td>11</td>
      <td>Plate 1</td>
      <td>1.042112</td>
      <td>-4.427508</td>
      <td>0.006717</td>
      <td>0.005405</td>
      <td>0.665137</td>
    </tr>
    <tr>
      <th>3</th>
      <td>MG1655</td>
      <td>B12</td>
      <td>12</td>
      <td>Plate 1</td>
      <td>0.980806</td>
      <td>-4.472615</td>
      <td>0.005575</td>
      <td>0.004888</td>
      <td>0.706712</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MG1655</td>
      <td>Zn</td>
      <td>9</td>
      <td>Plate 1</td>
      <td>1.067921</td>
      <td>-4.464097</td>
      <td>0.015907</td>
      <td>0.012800</td>
      <td>0.649062</td>
    </tr>
    <tr>
      <th>5</th>
      <td>MG1655</td>
      <td>Zn</td>
      <td>10</td>
      <td>Plate 1</td>
      <td>1.096946</td>
      <td>-4.428540</td>
      <td>0.010703</td>
      <td>0.008304</td>
      <td>0.631888</td>
    </tr>
    <tr>
      <th>6</th>
      <td>MG1655</td>
      <td>Zn</td>
      <td>11</td>
      <td>Plate 1</td>
      <td>1.085093</td>
      <td>-4.447638</td>
      <td>0.012119</td>
      <td>0.009577</td>
      <td>0.638791</td>
    </tr>
    <tr>
      <th>7</th>
      <td>MG1655</td>
      <td>Zn</td>
      <td>12</td>
      <td>Plate 1</td>
      <td>1.027932</td>
      <td>-4.430726</td>
      <td>0.013266</td>
      <td>0.010483</td>
      <td>0.674312</td>
    </tr>
    <tr>
      <th>8</th>
      <td>MG1655</td>
      <td>met</td>
      <td>9</td>
      <td>Plate 1</td>
      <td>1.129564</td>
      <td>-4.428696</td>
      <td>0.014093</td>
      <td>0.010730</td>
      <td>0.613641</td>
    </tr>
    <tr>
      <th>9</th>
      <td>MG1655</td>
      <td>met</td>
      <td>10</td>
      <td>Plate 1</td>
      <td>1.105056</td>
      <td>-4.486548</td>
      <td>0.011958</td>
      <td>0.009450</td>
      <td>0.627251</td>
    </tr>
    <tr>
      <th>10</th>
      <td>MG1655</td>
      <td>met</td>
      <td>11</td>
      <td>Plate 1</td>
      <td>1.105664</td>
      <td>-4.439126</td>
      <td>0.012263</td>
      <td>0.009513</td>
      <td>0.626906</td>
    </tr>
    <tr>
      <th>11</th>
      <td>MG1655</td>
      <td>met</td>
      <td>12</td>
      <td>Plate 1</td>
      <td>1.147954</td>
      <td>-4.475173</td>
      <td>0.010972</td>
      <td>0.008353</td>
      <td>0.603811</td>
    </tr>
    <tr>
      <th>12</th>
      <td>MG1655</td>
      <td>none</td>
      <td>8</td>
      <td>Plate 1</td>
      <td>1.069149</td>
      <td>-4.477823</td>
      <td>0.006812</td>
      <td>0.005482</td>
      <td>0.648317</td>
    </tr>
    <tr>
      <th>13</th>
      <td>MG1655</td>
      <td>none</td>
      <td>9</td>
      <td>Plate 1</td>
      <td>0.996380</td>
      <td>-4.446801</td>
      <td>0.011419</td>
      <td>0.009848</td>
      <td>0.695665</td>
    </tr>
    <tr>
      <th>14</th>
      <td>MG1655</td>
      <td>none</td>
      <td>11</td>
      <td>Plate 1</td>
      <td>0.998742</td>
      <td>-4.481440</td>
      <td>0.008407</td>
      <td>0.007250</td>
      <td>0.694020</td>
    </tr>
    <tr>
      <th>15</th>
      <td>MG1655</td>
      <td>none</td>
      <td>12</td>
      <td>Plate 1</td>
      <td>0.991389</td>
      <td>-4.448749</td>
      <td>0.006410</td>
      <td>0.005435</td>
      <td>0.699167</td>
    </tr>
    <tr>
      <th>16</th>
      <td>YkgM1</td>
      <td>B12</td>
      <td>1</td>
      <td>Plate 1</td>
      <td>1.010489</td>
      <td>-4.476996</td>
      <td>0.015948</td>
      <td>0.013063</td>
      <td>0.685952</td>
    </tr>
    <tr>
      <th>17</th>
      <td>YkgM1</td>
      <td>B12</td>
      <td>4</td>
      <td>Plate 1</td>
      <td>0.952422</td>
      <td>-4.445246</td>
      <td>0.007475</td>
      <td>0.006770</td>
      <td>0.727774</td>
    </tr>
    <tr>
      <th>18</th>
      <td>YkgM1</td>
      <td>B12</td>
      <td>7</td>
      <td>Plate 1</td>
      <td>0.955161</td>
      <td>-4.475216</td>
      <td>0.005611</td>
      <td>0.005163</td>
      <td>0.725686</td>
    </tr>
    <tr>
      <th>19</th>
      <td>YkgM1</td>
      <td>B12</td>
      <td>8</td>
      <td>Plate 1</td>
      <td>0.954956</td>
      <td>-4.468661</td>
      <td>0.005275</td>
      <td>0.004854</td>
      <td>0.725842</td>
    </tr>
    <tr>
      <th>20</th>
      <td>YkgM1</td>
      <td>Zn</td>
      <td>4</td>
      <td>Plate 1</td>
      <td>0.949987</td>
      <td>-4.490807</td>
      <td>0.006271</td>
      <td>0.005408</td>
      <td>0.729639</td>
    </tr>
    <tr>
      <th>21</th>
      <td>YkgM1</td>
      <td>Zn</td>
      <td>5</td>
      <td>Plate 1</td>
      <td>0.966430</td>
      <td>-4.502874</td>
      <td>0.012065</td>
      <td>0.010928</td>
      <td>0.717224</td>
    </tr>
    <tr>
      <th>22</th>
      <td>YkgM1</td>
      <td>Zn</td>
      <td>7</td>
      <td>Plate 1</td>
      <td>0.957499</td>
      <td>-4.490227</td>
      <td>0.005124</td>
      <td>0.004493</td>
      <td>0.723914</td>
    </tr>
    <tr>
      <th>23</th>
      <td>YkgM1</td>
      <td>Zn</td>
      <td>8</td>
      <td>Plate 1</td>
      <td>0.957732</td>
      <td>-4.468593</td>
      <td>0.006313</td>
      <td>0.005808</td>
      <td>0.723738</td>
    </tr>
    <tr>
      <th>24</th>
      <td>YkgM1</td>
      <td>met</td>
      <td>9</td>
      <td>Plate 1</td>
      <td>0.938304</td>
      <td>-4.369875</td>
      <td>0.037560</td>
      <td>0.029682</td>
      <td>0.738724</td>
    </tr>
    <tr>
      <th>25</th>
      <td>YkgM1</td>
      <td>met</td>
      <td>10</td>
      <td>Plate 1</td>
      <td>0.947228</td>
      <td>-4.384148</td>
      <td>0.025550</td>
      <td>0.021666</td>
      <td>0.731763</td>
    </tr>
    <tr>
      <th>26</th>
      <td>YkgM1</td>
      <td>met</td>
      <td>11</td>
      <td>Plate 1</td>
      <td>0.951164</td>
      <td>-4.409433</td>
      <td>0.036458</td>
      <td>0.029863</td>
      <td>0.728736</td>
    </tr>
    <tr>
      <th>27</th>
      <td>YkgM1</td>
      <td>met</td>
      <td>12</td>
      <td>Plate 1</td>
      <td>0.943033</td>
      <td>-4.451282</td>
      <td>0.020344</td>
      <td>0.016958</td>
      <td>0.735019</td>
    </tr>
    <tr>
      <th>28</th>
      <td>YkgM1</td>
      <td>none</td>
      <td>3</td>
      <td>Plate 1</td>
      <td>0.931821</td>
      <td>-4.480416</td>
      <td>0.005665</td>
      <td>0.005295</td>
      <td>0.743863</td>
    </tr>
    <tr>
      <th>29</th>
      <td>YkgM1</td>
      <td>none</td>
      <td>5</td>
      <td>Plate 1</td>
      <td>0.930161</td>
      <td>-4.451306</td>
      <td>0.005927</td>
      <td>0.005540</td>
      <td>0.745191</td>
    </tr>
    <tr>
      <th>30</th>
      <td>YkgM1</td>
      <td>none</td>
      <td>6</td>
      <td>Plate 1</td>
      <td>0.961484</td>
      <td>-4.464242</td>
      <td>0.005637</td>
      <td>0.005106</td>
      <td>0.720914</td>
    </tr>
    <tr>
      <th>31</th>
      <td>YkgM1</td>
      <td>none</td>
      <td>11</td>
      <td>Plate 1</td>
      <td>0.948286</td>
      <td>-4.456880</td>
      <td>0.011500</td>
      <td>0.010415</td>
      <td>0.730948</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[190]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">predicted_gr</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[190]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.0, 1.0)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_33_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_33_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[191]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">predicted_gr</span><span class="p">)</span> <span class="c1">#.filter((pl.col(&quot;Plate&quot;) == &quot;Plate 2&quot;))</span>
<span class="n">filter_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">filter_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
<span class="n">g</span><span class="o">.</span><span class="n">map_dataframe</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Minimum doubling time, average (bar) and individual measurements (point), n=3&quot;</span><span class="p">)</span>
<span class="c1"># g.map(sns.stripplot, &quot;sex&quot;, &quot;total_bill&quot;, &quot;smoker&quot;,</span>
<span class="c1">#       palette=[&quot;#404040&quot;], alpha=0.6, dodge=True)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">g</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;story1.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/Users/cyrus/.pyenv/versions/viv-10/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_34_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_34_1.png" />
</div>
</div>
</section>
<section id="Mut-day-two">
<h1>Mut day two<a class="headerlink" href="#Mut-day-two" title="Link to this heading">ÔÉÅ</a></h1>
<section id="Importing-data">
<h2>Importing data<a class="headerlink" href="#Importing-data" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[320]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">additive</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;met&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;B12&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="s2">&quot;Zn&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="s2">&quot;met&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="s2">&quot;B12&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="s2">&quot;Zn&quot;</span><span class="p">}</span>
<span class="n">adf</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">additive</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">include_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">adf</span> <span class="o">=</span> <span class="n">adf</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;Row&quot;</span><span class="p">,</span> <span class="s2">&quot;column_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Additive&quot;</span><span class="p">})</span>

<span class="n">genotype_row</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">]]</span>
<span class="n">genotype_col</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">]]</span>

<span class="n">genotype_combinations</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;YkgM1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;YkgM2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;MetH&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Zur&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;MetE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;MG1655&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]}</span>

<span class="n">gdf</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">genotype</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">genotype_combinations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

    <span class="n">gdf</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">genotype</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">genotype_row</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">genotype_col</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>

<span class="n">gdf</span>

<span class="n">gdf</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;column_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;column_1&quot;</span><span class="p">:</span> <span class="s2">&quot;Well&quot;</span><span class="p">})</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/cyrus_mutant_020124.txt&quot;</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">blank_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/cyrus_mutant_blanks_020124.txt&quot;</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">blank_df</span> <span class="o">=</span> <span class="n">blank_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;T600&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">include_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">blank_df</span> <span class="o">=</span> <span class="n">blank_df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="s2">&quot;column_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Background_OD&quot;</span><span class="p">})</span>
<span class="n">blank_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[320]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 2)</small><table border="1" class="dataframe"><thead><tr><th>Well</th><th>Background_OD</th></tr><tr><td>str</td><td>f64</td></tr></thead><tbody><tr><td>&quot;A1&quot;</td><td>0.094238</td></tr><tr><td>&quot;A2&quot;</td><td>0.137952</td></tr><tr><td>&quot;A3&quot;</td><td>0.179333</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[321]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># time conversion</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">to_time</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">minute</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span>

<span class="c1"># initial measurement</span>
<span class="n">init_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">,:]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">include_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">init_df</span> <span class="o">=</span> <span class="n">init_df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="s2">&quot;column_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Initial_OD&quot;</span><span class="p">})</span>

<span class="c1"># melt to experiments</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">mdf</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Row&quot;</span><span class="p">))</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">mdf</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Column&quot;</span><span class="p">))</span>

<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">adf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Row&quot;</span><span class="p">)</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">blank_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">init_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>

<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Column&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int32</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">))</span>

<span class="n">mdf</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[321]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (66_240, 10)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Background_OD</th><th>Initial_OD</th><th>Replicate</th></tr><tr><td>f64</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>f64</td><td>i32</td></tr></thead><tbody><tr><td>0.011111</td><td>&quot;A1&quot;</td><td>0.171</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>0.036111</td><td>&quot;A1&quot;</td><td>0.171</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>0.061111</td><td>&quot;A1&quot;</td><td>0.169</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>0.086111</td><td>&quot;A1&quot;</td><td>0.168</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>0.111111</td><td>&quot;A1&quot;</td><td>0.169</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>0.136111</td><td>&quot;A1&quot;</td><td>0.169</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>0.161111</td><td>&quot;A1&quot;</td><td>0.167</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>0.186111</td><td>&quot;A1&quot;</td><td>0.168</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>0.211111</td><td>&quot;A1&quot;</td><td>0.167</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>0.236111</td><td>&quot;A1&quot;</td><td>0.166</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>0.261111</td><td>&quot;A1&quot;</td><td>0.166</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>0.286111</td><td>&quot;A1&quot;</td><td>0.166</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>16.961111</td><td>&quot;H12&quot;</td><td>1.149</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr><tr><td>16.986111</td><td>&quot;H12&quot;</td><td>1.147</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr><tr><td>17.011111</td><td>&quot;H12&quot;</td><td>1.15</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr><tr><td>17.036111</td><td>&quot;H12&quot;</td><td>1.149</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr><tr><td>17.061111</td><td>&quot;H12&quot;</td><td>1.151</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr><tr><td>17.086111</td><td>&quot;H12&quot;</td><td>1.15</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr><tr><td>17.111111</td><td>&quot;H12&quot;</td><td>1.152</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr><tr><td>17.136111</td><td>&quot;H12&quot;</td><td>1.153</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr><tr><td>17.161111</td><td>&quot;H12&quot;</td><td>1.152</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr><tr><td>17.186111</td><td>&quot;H12&quot;</td><td>1.152</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr><tr><td>17.211111</td><td>&quot;H12&quot;</td><td>1.152</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr><tr><td>17.236111</td><td>&quot;H12&quot;</td><td>1.153</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[322]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span>
    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Background_OD&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Background_corrected_OD&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Initial_OD&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">),</span>
    <span class="c1"># (</span>
    <span class="c1">#     (pl.col(&quot;OD&quot;) - pl.col(&quot;Background_OD&quot;)) / (pl.col(&quot;Initial_OD&quot;) - pl.col(&quot;Background_OD&quot;))</span>
    <span class="c1"># ).alias(&quot;Normalized_OD&quot;)</span>
<span class="p">])</span>

<span class="n">mdf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[322]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 12)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Background_OD</th><th>Initial_OD</th><th>Replicate</th><th>Background_corrected_OD</th><th>Initial_corrected_OD</th></tr><tr><td>f64</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>f64</td><td>i32</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>0.011111</td><td>&quot;A1&quot;</td><td>0.171</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.076762</td><td>0.005</td></tr><tr><td>0.036111</td><td>&quot;A1&quot;</td><td>0.171</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.076762</td><td>0.005</td></tr><tr><td>0.061111</td><td>&quot;A1&quot;</td><td>0.169</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.074762</td><td>0.003</td></tr><tr><td>0.086111</td><td>&quot;A1&quot;</td><td>0.168</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.073762</td><td>0.002</td></tr><tr><td>0.111111</td><td>&quot;A1&quot;</td><td>0.169</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.074762</td><td>0.003</td></tr></tbody></table></div></div>
</div>
</section>
<section id="Plot-raw-data">
<h2>Plot raw data<a class="headerlink" href="#Plot-raw-data" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[323]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[323]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x3d33765c0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_41_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_41_1.png" />
</div>
</div>
</section>
<section id="Get-growth-rates">
<h2>Get growth rates<a class="headerlink" href="#Get-growth-rates" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[324]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">f_mdf</span> <span class="o">=</span> <span class="n">f_mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span>
    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Initial_corrected_OD&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">())</span>
    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">f_mdf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[324]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 13)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Background_OD</th><th>Initial_OD</th><th>Replicate</th><th>Background_corrected_OD</th><th>Initial_corrected_OD</th><th>Log_initial_corrected_OD</th></tr><tr><td>f64</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>f64</td><td>i32</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>0.011111</td><td>&quot;A1&quot;</td><td>0.171</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.076762</td><td>0.005</td><td>-5.298317</td></tr><tr><td>0.036111</td><td>&quot;A1&quot;</td><td>0.171</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.076762</td><td>0.005</td><td>-5.298317</td></tr><tr><td>0.061111</td><td>&quot;A1&quot;</td><td>0.169</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.074762</td><td>0.003</td><td>-5.809143</td></tr><tr><td>0.086111</td><td>&quot;A1&quot;</td><td>0.168</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.073762</td><td>0.002</td><td>-6.214608</td></tr><tr><td>0.111111</td><td>&quot;A1&quot;</td><td>0.169</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.074762</td><td>0.003</td><td>-5.809143</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[325]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">f_mdf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[325]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x412c3c760&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_44_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_44_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[326]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gr_df</span> <span class="o">=</span> <span class="n">f_mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">minimum_start_times</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">4.5</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">)</span>
<span class="n">minimum_end_times</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)</span>

<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_start_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_end_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)))</span>
<span class="n">gr_df</span> <span class="o">=</span> <span class="n">gr_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">))</span>
<span class="n">gr_df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[326]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (8_150, 16)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Background_OD</th><th>Initial_OD</th><th>Replicate</th><th>Background_corrected_OD</th><th>Initial_corrected_OD</th><th>Log_initial_corrected_OD</th><th>Time_exp_start</th><th>Time_exp_end</th><th>Corrected_time</th></tr><tr><td>f64</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>f64</td><td>i32</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>1.811111</td><td>&quot;A1&quot;</td><td>0.178</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.083762</td><td>0.012</td><td>-4.422849</td><td>1.786111</td><td>3.911111</td><td>0.025</td></tr><tr><td>1.836111</td><td>&quot;A1&quot;</td><td>0.178</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.083762</td><td>0.012</td><td>-4.422849</td><td>1.786111</td><td>3.911111</td><td>0.05</td></tr><tr><td>1.861111</td><td>&quot;A1&quot;</td><td>0.178</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.083762</td><td>0.012</td><td>-4.422849</td><td>1.786111</td><td>3.911111</td><td>0.075</td></tr><tr><td>1.886111</td><td>&quot;A1&quot;</td><td>0.18</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.085762</td><td>0.014</td><td>-4.268698</td><td>1.786111</td><td>3.911111</td><td>0.1</td></tr><tr><td>1.911111</td><td>&quot;A1&quot;</td><td>0.18</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.085762</td><td>0.014</td><td>-4.268698</td><td>1.786111</td><td>3.911111</td><td>0.125</td></tr><tr><td>1.936111</td><td>&quot;A1&quot;</td><td>0.18</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.085762</td><td>0.014</td><td>-4.268698</td><td>1.786111</td><td>3.911111</td><td>0.15</td></tr><tr><td>1.961111</td><td>&quot;A1&quot;</td><td>0.18</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.085762</td><td>0.014</td><td>-4.268698</td><td>1.786111</td><td>3.911111</td><td>0.175</td></tr><tr><td>1.986111</td><td>&quot;A1&quot;</td><td>0.181</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.086762</td><td>0.015</td><td>-4.199705</td><td>1.786111</td><td>3.911111</td><td>0.2</td></tr><tr><td>2.011111</td><td>&quot;A1&quot;</td><td>0.181</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.086762</td><td>0.015</td><td>-4.199705</td><td>1.786111</td><td>3.911111</td><td>0.225</td></tr><tr><td>2.036111</td><td>&quot;A1&quot;</td><td>0.182</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.087762</td><td>0.016</td><td>-4.135167</td><td>1.786111</td><td>3.911111</td><td>0.25</td></tr><tr><td>2.061111</td><td>&quot;A1&quot;</td><td>0.182</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.087762</td><td>0.016</td><td>-4.135167</td><td>1.786111</td><td>3.911111</td><td>0.275</td></tr><tr><td>2.086111</td><td>&quot;A1&quot;</td><td>0.183</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>0.094238</td><td>0.166</td><td>1</td><td>0.088762</td><td>0.017</td><td>-4.074542</td><td>1.786111</td><td>3.911111</td><td>0.3</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>3.286111</td><td>&quot;H12&quot;</td><td>0.261</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.158857</td><td>0.093</td><td>-2.375156</td><td>1.886111</td><td>3.586111</td><td>1.4</td></tr><tr><td>3.311111</td><td>&quot;H12&quot;</td><td>0.26</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.157857</td><td>0.092</td><td>-2.385967</td><td>1.886111</td><td>3.586111</td><td>1.425</td></tr><tr><td>3.336111</td><td>&quot;H12&quot;</td><td>0.267</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.164857</td><td>0.099</td><td>-2.312635</td><td>1.886111</td><td>3.586111</td><td>1.45</td></tr><tr><td>3.361111</td><td>&quot;H12&quot;</td><td>0.27</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.167857</td><td>0.102</td><td>-2.282782</td><td>1.886111</td><td>3.586111</td><td>1.475</td></tr><tr><td>3.386111</td><td>&quot;H12&quot;</td><td>0.268</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.165857</td><td>0.1</td><td>-2.302585</td><td>1.886111</td><td>3.586111</td><td>1.5</td></tr><tr><td>3.411111</td><td>&quot;H12&quot;</td><td>0.275</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.172857</td><td>0.107</td><td>-2.234926</td><td>1.886111</td><td>3.586111</td><td>1.525</td></tr><tr><td>3.436111</td><td>&quot;H12&quot;</td><td>0.274</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.171857</td><td>0.106</td><td>-2.244316</td><td>1.886111</td><td>3.586111</td><td>1.55</td></tr><tr><td>3.461111</td><td>&quot;H12&quot;</td><td>0.28</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.177857</td><td>0.112</td><td>-2.189256</td><td>1.886111</td><td>3.586111</td><td>1.575</td></tr><tr><td>3.486111</td><td>&quot;H12&quot;</td><td>0.281</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.178857</td><td>0.113</td><td>-2.180367</td><td>1.886111</td><td>3.586111</td><td>1.6</td></tr><tr><td>3.511111</td><td>&quot;H12&quot;</td><td>0.285</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.182857</td><td>0.117</td><td>-2.145581</td><td>1.886111</td><td>3.586111</td><td>1.625</td></tr><tr><td>3.536111</td><td>&quot;H12&quot;</td><td>0.291</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.188857</td><td>0.123</td><td>-2.095571</td><td>1.886111</td><td>3.586111</td><td>1.65</td></tr><tr><td>3.561111</td><td>&quot;H12&quot;</td><td>0.297</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>0.102143</td><td>0.168</td><td>4</td><td>0.194857</td><td>0.129</td><td>-2.047943</td><td>1.886111</td><td>3.586111</td><td>1.675</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[327]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">gr_df</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[327]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.0, 4.0)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_46_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_46_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[328]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">gr_df</span> \
<span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">,</span><span class="s1">&#39;Replicate&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress_error</span><span class="p">,</span> <span class="s1">&#39;Log_initial_corrected_OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span>
<span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span>
<span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">predicted_gr</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>


<span class="n">gr_mean_std</span> <span class="o">=</span> <span class="n">predicted_gr</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;slope&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">]})</span>
<span class="n">gr_mean_std</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">gr_mean_std</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">gr_mean_std</span><span class="p">[</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">gr_mean_std</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span>
<span class="c1"># gr_mean_std = gr_mean_std.reset_index()</span>

<span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span>
<span class="n">predicted_gr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[328]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Genotype</th>
      <th>Additive</th>
      <th>Replicate</th>
      <th>slope</th>
      <th>intercept</th>
      <th>slope_e</th>
      <th>intercept_e</th>
      <th>doubling_time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>MG1655</td>
      <td>B12</td>
      <td>1</td>
      <td>1.324157</td>
      <td>-4.212585</td>
      <td>0.034644</td>
      <td>0.034378</td>
      <td>0.523463</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MG1655</td>
      <td>B12</td>
      <td>2</td>
      <td>1.427234</td>
      <td>-4.281178</td>
      <td>0.031208</td>
      <td>0.030067</td>
      <td>0.485658</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MG1655</td>
      <td>B12</td>
      <td>3</td>
      <td>1.066257</td>
      <td>-4.564200</td>
      <td>0.009580</td>
      <td>0.012825</td>
      <td>0.650075</td>
    </tr>
    <tr>
      <th>3</th>
      <td>MG1655</td>
      <td>B12</td>
      <td>4</td>
      <td>1.347420</td>
      <td>-4.479041</td>
      <td>0.013150</td>
      <td>0.013619</td>
      <td>0.514426</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MG1655</td>
      <td>Zn</td>
      <td>1</td>
      <td>1.431332</td>
      <td>-4.309911</td>
      <td>0.028843</td>
      <td>0.028621</td>
      <td>0.484267</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Zur</td>
      <td>met</td>
      <td>4</td>
      <td>1.190536</td>
      <td>-4.325590</td>
      <td>0.014427</td>
      <td>0.017232</td>
      <td>0.582215</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Zur</td>
      <td>none</td>
      <td>1</td>
      <td>0.986011</td>
      <td>-4.028845</td>
      <td>0.013609</td>
      <td>0.016844</td>
      <td>0.702981</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Zur</td>
      <td>none</td>
      <td>2</td>
      <td>1.039713</td>
      <td>-4.312025</td>
      <td>0.012869</td>
      <td>0.017600</td>
      <td>0.666672</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Zur</td>
      <td>none</td>
      <td>3</td>
      <td>1.050107</td>
      <td>-4.238075</td>
      <td>0.013530</td>
      <td>0.017918</td>
      <td>0.660073</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Zur</td>
      <td>none</td>
      <td>4</td>
      <td>1.132044</td>
      <td>-4.259421</td>
      <td>0.013438</td>
      <td>0.016051</td>
      <td>0.612297</td>
    </tr>
  </tbody>
</table>
<p>92 rows √ó 8 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[329]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">predicted_gr</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
<span class="n">g</span><span class="o">.</span><span class="n">map_dataframe</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Median growth rate (bar) and individual measurements (point)&quot;</span><span class="p">)</span>
<span class="c1"># g.map(sns.stripplot, &quot;sex&quot;, &quot;total_bill&quot;, &quot;smoker&quot;,</span>
<span class="c1">#       palette=[&quot;#404040&quot;], alpha=0.6, dodge=True)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_48_0.png" src="../../_images/notebooks_cofactors_growth_rates-old_48_0.png" />
</div>
</div>
</section>
<section id="Slope-fits">
<h2>Slope fits<a class="headerlink" href="#Slope-fits" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[330]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rerun_fits</span> <span class="o">=</span> <span class="kc">False</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">wells</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f_mdf</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">timepoints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f_mdf</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">window</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">well_fits</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">if</span> <span class="n">rerun_fits</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>

        <span class="n">fits</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timepoints</span><span class="p">):</span>


            <span class="n">cur_df</span> <span class="o">=</span> <span class="n">f_mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">well</span><span class="p">)</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_in</span><span class="p">(</span><span class="n">timepoints</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">window</span><span class="p">])</span> <span class="p">)</span>
            <span class="p">)</span>

            <span class="n">fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">cur_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">],</span><span class="n">cur_df</span><span class="p">[</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">fits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>

            <span class="c1"># print(f&quot;for well {well} at time {time}, the instantenous slope is {fit}&quot;)</span>

        <span class="n">well_fits</span><span class="p">[</span><span class="n">well</span><span class="p">]</span> <span class="o">=</span> <span class="n">fits</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[331]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rerun_fit_plots</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">if</span> <span class="n">rerun_fit_plots</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">wf_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">well_fits</span><span class="p">)</span>
    <span class="n">wf_df</span> <span class="o">=</span> <span class="n">wf_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wf_df</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Step&quot;</span><span class="p">))</span>


    <span class="c1"># melt to experiments</span>
    <span class="n">wf_df</span> <span class="o">=</span> <span class="n">wf_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Step&quot;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;Slope&quot;</span><span class="p">)</span>
    <span class="n">wf_df</span> <span class="o">=</span> <span class="n">wf_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">wf_df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Row&quot;</span><span class="p">))</span>
    <span class="n">wf_df</span> <span class="o">=</span> <span class="n">wf_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">wf_df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Column&quot;</span><span class="p">))</span>

    <span class="n">wf_df</span> <span class="o">=</span> <span class="n">wf_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">adf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Row&quot;</span><span class="p">)</span>
    <span class="n">wf_df</span> <span class="o">=</span> <span class="n">wf_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>

    <span class="n">wf_df</span> <span class="o">=</span> <span class="n">wf_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Column&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int32</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">))</span>

    <span class="n">wf_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Step&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Slope&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">wf_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Step&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Step&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Slope&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>  <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Slope&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.5</span><span class="p">)</span>
            <span class="p">)</span>
           <span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Test-of-linear-fit">
<h2>Test of linear fit<a class="headerlink" href="#Test-of-linear-fit" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[332]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Log_initial_corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">gr_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">scatter_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">})</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[332]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.0, 4.0)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_53_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_53_1.png" />
</div>
</div>
</section>
</section>
<section id="Mut">
<h1>Mut<a class="headerlink" href="#Mut" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[333]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">additive</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;met&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;B12&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="s2">&quot;Zn&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="s2">&quot;met&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="s2">&quot;B12&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="s2">&quot;Zn&quot;</span><span class="p">}</span>
<span class="n">adf</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">additive</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">include_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">adf</span> <span class="o">=</span> <span class="n">adf</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;Row&quot;</span><span class="p">,</span> <span class="s2">&quot;column_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Additive&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[334]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">genotype_row</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">]]</span>
<span class="n">genotype_col</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">]]</span>

<span class="n">genotype_combinations</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;YkgM1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;YkgM2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;MetH&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Zur&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;MetE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;MG1655&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]}</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[335]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">genotype</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">genotype_combinations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

    <span class="n">gdf</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">genotype</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">genotype_row</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">genotype_col</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>

<span class="n">gdf</span>

<span class="n">gdf</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;column_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="s2">&quot;column_1&quot;</span><span class="p">:</span> <span class="s2">&quot;Well&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[336]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/cyrus_mutant_013124.txt&quot;</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[336]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 97)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>A1</th><th>A2</th><th>A3</th><th>A4</th><th>A5</th><th>A6</th><th>A7</th><th>A8</th><th>A9</th><th>A10</th><th>A11</th><th>A12</th><th>B1</th><th>B2</th><th>B3</th><th>B4</th><th>B5</th><th>B6</th><th>B7</th><th>B8</th><th>B9</th><th>B10</th><th>B11</th><th>B12</th><th>C1</th><th>C2</th><th>C3</th><th>C4</th><th>C5</th><th>C6</th><th>C7</th><th>C8</th><th>C9</th><th>C10</th><th>C11</th><th>C12</th><th>&hellip;</th><th>E12</th><th>F1</th><th>F2</th><th>F3</th><th>F4</th><th>F5</th><th>F6</th><th>F7</th><th>F8</th><th>F9</th><th>F10</th><th>F11</th><th>F12</th><th>G1</th><th>G2</th><th>G3</th><th>G4</th><th>G5</th><th>G6</th><th>G7</th><th>G8</th><th>G9</th><th>G10</th><th>G11</th><th>G12</th><th>H1</th><th>H2</th><th>H3</th><th>H4</th><th>H5</th><th>H6</th><th>H7</th><th>H8</th><th>H9</th><th>H10</th><th>H11</th><th>H12</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>&hellip;</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;0:01:02&quot;</td><td>0.172</td><td>0.159</td><td>0.127</td><td>0.12</td><td>0.146</td><td>0.111</td><td>0.106</td><td>0.108</td><td>0.147</td><td>0.144</td><td>0.125</td><td>0.107</td><td>0.125</td><td>0.128</td><td>0.172</td><td>0.173</td><td>0.123</td><td>0.165</td><td>0.154</td><td>0.124</td><td>0.121</td><td>0.166</td><td>0.177</td><td>0.149</td><td>0.111</td><td>0.148</td><td>0.113</td><td>0.174</td><td>0.119</td><td>0.196</td><td>0.115</td><td>0.109</td><td>0.16</td><td>0.176</td><td>0.115</td><td>0.2</td><td>&hellip;</td><td>0.158</td><td>0.126</td><td>0.175</td><td>0.13</td><td>0.129</td><td>0.13</td><td>0.182</td><td>0.178</td><td>0.139</td><td>0.14</td><td>0.174</td><td>0.148</td><td>0.14</td><td>0.116</td><td>0.111</td><td>0.111</td><td>0.162</td><td>0.119</td><td>0.156</td><td>0.136</td><td>0.156</td><td>0.154</td><td>0.149</td><td>0.108</td><td>0.107</td><td>0.129</td><td>0.161</td><td>0.122</td><td>0.121</td><td>0.139</td><td>0.164</td><td>0.13</td><td>0.133</td><td>0.162</td><td>0.153</td><td>0.142</td><td>0.124</td></tr><tr><td>&quot;0:04:02&quot;</td><td>0.171</td><td>0.157</td><td>0.126</td><td>0.121</td><td>0.146</td><td>0.11</td><td>0.106</td><td>0.107</td><td>0.147</td><td>0.144</td><td>0.125</td><td>0.107</td><td>0.125</td><td>0.126</td><td>0.171</td><td>0.177</td><td>0.123</td><td>0.163</td><td>0.154</td><td>0.124</td><td>0.121</td><td>0.163</td><td>0.176</td><td>0.146</td><td>0.112</td><td>0.148</td><td>0.113</td><td>0.174</td><td>0.112</td><td>0.195</td><td>0.113</td><td>0.109</td><td>0.16</td><td>0.174</td><td>0.113</td><td>0.199</td><td>&hellip;</td><td>0.158</td><td>0.126</td><td>0.174</td><td>0.129</td><td>0.128</td><td>0.13</td><td>0.181</td><td>0.179</td><td>0.14</td><td>0.139</td><td>0.173</td><td>0.147</td><td>0.138</td><td>0.117</td><td>0.11</td><td>0.111</td><td>0.162</td><td>0.119</td><td>0.156</td><td>0.134</td><td>0.155</td><td>0.153</td><td>0.148</td><td>0.108</td><td>0.107</td><td>0.129</td><td>0.161</td><td>0.123</td><td>0.122</td><td>0.136</td><td>0.164</td><td>0.13</td><td>0.132</td><td>0.166</td><td>0.159</td><td>0.151</td><td>0.125</td></tr><tr><td>&quot;0:07:02&quot;</td><td>0.17</td><td>0.157</td><td>0.126</td><td>0.12</td><td>0.145</td><td>0.11</td><td>0.105</td><td>0.107</td><td>0.147</td><td>0.143</td><td>0.123</td><td>0.106</td><td>0.124</td><td>0.126</td><td>0.168</td><td>0.178</td><td>0.123</td><td>0.164</td><td>0.153</td><td>0.123</td><td>0.121</td><td>0.163</td><td>0.175</td><td>0.145</td><td>0.111</td><td>0.147</td><td>0.112</td><td>0.173</td><td>0.111</td><td>0.195</td><td>0.112</td><td>0.109</td><td>0.158</td><td>0.173</td><td>0.112</td><td>0.199</td><td>&hellip;</td><td>0.157</td><td>0.126</td><td>0.173</td><td>0.128</td><td>0.127</td><td>0.129</td><td>0.18</td><td>0.178</td><td>0.139</td><td>0.139</td><td>0.172</td><td>0.149</td><td>0.137</td><td>0.116</td><td>0.111</td><td>0.111</td><td>0.161</td><td>0.119</td><td>0.155</td><td>0.134</td><td>0.155</td><td>0.154</td><td>0.149</td><td>0.107</td><td>0.106</td><td>0.129</td><td>0.16</td><td>0.123</td><td>0.121</td><td>0.135</td><td>0.164</td><td>0.13</td><td>0.132</td><td>0.164</td><td>0.143</td><td>0.134</td><td>0.123</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[337]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># time conversion</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">to_time</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">minute</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span>

<span class="c1"># zero by first measurement</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

<span class="c1"># melt to experiments</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Row&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Column&quot;</span><span class="p">))</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">mdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">adf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Row&quot;</span><span class="p">)</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">mdf</span>

<span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Column&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int32</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">))</span>
<span class="n">mdf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[337]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 8)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Replicate</th></tr><tr><td>f64</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>i32</td></tr></thead><tbody><tr><td>1.15</td><td>&quot;A1&quot;</td><td>0.001</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td></tr><tr><td>1.2</td><td>&quot;A1&quot;</td><td>0.001</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td></tr><tr><td>1.25</td><td>&quot;A1&quot;</td><td>0.001</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[338]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[338]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x42a476fb0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_60_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_60_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[339]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[340]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[340]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x42c9741c0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_62_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_62_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[341]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">minimum_start_times</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">)</span>
<span class="n">minimum_end_times</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)</span>

<span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_start_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_end_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)))</span>
<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">))</span>

<span class="c1"># correct all od values to start at 0</span>
<span class="c1"># start_od = gr_time_filter.group_by(&quot;Well&quot;).agg(pl.min(&quot;OD&quot;).alias(&quot;Start_OD&quot;)).sort(&quot;Start_OD&quot;)</span>
<span class="c1"># gr_time_filter = gr_time_filter.join(start_od, on=&quot;Well&quot;)</span>
<span class="c1"># gr_time_filter = gr_time_filter.with_columns((pl.col(&quot;OD&quot;) - pl.col(&quot;Start_OD&quot;)).alias(&quot;Corrected_OD&quot;))</span>

<span class="c1"># correct by linear fit</span>

<span class="c1">#This is what you need</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Well&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress</span><span class="p">,</span> <span class="s1">&#39;OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">correction_offset</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">correction_offset</span><span class="p">)</span>

<span class="n">gr_time_filter</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[341]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6_469, 11)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Row</th><th>Column</th><th>Additive</th><th>Genotype</th><th>Replicate</th><th>Time_exp_start</th><th>Time_exp_end</th><th>Corrected_time</th></tr><tr><td>f64</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>i32</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>2.5</td><td>&quot;A1&quot;</td><td>-3.912023</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.05</td></tr><tr><td>2.55</td><td>&quot;A1&quot;</td><td>-3.863233</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.1</td></tr><tr><td>2.6</td><td>&quot;A1&quot;</td><td>-3.816713</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.15</td></tr><tr><td>2.65</td><td>&quot;A1&quot;</td><td>-3.729701</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.2</td></tr><tr><td>2.7</td><td>&quot;A1&quot;</td><td>-3.688879</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.25</td></tr><tr><td>2.75</td><td>&quot;A1&quot;</td><td>-3.611918</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.3</td></tr><tr><td>2.8</td><td>&quot;A1&quot;</td><td>-3.540459</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.35</td></tr><tr><td>2.85</td><td>&quot;A1&quot;</td><td>-3.473768</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.4</td></tr><tr><td>2.9</td><td>&quot;A1&quot;</td><td>-3.442019</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.45</td></tr><tr><td>2.95</td><td>&quot;A1&quot;</td><td>-3.381395</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.5</td></tr><tr><td>3.0</td><td>&quot;A1&quot;</td><td>-3.296837</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.55</td></tr><tr><td>3.05</td><td>&quot;A1&quot;</td><td>-3.244194</td><td>&quot;A&quot;</td><td>&quot;1&quot;</td><td>&quot;met&quot;</td><td>&quot;YkgM1&quot;</td><td>1</td><td>2.45</td><td>5.75</td><td>0.6</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>4.0</td><td>&quot;H12&quot;</td><td>-1.398367</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.2</td></tr><tr><td>4.05</td><td>&quot;H12&quot;</td><td>-1.410587</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.25</td></tr><tr><td>4.1</td><td>&quot;H12&quot;</td><td>-1.406497</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.3</td></tr><tr><td>4.15</td><td>&quot;H12&quot;</td><td>-1.335601</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.35</td></tr><tr><td>4.2</td><td>&quot;H12&quot;</td><td>-1.309333</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.4</td></tr><tr><td>4.25</td><td>&quot;H12&quot;</td><td>-1.305636</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.45</td></tr><tr><td>4.3</td><td>&quot;H12&quot;</td><td>-1.301953</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.5</td></tr><tr><td>4.35</td><td>&quot;H12&quot;</td><td>-1.294627</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.55</td></tr><tr><td>4.4</td><td>&quot;H12&quot;</td><td>-1.272966</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.6</td></tr><tr><td>4.45</td><td>&quot;H12&quot;</td><td>-1.145704</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.65</td></tr><tr><td>4.5</td><td>&quot;H12&quot;</td><td>-1.148854</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.7</td></tr><tr><td>4.55</td><td>&quot;H12&quot;</td><td>-1.090644</td><td>&quot;H&quot;</td><td>&quot;12&quot;</td><td>&quot;Zn&quot;</td><td>&quot;MG1655&quot;</td><td>4</td><td>1.8</td><td>4.6</td><td>2.75</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[342]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">gr_time_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[342]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x42be5d3f0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_64_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_64_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[343]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
           <span class="n">data</span><span class="o">=</span><span class="n">gr_time_filter</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">scatter_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[343]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x3d8fba320&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_65_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_65_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[344]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">gr_time_filter</span> \
<span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">,</span><span class="s1">&#39;Replicate&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress_error</span><span class="p">,</span> <span class="s1">&#39;OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span>
<span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">predicted_gr</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span>
<span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">predicted_gr</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>


<span class="n">gr_mean_std</span> <span class="o">=</span> <span class="n">predicted_gr</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;slope&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">]})</span>
<span class="n">gr_mean_std</span><span class="p">[</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">gr_mean_std</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span>  <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span>
<span class="n">gr_mean_std</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[344]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">slope</th>
      <th>doubling_time</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th></th>
    </tr>
    <tr>
      <th>Genotype</th>
      <th>Additive</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">MG1655</th>
      <th>B12</th>
      <td>0.922611</td>
      <td>0.026839</td>
      <td>0.751289</td>
    </tr>
    <tr>
      <th>Zn</th>
      <td>0.947496</td>
      <td>0.154998</td>
      <td>0.731557</td>
    </tr>
    <tr>
      <th>met</th>
      <td>0.929794</td>
      <td>0.082714</td>
      <td>0.745484</td>
    </tr>
    <tr>
      <th>none</th>
      <td>0.838549</td>
      <td>0.140036</td>
      <td>0.826603</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">MetE</th>
      <th>B12</th>
      <td>0.941972</td>
      <td>0.075341</td>
      <td>0.735847</td>
    </tr>
    <tr>
      <th>Zn</th>
      <td>0.686730</td>
      <td>0.100918</td>
      <td>1.009345</td>
    </tr>
    <tr>
      <th>met</th>
      <td>0.814380</td>
      <td>0.068374</td>
      <td>0.851135</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">MetH</th>
      <th>B12</th>
      <td>0.886773</td>
      <td>0.058650</td>
      <td>0.781651</td>
    </tr>
    <tr>
      <th>Zn</th>
      <td>0.903215</td>
      <td>0.061184</td>
      <td>0.767422</td>
    </tr>
    <tr>
      <th>met</th>
      <td>0.871909</td>
      <td>0.070997</td>
      <td>0.794976</td>
    </tr>
    <tr>
      <th>none</th>
      <td>0.701928</td>
      <td>0.124873</td>
      <td>0.987490</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">YkgM1</th>
      <th>B12</th>
      <td>0.790357</td>
      <td>0.110978</td>
      <td>0.877005</td>
    </tr>
    <tr>
      <th>Zn</th>
      <td>0.764328</td>
      <td>0.053613</td>
      <td>0.906871</td>
    </tr>
    <tr>
      <th>met</th>
      <td>0.884611</td>
      <td>0.032048</td>
      <td>0.783562</td>
    </tr>
    <tr>
      <th>none</th>
      <td>0.700347</td>
      <td>0.073838</td>
      <td>0.989720</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">YkgM2</th>
      <th>B12</th>
      <td>0.835925</td>
      <td>0.021437</td>
      <td>0.829198</td>
    </tr>
    <tr>
      <th>Zn</th>
      <td>0.703355</td>
      <td>0.046622</td>
      <td>0.985487</td>
    </tr>
    <tr>
      <th>met</th>
      <td>0.835545</td>
      <td>0.034440</td>
      <td>0.829575</td>
    </tr>
    <tr>
      <th>none</th>
      <td>0.700234</td>
      <td>0.071475</td>
      <td>0.989880</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Zur</th>
      <th>B12</th>
      <td>0.845047</td>
      <td>0.083319</td>
      <td>0.820247</td>
    </tr>
    <tr>
      <th>Zn</th>
      <td>0.801663</td>
      <td>0.044125</td>
      <td>0.864637</td>
    </tr>
    <tr>
      <th>met</th>
      <td>0.799204</td>
      <td>0.053327</td>
      <td>0.867297</td>
    </tr>
    <tr>
      <th>none</th>
      <td>0.689725</td>
      <td>0.084765</td>
      <td>1.004961</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[345]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">predicted_gr</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
<span class="n">g</span><span class="o">.</span><span class="n">map_dataframe</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Genotype&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;doubling_time&quot;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># g.map(sns.stripplot, &quot;sex&quot;, &quot;total_bill&quot;, &quot;smoker&quot;,</span>
<span class="c1">#       palette=[&quot;#404040&quot;], alpha=0.6, dodge=True)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_67_0.png" src="../../_images/notebooks_cofactors_growth_rates-old_67_0.png" />
</div>
</div>
</section>
<section id="Reanalyzing-the-old-plate-lol">
<h1>Reanalyzing the old plate lol<a class="headerlink" href="#Reanalyzing-the-old-plate-lol" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[346]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plate 2</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/cyrus_012624.csv&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>

<span class="c1"># time conversion</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">to_time</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">minute</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span>

<span class="c1"># zero by first measurement</span>
<span class="c1"># df = df.with_columns([pl.col(c) - df[0, c] for c in df.columns])</span>

<span class="c1"># melt to experiments</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Experiment&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">())</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[347]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># join with experiment type</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">,</span> <span class="s2">&quot;Abb&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="s2">&quot;Additive&quot;</span><span class="p">]</span>
<span class="n">conversion</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;Rrm&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich + met, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;met&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;Rr&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;RrZ&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met + Zn, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;zinc&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;Rrb&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met + B12, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;B12&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;rm&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich + met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;met&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;rz&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;zinc&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;B12&quot;</span><span class="p">]]</span>

<span class="n">exp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<span class="n">exp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span>

<span class="n">exp</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[347]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (8, 5)</small><table border="1" class="dataframe"><thead><tr><th>Experiment</th><th>Abb</th><th>Description</th><th>Pre-met</th><th>Additive</th></tr><tr><td>str</td><td>str</td><td>str</td><td>bool</td><td>str</td></tr></thead><tbody><tr><td>&quot;A&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td></tr><tr><td>&quot;B&quot;</td><td>&quot;Rr&quot;</td><td>&quot;Rich - met, ++‚Ä¶</td><td>true</td><td>&quot;none&quot;</td></tr><tr><td>&quot;C&quot;</td><td>&quot;RrZ&quot;</td><td>&quot;Rich - met + Z‚Ä¶</td><td>true</td><td>&quot;zinc&quot;</td></tr><tr><td>&quot;D&quot;</td><td>&quot;Rrb&quot;</td><td>&quot;Rich - met + B‚Ä¶</td><td>true</td><td>&quot;B12&quot;</td></tr><tr><td>&quot;E&quot;</td><td>&quot;rm&quot;</td><td>&quot;Rich + met, --‚Ä¶</td><td>false</td><td>&quot;met&quot;</td></tr><tr><td>&quot;F&quot;</td><td>&quot;r&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;none&quot;</td></tr><tr><td>&quot;G&quot;</td><td>&quot;rz&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;zinc&quot;</td></tr><tr><td>&quot;H&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td></tr></tbody></table></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[348]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Experiment&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[349]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[349]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x43420b0a0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_72_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_72_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[350]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">minimum_start_times</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">)</span>
<span class="n">minimum_end_times</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)</span>

<span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_start_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_end_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)))</span>
<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">))</span>

<span class="c1"># correct all od values to start at 0</span>
<span class="c1"># start_od = gr_time_filter.group_by(&quot;Well&quot;).agg(pl.min(&quot;OD&quot;).alias(&quot;Start_OD&quot;)).sort(&quot;Start_OD&quot;)</span>
<span class="c1"># gr_time_filter = gr_time_filter.join(start_od, on=&quot;Well&quot;)</span>
<span class="c1"># gr_time_filter = gr_time_filter.with_columns((pl.col(&quot;OD&quot;) - pl.col(&quot;Start_OD&quot;)).alias(&quot;Corrected_OD&quot;))</span>

<span class="c1"># correct by linear fit</span>

<span class="c1">#This is what you need</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Well&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress</span><span class="p">,</span> <span class="s1">&#39;OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">correction_offset</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">correction_offset</span><span class="p">)</span>

<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">correction_offset</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;intercept&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Corrected_OD&quot;</span><span class="p">))</span>

<span class="n">gr_time_filter</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[350]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1_041, 15)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Experiment</th><th>Replicate</th><th>Abb</th><th>Description</th><th>Pre-met</th><th>Additive</th><th>Time_exp_start</th><th>Time_exp_end</th><th>Corrected_time</th><th>Corrected_time_right</th><th>intercept</th><th>Corrected_OD</th></tr><tr><td>f64</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>bool</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>1.436111</td><td>&quot;A6&quot;</td><td>-0.872274</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.05</td><td>0.640944</td><td>-0.886354</td><td>0.01408</td></tr><tr><td>1.486111</td><td>&quot;A6&quot;</td><td>-0.796288</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.1</td><td>0.640944</td><td>-0.886354</td><td>0.090066</td></tr><tr><td>1.536111</td><td>&quot;A6&quot;</td><td>-0.783072</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.15</td><td>0.640944</td><td>-0.886354</td><td>0.103282</td></tr><tr><td>1.586111</td><td>&quot;A6&quot;</td><td>-0.787458</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.2</td><td>0.640944</td><td>-0.886354</td><td>0.098896</td></tr><tr><td>1.636111</td><td>&quot;A6&quot;</td><td>-0.733969</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.25</td><td>0.640944</td><td>-0.886354</td><td>0.152385</td></tr><tr><td>1.686111</td><td>&quot;A6&quot;</td><td>-0.721547</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.3</td><td>0.640944</td><td>-0.886354</td><td>0.164807</td></tr><tr><td>1.736111</td><td>&quot;A6&quot;</td><td>-0.648174</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.35</td><td>0.640944</td><td>-0.886354</td><td>0.23818</td></tr><tr><td>1.786111</td><td>&quot;A6&quot;</td><td>-0.60148</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.4</td><td>0.640944</td><td>-0.886354</td><td>0.284874</td></tr><tr><td>1.836111</td><td>&quot;A6&quot;</td><td>-0.574476</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.45</td><td>0.640944</td><td>-0.886354</td><td>0.311878</td></tr><tr><td>1.886111</td><td>&quot;A6&quot;</td><td>-0.549913</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.5</td><td>0.640944</td><td>-0.886354</td><td>0.336441</td></tr><tr><td>1.936111</td><td>&quot;A6&quot;</td><td>-0.527633</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.55</td><td>0.640944</td><td>-0.886354</td><td>0.358721</td></tr><tr><td>1.986111</td><td>&quot;A6&quot;</td><td>-0.504181</td><td>&quot;A&quot;</td><td>&quot;6&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>1.386111</td><td>2.086111</td><td>0.6</td><td>0.640944</td><td>-0.886354</td><td>0.382173</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>3.236111</td><td>&quot;H10&quot;</td><td>-0.731888</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.4</td><td>0.378914</td><td>-0.878845</td><td>0.146957</td></tr><tr><td>3.286111</td><td>&quot;H10&quot;</td><td>-0.719491</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.45</td><td>0.378914</td><td>-0.878845</td><td>0.159354</td></tr><tr><td>3.336111</td><td>&quot;H10&quot;</td><td>-0.70522</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.5</td><td>0.378914</td><td>-0.878845</td><td>0.173625</td></tr><tr><td>3.386111</td><td>&quot;H10&quot;</td><td>-0.665532</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.55</td><td>0.378914</td><td>-0.878845</td><td>0.213313</td></tr><tr><td>3.436111</td><td>&quot;H10&quot;</td><td>-0.648174</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.6</td><td>0.378914</td><td>-0.878845</td><td>0.230671</td></tr><tr><td>3.486111</td><td>&quot;H10&quot;</td><td>-0.650088</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.65</td><td>0.378914</td><td>-0.878845</td><td>0.228757</td></tr><tr><td>3.536111</td><td>&quot;H10&quot;</td><td>-0.627359</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.7</td><td>0.378914</td><td>-0.878845</td><td>0.251486</td></tr><tr><td>3.586111</td><td>&quot;H10&quot;</td><td>-0.599657</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.75</td><td>0.378914</td><td>-0.878845</td><td>0.279188</td></tr><tr><td>3.636111</td><td>&quot;H10&quot;</td><td>-0.597837</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.8</td><td>0.378914</td><td>-0.878845</td><td>0.281008</td></tr><tr><td>3.686111</td><td>&quot;H10&quot;</td><td>-0.537854</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.85</td><td>0.378914</td><td>-0.878845</td><td>0.340991</td></tr><tr><td>3.736111</td><td>&quot;H10&quot;</td><td>-0.527633</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.9</td><td>0.378914</td><td>-0.878845</td><td>0.351212</td></tr><tr><td>3.786111</td><td>&quot;H10&quot;</td><td>-0.500875</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>2.836111</td><td>3.836111</td><td>0.95</td><td>0.378914</td><td>-0.878845</td><td>0.37797</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[351]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">gr_time_filter</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[351]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x43520dfc0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_74_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_74_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[352]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
           <span class="n">data</span><span class="o">=</span><span class="n">gr_time_filter</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">scatter_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[352]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x4352378e0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_75_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_75_1.png" />
</div>
</div>
</section>
<section id="All-plates-at-once:">
<h1>All plates at once:<a class="headerlink" href="#All-plates-at-once:" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[353]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plate 1</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/adrian_growth_jan25_v2.csv&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>

<span class="c1"># time conversion</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">to_time</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="mi">3600</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">minute</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span><span class="p">())</span>

<span class="c1"># zero by first measurement</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

<span class="c1"># melt to experiments</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Experiment&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">Plate</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;Plate 1&quot;</span><span class="p">))</span>

<span class="c1"># plate 1</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/cyrus_012624.csv&quot;</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>

<span class="c1"># time conversion</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">to_time</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="mi">3600</span> <span class="o">*</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">minute</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span><span class="p">())</span>

<span class="c1"># zero by first measurement</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">df2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

<span class="c1"># melt to experiments</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Experiment&quot;</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">Plate</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;Plate 2&quot;</span><span class="p">))</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[353]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (29_312, 6)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Experiment</th><th>Replicate</th><th>Plate</th></tr><tr><td>i64</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>0</td><td>&quot;A2&quot;</td><td>0.0</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>300</td><td>&quot;A2&quot;</td><td>-0.001</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>600</td><td>&quot;A2&quot;</td><td>0.0</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>900</td><td>&quot;A2&quot;</td><td>0.001</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>1200</td><td>&quot;A2&quot;</td><td>0.0</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>1500</td><td>&quot;A2&quot;</td><td>-0.001</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>1800</td><td>&quot;A2&quot;</td><td>-0.001</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>2100</td><td>&quot;A2&quot;</td><td>-0.003</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>2400</td><td>&quot;A2&quot;</td><td>-0.005</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>2700</td><td>&quot;A2&quot;</td><td>-0.003</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>3000</td><td>&quot;A2&quot;</td><td>-0.004</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>3300</td><td>&quot;A2&quot;</td><td>-0.004</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>41220</td><td>&quot;H10&quot;</td><td>0.599</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr><tr><td>41400</td><td>&quot;H10&quot;</td><td>0.601</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr><tr><td>41580</td><td>&quot;H10&quot;</td><td>0.604</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr><tr><td>41760</td><td>&quot;H10&quot;</td><td>0.607</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr><tr><td>41940</td><td>&quot;H10&quot;</td><td>0.61</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr><tr><td>42120</td><td>&quot;H10&quot;</td><td>0.613</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr><tr><td>42300</td><td>&quot;H10&quot;</td><td>0.615</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr><tr><td>42480</td><td>&quot;H10&quot;</td><td>0.62</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr><tr><td>42660</td><td>&quot;H10&quot;</td><td>0.622</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr><tr><td>42840</td><td>&quot;H10&quot;</td><td>0.624</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr><tr><td>43020</td><td>&quot;H10&quot;</td><td>0.628</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr><tr><td>43200</td><td>&quot;H10&quot;</td><td>0.631</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td></tr></tbody></table></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[354]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># join with experiment type</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">,</span> <span class="s2">&quot;Abb&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="s2">&quot;Additive&quot;</span><span class="p">]</span>
<span class="n">conversion</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;Rrm&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich + met, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;met&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;Rr&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;RrZ&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met + Zn, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;zinc&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;Rrb&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met + B12, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;B12&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;rm&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich + met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;met&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;rz&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;zinc&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;B12&quot;</span><span class="p">]]</span>

<span class="n">exp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<span class="n">exp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[355]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Experiment&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[356]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">20000</span><span class="p">)</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;3&quot;</span><span class="p">)</span>
           <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[356]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x435d37c10&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_80_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_80_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[357]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">40000</span><span class="p">)</span>
           <span class="p">)</span>

<span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">concat_str</span><span class="p">([</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Well&quot;</span><span class="p">),</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Plate&quot;</span><span class="p">)],</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Unique_well&quot;</span><span class="p">))</span>

<span class="n">minimum_start_times</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.08</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;Unique_well&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">)</span>
<span class="n">minimum_end_times</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.35</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;Unique_well&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)</span>

<span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_start_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Unique_well&quot;</span><span class="p">)</span>
<span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_end_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Unique_well&quot;</span><span class="p">)</span>
<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)))</span>
<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">))</span>

<span class="c1"># correct all od values to start at 0</span>
<span class="c1"># start_od = gr_time_filter.group_by(&quot;Well&quot;).agg(pl.min(&quot;OD&quot;).alias(&quot;Start_OD&quot;)).sort(&quot;Start_OD&quot;)</span>
<span class="c1"># gr_time_filter = gr_time_filter.join(start_od, on=&quot;Well&quot;)</span>
<span class="c1"># gr_time_filter = gr_time_filter.with_columns((pl.col(&quot;OD&quot;) - pl.col(&quot;Start_OD&quot;)).alias(&quot;Corrected_OD&quot;))</span>

<span class="c1"># correct by linear fit</span>

<span class="c1">#This is what you need</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Unique_well&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress</span><span class="p">,</span> <span class="s1">&#39;OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">correction_offset</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">correction_offset</span><span class="p">)</span>

<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">correction_offset</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Unique_well&quot;</span><span class="p">)</span>
<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;intercept&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Corrected_OD&quot;</span><span class="p">))</span>

<span class="n">gr_time_filter</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[357]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2_490, 17)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Experiment</th><th>Replicate</th><th>Plate</th><th>Abb</th><th>Description</th><th>Pre-met</th><th>Additive</th><th>Unique_well</th><th>Time_exp_start</th><th>Time_exp_end</th><th>Corrected_time</th><th>Corrected_time_right</th><th>intercept</th><th>Corrected_OD</th></tr><tr><td>i64</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>str</td><td>bool</td><td>str</td><td>str</td><td>i64</td><td>i64</td><td>i64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>8100</td><td>&quot;A2&quot;</td><td>0.083</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>300</td><td>0.000076</td><td>0.037303</td><td>0.045697</td></tr><tr><td>8400</td><td>&quot;A2&quot;</td><td>0.094</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>600</td><td>0.000076</td><td>0.037303</td><td>0.056697</td></tr><tr><td>8700</td><td>&quot;A2&quot;</td><td>0.101</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>900</td><td>0.000076</td><td>0.037303</td><td>0.063697</td></tr><tr><td>9000</td><td>&quot;A2&quot;</td><td>0.113</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>1200</td><td>0.000076</td><td>0.037303</td><td>0.075697</td></tr><tr><td>9300</td><td>&quot;A2&quot;</td><td>0.131</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>1500</td><td>0.000076</td><td>0.037303</td><td>0.093697</td></tr><tr><td>9600</td><td>&quot;A2&quot;</td><td>0.152</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>1800</td><td>0.000076</td><td>0.037303</td><td>0.114697</td></tr><tr><td>9900</td><td>&quot;A2&quot;</td><td>0.182</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>2100</td><td>0.000076</td><td>0.037303</td><td>0.144697</td></tr><tr><td>10200</td><td>&quot;A2&quot;</td><td>0.244</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>2400</td><td>0.000076</td><td>0.037303</td><td>0.206697</td></tr><tr><td>10500</td><td>&quot;A2&quot;</td><td>0.252</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>2700</td><td>0.000076</td><td>0.037303</td><td>0.214697</td></tr><tr><td>10800</td><td>&quot;A2&quot;</td><td>0.279</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>3000</td><td>0.000076</td><td>0.037303</td><td>0.241697</td></tr><tr><td>11100</td><td>&quot;A2&quot;</td><td>0.295</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>3300</td><td>0.000076</td><td>0.037303</td><td>0.257697</td></tr><tr><td>11400</td><td>&quot;A2&quot;</td><td>0.302</td><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Plate 1&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>&quot;A2,Plate 1&quot;</td><td>7800</td><td>11700</td><td>3600</td><td>0.000076</td><td>0.037303</td><td>0.264697</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>10980</td><td>&quot;H10&quot;</td><td>0.261</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>2700</td><td>0.000058</td><td>0.079652</td><td>0.181348</td></tr><tr><td>11160</td><td>&quot;H10&quot;</td><td>0.254</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>2880</td><td>0.000058</td><td>0.079652</td><td>0.174348</td></tr><tr><td>11340</td><td>&quot;H10&quot;</td><td>0.258</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>3060</td><td>0.000058</td><td>0.079652</td><td>0.178348</td></tr><tr><td>11520</td><td>&quot;H10&quot;</td><td>0.27</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>3240</td><td>0.000058</td><td>0.079652</td><td>0.190348</td></tr><tr><td>11700</td><td>&quot;H10&quot;</td><td>0.276</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>3420</td><td>0.000058</td><td>0.079652</td><td>0.196348</td></tr><tr><td>11880</td><td>&quot;H10&quot;</td><td>0.283</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>3600</td><td>0.000058</td><td>0.079652</td><td>0.203348</td></tr><tr><td>12060</td><td>&quot;H10&quot;</td><td>0.303</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>3780</td><td>0.000058</td><td>0.079652</td><td>0.223348</td></tr><tr><td>12240</td><td>&quot;H10&quot;</td><td>0.312</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>3960</td><td>0.000058</td><td>0.079652</td><td>0.232348</td></tr><tr><td>12420</td><td>&quot;H10&quot;</td><td>0.311</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>4140</td><td>0.000058</td><td>0.079652</td><td>0.231348</td></tr><tr><td>12600</td><td>&quot;H10&quot;</td><td>0.323</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>4320</td><td>0.000058</td><td>0.079652</td><td>0.243348</td></tr><tr><td>12780</td><td>&quot;H10&quot;</td><td>0.338</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>4500</td><td>0.000058</td><td>0.079652</td><td>0.258348</td></tr><tr><td>12960</td><td>&quot;H10&quot;</td><td>0.339</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;Plate 2&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>&quot;H10,Plate 2&quot;</td><td>8280</td><td>13140</td><td>4680</td><td>0.000058</td><td>0.079652</td><td>0.259348</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[358]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
           <span class="n">data</span><span class="o">=</span><span class="n">gr_time_filter</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Plate&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Plate 1&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[358]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x437148460&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_82_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_82_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[359]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Plate&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Plate 1&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">))</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Additive&#39;</span><span class="p">,</span> <span class="s1">&#39;Plate&#39;</span><span class="p">,</span> <span class="s1">&#39;Pre-met&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress_error</span><span class="p">,</span> <span class="s1">&#39;Corrected_OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span>
<span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">predicted_gr</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">predicted_gr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[359]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Additive</th>
      <th>Plate</th>
      <th>Pre-met</th>
      <th>slope</th>
      <th>intercept</th>
      <th>slope_e</th>
      <th>intercept_e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B12</td>
      <td>Plate 1</td>
      <td>False</td>
      <td>0.000057</td>
      <td>0.002491</td>
      <td>1.098559e-06</td>
      <td>0.003204</td>
    </tr>
    <tr>
      <th>1</th>
      <td>met</td>
      <td>Plate 1</td>
      <td>False</td>
      <td>0.000060</td>
      <td>0.001704</td>
      <td>9.004299e-07</td>
      <td>0.002478</td>
    </tr>
    <tr>
      <th>2</th>
      <td>none</td>
      <td>Plate 1</td>
      <td>False</td>
      <td>0.000053</td>
      <td>0.003558</td>
      <td>1.136756e-06</td>
      <td>0.003435</td>
    </tr>
    <tr>
      <th>3</th>
      <td>zinc</td>
      <td>Plate 1</td>
      <td>False</td>
      <td>0.000054</td>
      <td>0.001121</td>
      <td>8.148272e-07</td>
      <td>0.002513</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Plate-two">
<h1>Plate two<a class="headerlink" href="#Plate-two" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[360]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/cyrus_012624.csv&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[360]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (241, 65)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>A3</th><th>A4</th><th>A5</th><th>A6</th><th>A7</th><th>A8</th><th>A9</th><th>A10</th><th>B3</th><th>B4</th><th>B5</th><th>B6</th><th>B7</th><th>B8</th><th>B9</th><th>B10</th><th>C3</th><th>C4</th><th>C5</th><th>C6</th><th>C7</th><th>C8</th><th>C9</th><th>C10</th><th>D3</th><th>D4</th><th>D5</th><th>D6</th><th>D7</th><th>D8</th><th>D9</th><th>D10</th><th>E3</th><th>E4</th><th>E5</th><th>E6</th><th>E7</th><th>E8</th><th>E9</th><th>E10</th><th>F3</th><th>F4</th><th>F5</th><th>F6</th><th>F7</th><th>F8</th><th>F9</th><th>F10</th><th>G3</th><th>G4</th><th>G5</th><th>G6</th><th>G7</th><th>G8</th><th>G9</th><th>G10</th><th>H3</th><th>H4</th><th>H5</th><th>H6</th><th>H7</th><th>H8</th><th>H9</th><th>H10</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;00:02:10&quot;</td><td>0.232</td><td>0.277</td><td>0.25</td><td>0.26</td><td>0.189</td><td>0.2</td><td>0.237</td><td>0.207</td><td>0.109</td><td>0.199</td><td>0.227</td><td>0.268</td><td>0.22</td><td>0.198</td><td>0.206</td><td>0.206</td><td>0.197</td><td>0.277</td><td>0.223</td><td>0.176</td><td>0.19</td><td>0.312</td><td>0.233</td><td>0.254</td><td>0.233</td><td>0.252</td><td>0.142</td><td>0.24</td><td>0.287</td><td>0.223</td><td>0.261</td><td>0.172</td><td>0.176</td><td>0.196</td><td>0.243</td><td>0.18</td><td>0.248</td><td>0.21</td><td>0.22</td><td>0.127</td><td>0.208</td><td>0.228</td><td>0.153</td><td>0.173</td><td>0.241</td><td>0.228</td><td>0.263</td><td>0.238</td><td>0.215</td><td>0.246</td><td>0.243</td><td>0.127</td><td>0.207</td><td>0.27</td><td>0.263</td><td>0.263</td><td>0.213</td><td>0.268</td><td>0.199</td><td>0.2</td><td>0.11</td><td>0.219</td><td>0.195</td><td>0.211</td></tr><tr><td>&quot;00:05:10&quot;</td><td>0.225</td><td>0.267</td><td>0.237</td><td>0.239</td><td>0.156</td><td>0.192</td><td>0.226</td><td>0.2</td><td>0.109</td><td>0.198</td><td>0.223</td><td>0.261</td><td>0.209</td><td>0.181</td><td>0.196</td><td>0.198</td><td>0.194</td><td>0.274</td><td>0.222</td><td>0.173</td><td>0.188</td><td>0.305</td><td>0.228</td><td>0.249</td><td>0.23</td><td>0.25</td><td>0.137</td><td>0.237</td><td>0.286</td><td>0.218</td><td>0.258</td><td>0.17</td><td>0.175</td><td>0.195</td><td>0.242</td><td>0.177</td><td>0.248</td><td>0.206</td><td>0.214</td><td>0.123</td><td>0.205</td><td>0.227</td><td>0.144</td><td>0.163</td><td>0.235</td><td>0.225</td><td>0.259</td><td>0.23</td><td>0.213</td><td>0.245</td><td>0.241</td><td>0.123</td><td>0.205</td><td>0.265</td><td>0.25</td><td>0.255</td><td>0.211</td><td>0.265</td><td>0.196</td><td>0.197</td><td>0.11</td><td>0.218</td><td>0.194</td><td>0.21</td></tr><tr><td>&quot;00:08:10&quot;</td><td>0.225</td><td>0.265</td><td>0.237</td><td>0.242</td><td>0.159</td><td>0.197</td><td>0.229</td><td>0.199</td><td>0.111</td><td>0.199</td><td>0.221</td><td>0.256</td><td>0.202</td><td>0.175</td><td>0.191</td><td>0.197</td><td>0.193</td><td>0.274</td><td>0.221</td><td>0.17</td><td>0.185</td><td>0.304</td><td>0.223</td><td>0.246</td><td>0.228</td><td>0.248</td><td>0.136</td><td>0.236</td><td>0.284</td><td>0.215</td><td>0.256</td><td>0.168</td><td>0.174</td><td>0.195</td><td>0.242</td><td>0.178</td><td>0.247</td><td>0.205</td><td>0.209</td><td>0.121</td><td>0.204</td><td>0.222</td><td>0.143</td><td>0.158</td><td>0.233</td><td>0.225</td><td>0.256</td><td>0.226</td><td>0.212</td><td>0.246</td><td>0.243</td><td>0.122</td><td>0.205</td><td>0.263</td><td>0.242</td><td>0.25</td><td>0.212</td><td>0.265</td><td>0.194</td><td>0.195</td><td>0.109</td><td>0.218</td><td>0.195</td><td>0.209</td></tr><tr><td>&quot;00:11:10&quot;</td><td>0.224</td><td>0.264</td><td>0.237</td><td>0.245</td><td>0.161</td><td>0.197</td><td>0.229</td><td>0.199</td><td>0.111</td><td>0.197</td><td>0.221</td><td>0.254</td><td>0.2</td><td>0.173</td><td>0.19</td><td>0.196</td><td>0.193</td><td>0.273</td><td>0.22</td><td>0.169</td><td>0.186</td><td>0.296</td><td>0.22</td><td>0.245</td><td>0.227</td><td>0.246</td><td>0.137</td><td>0.234</td><td>0.284</td><td>0.214</td><td>0.254</td><td>0.168</td><td>0.175</td><td>0.195</td><td>0.243</td><td>0.178</td><td>0.246</td><td>0.203</td><td>0.207</td><td>0.121</td><td>0.203</td><td>0.218</td><td>0.143</td><td>0.157</td><td>0.233</td><td>0.228</td><td>0.254</td><td>0.224</td><td>0.212</td><td>0.245</td><td>0.243</td><td>0.121</td><td>0.203</td><td>0.26</td><td>0.241</td><td>0.249</td><td>0.212</td><td>0.265</td><td>0.192</td><td>0.195</td><td>0.117</td><td>0.218</td><td>0.194</td><td>0.209</td></tr><tr><td>&quot;00:14:10&quot;</td><td>0.224</td><td>0.264</td><td>0.236</td><td>0.248</td><td>0.165</td><td>0.197</td><td>0.23</td><td>0.198</td><td>0.113</td><td>0.196</td><td>0.221</td><td>0.255</td><td>0.199</td><td>0.172</td><td>0.19</td><td>0.196</td><td>0.193</td><td>0.273</td><td>0.22</td><td>0.168</td><td>0.186</td><td>0.293</td><td>0.219</td><td>0.244</td><td>0.227</td><td>0.245</td><td>0.139</td><td>0.233</td><td>0.283</td><td>0.214</td><td>0.254</td><td>0.168</td><td>0.175</td><td>0.194</td><td>0.243</td><td>0.178</td><td>0.246</td><td>0.203</td><td>0.206</td><td>0.121</td><td>0.203</td><td>0.218</td><td>0.143</td><td>0.159</td><td>0.234</td><td>0.233</td><td>0.253</td><td>0.223</td><td>0.211</td><td>0.245</td><td>0.242</td><td>0.121</td><td>0.201</td><td>0.259</td><td>0.241</td><td>0.248</td><td>0.212</td><td>0.265</td><td>0.191</td><td>0.194</td><td>0.112</td><td>0.219</td><td>0.194</td><td>0.209</td></tr><tr><td>&quot;00:17:10&quot;</td><td>0.224</td><td>0.264</td><td>0.236</td><td>0.248</td><td>0.169</td><td>0.198</td><td>0.232</td><td>0.199</td><td>0.113</td><td>0.197</td><td>0.222</td><td>0.258</td><td>0.199</td><td>0.171</td><td>0.189</td><td>0.195</td><td>0.194</td><td>0.274</td><td>0.22</td><td>0.168</td><td>0.187</td><td>0.294</td><td>0.219</td><td>0.244</td><td>0.227</td><td>0.245</td><td>0.14</td><td>0.233</td><td>0.283</td><td>0.214</td><td>0.256</td><td>0.168</td><td>0.176</td><td>0.194</td><td>0.242</td><td>0.179</td><td>0.246</td><td>0.203</td><td>0.205</td><td>0.122</td><td>0.203</td><td>0.215</td><td>0.142</td><td>0.161</td><td>0.237</td><td>0.235</td><td>0.253</td><td>0.224</td><td>0.21</td><td>0.245</td><td>0.243</td><td>0.121</td><td>0.201</td><td>0.261</td><td>0.244</td><td>0.249</td><td>0.212</td><td>0.266</td><td>0.19</td><td>0.193</td><td>0.11</td><td>0.219</td><td>0.196</td><td>0.209</td></tr><tr><td>&quot;00:20:10&quot;</td><td>0.224</td><td>0.264</td><td>0.236</td><td>0.25</td><td>0.172</td><td>0.2</td><td>0.232</td><td>0.199</td><td>0.113</td><td>0.197</td><td>0.222</td><td>0.255</td><td>0.199</td><td>0.171</td><td>0.19</td><td>0.197</td><td>0.194</td><td>0.275</td><td>0.22</td><td>0.168</td><td>0.186</td><td>0.292</td><td>0.219</td><td>0.243</td><td>0.228</td><td>0.245</td><td>0.14</td><td>0.232</td><td>0.283</td><td>0.214</td><td>0.257</td><td>0.168</td><td>0.175</td><td>0.195</td><td>0.242</td><td>0.178</td><td>0.246</td><td>0.204</td><td>0.204</td><td>0.123</td><td>0.203</td><td>0.216</td><td>0.142</td><td>0.161</td><td>0.238</td><td>0.237</td><td>0.254</td><td>0.224</td><td>0.21</td><td>0.246</td><td>0.243</td><td>0.122</td><td>0.202</td><td>0.262</td><td>0.245</td><td>0.25</td><td>0.212</td><td>0.266</td><td>0.189</td><td>0.193</td><td>0.111</td><td>0.22</td><td>0.196</td><td>0.21</td></tr><tr><td>&quot;00:23:10&quot;</td><td>0.224</td><td>0.264</td><td>0.238</td><td>0.251</td><td>0.176</td><td>0.202</td><td>0.233</td><td>0.201</td><td>0.115</td><td>0.197</td><td>0.222</td><td>0.257</td><td>0.199</td><td>0.171</td><td>0.192</td><td>0.197</td><td>0.194</td><td>0.275</td><td>0.22</td><td>0.168</td><td>0.189</td><td>0.293</td><td>0.22</td><td>0.244</td><td>0.228</td><td>0.247</td><td>0.141</td><td>0.232</td><td>0.283</td><td>0.215</td><td>0.258</td><td>0.169</td><td>0.175</td><td>0.195</td><td>0.242</td><td>0.179</td><td>0.245</td><td>0.204</td><td>0.204</td><td>0.123</td><td>0.203</td><td>0.214</td><td>0.143</td><td>0.163</td><td>0.239</td><td>0.238</td><td>0.254</td><td>0.225</td><td>0.21</td><td>0.247</td><td>0.244</td><td>0.123</td><td>0.203</td><td>0.264</td><td>0.249</td><td>0.251</td><td>0.212</td><td>0.266</td><td>0.189</td><td>0.193</td><td>0.119</td><td>0.22</td><td>0.195</td><td>0.21</td></tr><tr><td>&quot;00:26:10&quot;</td><td>0.225</td><td>0.265</td><td>0.239</td><td>0.253</td><td>0.183</td><td>0.205</td><td>0.235</td><td>0.202</td><td>0.116</td><td>0.197</td><td>0.222</td><td>0.257</td><td>0.199</td><td>0.172</td><td>0.193</td><td>0.198</td><td>0.194</td><td>0.276</td><td>0.221</td><td>0.17</td><td>0.19</td><td>0.297</td><td>0.221</td><td>0.244</td><td>0.229</td><td>0.247</td><td>0.143</td><td>0.235</td><td>0.284</td><td>0.216</td><td>0.26</td><td>0.17</td><td>0.176</td><td>0.195</td><td>0.242</td><td>0.179</td><td>0.245</td><td>0.204</td><td>0.203</td><td>0.125</td><td>0.203</td><td>0.215</td><td>0.145</td><td>0.164</td><td>0.24</td><td>0.24</td><td>0.256</td><td>0.228</td><td>0.209</td><td>0.247</td><td>0.245</td><td>0.125</td><td>0.205</td><td>0.267</td><td>0.251</td><td>0.259</td><td>0.212</td><td>0.267</td><td>0.188</td><td>0.193</td><td>0.117</td><td>0.221</td><td>0.196</td><td>0.21</td></tr><tr><td>&quot;00:29:10&quot;</td><td>0.227</td><td>0.265</td><td>0.24</td><td>0.26</td><td>0.187</td><td>0.207</td><td>0.239</td><td>0.205</td><td>0.113</td><td>0.198</td><td>0.223</td><td>0.257</td><td>0.2</td><td>0.172</td><td>0.194</td><td>0.198</td><td>0.195</td><td>0.277</td><td>0.222</td><td>0.171</td><td>0.192</td><td>0.298</td><td>0.222</td><td>0.245</td><td>0.23</td><td>0.248</td><td>0.146</td><td>0.236</td><td>0.285</td><td>0.217</td><td>0.261</td><td>0.17</td><td>0.175</td><td>0.193</td><td>0.242</td><td>0.18</td><td>0.246</td><td>0.205</td><td>0.204</td><td>0.126</td><td>0.204</td><td>0.215</td><td>0.146</td><td>0.167</td><td>0.242</td><td>0.242</td><td>0.258</td><td>0.23</td><td>0.209</td><td>0.248</td><td>0.247</td><td>0.127</td><td>0.206</td><td>0.27</td><td>0.255</td><td>0.26</td><td>0.211</td><td>0.268</td><td>0.188</td><td>0.193</td><td>0.12</td><td>0.223</td><td>0.197</td><td>0.21</td></tr><tr><td>&quot;00:32:10&quot;</td><td>0.228</td><td>0.266</td><td>0.241</td><td>0.264</td><td>0.196</td><td>0.212</td><td>0.244</td><td>0.208</td><td>0.116</td><td>0.198</td><td>0.223</td><td>0.259</td><td>0.2</td><td>0.173</td><td>0.195</td><td>0.199</td><td>0.196</td><td>0.278</td><td>0.223</td><td>0.171</td><td>0.194</td><td>0.305</td><td>0.224</td><td>0.245</td><td>0.231</td><td>0.25</td><td>0.148</td><td>0.238</td><td>0.287</td><td>0.218</td><td>0.262</td><td>0.171</td><td>0.176</td><td>0.192</td><td>0.242</td><td>0.179</td><td>0.246</td><td>0.205</td><td>0.204</td><td>0.128</td><td>0.203</td><td>0.215</td><td>0.148</td><td>0.169</td><td>0.243</td><td>0.243</td><td>0.261</td><td>0.232</td><td>0.209</td><td>0.249</td><td>0.249</td><td>0.13</td><td>0.208</td><td>0.272</td><td>0.26</td><td>0.262</td><td>0.212</td><td>0.267</td><td>0.188</td><td>0.194</td><td>0.114</td><td>0.223</td><td>0.198</td><td>0.212</td></tr><tr><td>&quot;00:35:10&quot;</td><td>0.23</td><td>0.268</td><td>0.245</td><td>0.271</td><td>0.209</td><td>0.22</td><td>0.252</td><td>0.212</td><td>0.116</td><td>0.198</td><td>0.226</td><td>0.258</td><td>0.201</td><td>0.174</td><td>0.196</td><td>0.201</td><td>0.197</td><td>0.278</td><td>0.224</td><td>0.172</td><td>0.195</td><td>0.302</td><td>0.225</td><td>0.246</td><td>0.232</td><td>0.251</td><td>0.152</td><td>0.239</td><td>0.289</td><td>0.22</td><td>0.264</td><td>0.173</td><td>0.176</td><td>0.192</td><td>0.242</td><td>0.18</td><td>0.247</td><td>0.206</td><td>0.204</td><td>0.129</td><td>0.204</td><td>0.216</td><td>0.151</td><td>0.171</td><td>0.245</td><td>0.243</td><td>0.265</td><td>0.234</td><td>0.208</td><td>0.251</td><td>0.251</td><td>0.133</td><td>0.212</td><td>0.275</td><td>0.263</td><td>0.263</td><td>0.211</td><td>0.267</td><td>0.189</td><td>0.195</td><td>0.121</td><td>0.225</td><td>0.199</td><td>0.212</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;11:29:10&quot;</td><td>0.945</td><td>0.937</td><td>0.628</td><td>0.928</td><td>0.762</td><td>0.88</td><td>0.89</td><td>0.997</td><td>0.714</td><td>0.705</td><td>0.672</td><td>0.729</td><td>0.698</td><td>0.67</td><td>0.674</td><td>0.625</td><td>0.684</td><td>0.788</td><td>0.695</td><td>0.665</td><td>0.67</td><td>0.703</td><td>0.686</td><td>0.696</td><td>0.64</td><td>0.645</td><td>0.663</td><td>0.644</td><td>0.723</td><td>0.702</td><td>0.648</td><td>0.659</td><td>0.9</td><td>0.693</td><td>0.94</td><td>0.932</td><td>0.694</td><td>0.63</td><td>0.846</td><td>0.86</td><td>0.697</td><td>0.635</td><td>0.576</td><td>0.64</td><td>0.715</td><td>0.638</td><td>0.882</td><td>0.654</td><td>0.677</td><td>0.707</td><td>0.681</td><td>0.665</td><td>0.656</td><td>0.621</td><td>0.649</td><td>0.689</td><td>0.716</td><td>0.736</td><td>0.704</td><td>0.713</td><td>0.673</td><td>0.684</td><td>0.747</td><td>0.81</td></tr><tr><td>&quot;11:32:10&quot;</td><td>0.945</td><td>0.939</td><td>0.627</td><td>0.928</td><td>0.76</td><td>0.88</td><td>0.888</td><td>0.998</td><td>0.715</td><td>0.705</td><td>0.672</td><td>0.731</td><td>0.699</td><td>0.672</td><td>0.674</td><td>0.623</td><td>0.684</td><td>0.788</td><td>0.695</td><td>0.664</td><td>0.671</td><td>0.703</td><td>0.686</td><td>0.695</td><td>0.639</td><td>0.644</td><td>0.665</td><td>0.643</td><td>0.724</td><td>0.703</td><td>0.647</td><td>0.654</td><td>0.903</td><td>0.693</td><td>0.94</td><td>0.935</td><td>0.696</td><td>0.629</td><td>0.849</td><td>0.862</td><td>0.697</td><td>0.636</td><td>0.575</td><td>0.639</td><td>0.716</td><td>0.637</td><td>0.879</td><td>0.652</td><td>0.678</td><td>0.706</td><td>0.681</td><td>0.664</td><td>0.656</td><td>0.621</td><td>0.65</td><td>0.689</td><td>0.718</td><td>0.736</td><td>0.705</td><td>0.712</td><td>0.674</td><td>0.683</td><td>0.748</td><td>0.812</td></tr><tr><td>&quot;11:35:10&quot;</td><td>0.947</td><td>0.938</td><td>0.629</td><td>0.928</td><td>0.762</td><td>0.88</td><td>0.891</td><td>0.998</td><td>0.715</td><td>0.706</td><td>0.67</td><td>0.732</td><td>0.699</td><td>0.671</td><td>0.675</td><td>0.622</td><td>0.685</td><td>0.789</td><td>0.696</td><td>0.664</td><td>0.671</td><td>0.704</td><td>0.687</td><td>0.698</td><td>0.639</td><td>0.645</td><td>0.665</td><td>0.643</td><td>0.725</td><td>0.704</td><td>0.647</td><td>0.65</td><td>0.903</td><td>0.693</td><td>0.942</td><td>0.937</td><td>0.695</td><td>0.632</td><td>0.852</td><td>0.866</td><td>0.698</td><td>0.637</td><td>0.575</td><td>0.639</td><td>0.718</td><td>0.637</td><td>0.867</td><td>0.652</td><td>0.678</td><td>0.708</td><td>0.681</td><td>0.665</td><td>0.657</td><td>0.621</td><td>0.651</td><td>0.689</td><td>0.718</td><td>0.737</td><td>0.706</td><td>0.712</td><td>0.675</td><td>0.683</td><td>0.75</td><td>0.815</td></tr><tr><td>&quot;11:38:10&quot;</td><td>0.95</td><td>0.943</td><td>0.627</td><td>0.927</td><td>0.76</td><td>0.88</td><td>0.894</td><td>1.001</td><td>0.717</td><td>0.706</td><td>0.672</td><td>0.738</td><td>0.7</td><td>0.674</td><td>0.677</td><td>0.62</td><td>0.684</td><td>0.789</td><td>0.695</td><td>0.665</td><td>0.671</td><td>0.705</td><td>0.686</td><td>0.696</td><td>0.638</td><td>0.643</td><td>0.666</td><td>0.642</td><td>0.727</td><td>0.704</td><td>0.647</td><td>0.642</td><td>0.906</td><td>0.694</td><td>0.943</td><td>0.94</td><td>0.695</td><td>0.631</td><td>0.854</td><td>0.864</td><td>0.698</td><td>0.637</td><td>0.575</td><td>0.638</td><td>0.717</td><td>0.635</td><td>0.855</td><td>0.651</td><td>0.68</td><td>0.709</td><td>0.681</td><td>0.666</td><td>0.658</td><td>0.621</td><td>0.653</td><td>0.689</td><td>0.719</td><td>0.738</td><td>0.706</td><td>0.715</td><td>0.677</td><td>0.683</td><td>0.752</td><td>0.818</td></tr><tr><td>&quot;11:41:10&quot;</td><td>0.951</td><td>0.943</td><td>0.628</td><td>0.932</td><td>0.759</td><td>0.882</td><td>0.893</td><td>1.001</td><td>0.717</td><td>0.708</td><td>0.672</td><td>0.741</td><td>0.701</td><td>0.674</td><td>0.679</td><td>0.617</td><td>0.686</td><td>0.789</td><td>0.697</td><td>0.666</td><td>0.672</td><td>0.706</td><td>0.688</td><td>0.698</td><td>0.637</td><td>0.643</td><td>0.667</td><td>0.641</td><td>0.727</td><td>0.705</td><td>0.646</td><td>0.635</td><td>0.906</td><td>0.694</td><td>0.944</td><td>0.942</td><td>0.696</td><td>0.631</td><td>0.856</td><td>0.867</td><td>0.699</td><td>0.637</td><td>0.575</td><td>0.637</td><td>0.718</td><td>0.635</td><td>0.848</td><td>0.65</td><td>0.679</td><td>0.709</td><td>0.681</td><td>0.667</td><td>0.659</td><td>0.62</td><td>0.653</td><td>0.688</td><td>0.72</td><td>0.737</td><td>0.706</td><td>0.716</td><td>0.677</td><td>0.682</td><td>0.754</td><td>0.821</td></tr><tr><td>&quot;11:44:10&quot;</td><td>0.951</td><td>0.944</td><td>0.63</td><td>0.931</td><td>0.761</td><td>0.882</td><td>0.895</td><td>1.003</td><td>0.719</td><td>0.709</td><td>0.67</td><td>0.741</td><td>0.702</td><td>0.673</td><td>0.68</td><td>0.618</td><td>0.686</td><td>0.791</td><td>0.697</td><td>0.667</td><td>0.672</td><td>0.706</td><td>0.688</td><td>0.698</td><td>0.637</td><td>0.642</td><td>0.668</td><td>0.641</td><td>0.728</td><td>0.706</td><td>0.647</td><td>0.632</td><td>0.908</td><td>0.695</td><td>0.945</td><td>0.942</td><td>0.697</td><td>0.632</td><td>0.858</td><td>0.869</td><td>0.701</td><td>0.639</td><td>0.576</td><td>0.637</td><td>0.718</td><td>0.635</td><td>0.846</td><td>0.65</td><td>0.68</td><td>0.71</td><td>0.68</td><td>0.667</td><td>0.66</td><td>0.62</td><td>0.654</td><td>0.689</td><td>0.721</td><td>0.739</td><td>0.707</td><td>0.716</td><td>0.678</td><td>0.682</td><td>0.757</td><td>0.824</td></tr><tr><td>&quot;11:47:10&quot;</td><td>0.951</td><td>0.946</td><td>0.63</td><td>0.932</td><td>0.76</td><td>0.885</td><td>0.897</td><td>1.005</td><td>0.719</td><td>0.71</td><td>0.671</td><td>0.739</td><td>0.702</td><td>0.675</td><td>0.68</td><td>0.614</td><td>0.686</td><td>0.792</td><td>0.696</td><td>0.666</td><td>0.674</td><td>0.707</td><td>0.688</td><td>0.698</td><td>0.636</td><td>0.641</td><td>0.667</td><td>0.641</td><td>0.728</td><td>0.706</td><td>0.646</td><td>0.63</td><td>0.911</td><td>0.695</td><td>0.945</td><td>0.945</td><td>0.698</td><td>0.633</td><td>0.862</td><td>0.869</td><td>0.7</td><td>0.638</td><td>0.576</td><td>0.636</td><td>0.719</td><td>0.634</td><td>0.85</td><td>0.648</td><td>0.682</td><td>0.71</td><td>0.68</td><td>0.666</td><td>0.66</td><td>0.62</td><td>0.653</td><td>0.69</td><td>0.722</td><td>0.739</td><td>0.707</td><td>0.717</td><td>0.68</td><td>0.681</td><td>0.759</td><td>0.826</td></tr><tr><td>&quot;11:50:10&quot;</td><td>0.957</td><td>0.948</td><td>0.632</td><td>0.932</td><td>0.762</td><td>0.886</td><td>0.897</td><td>1.006</td><td>0.721</td><td>0.711</td><td>0.669</td><td>0.729</td><td>0.703</td><td>0.675</td><td>0.682</td><td>0.617</td><td>0.688</td><td>0.793</td><td>0.699</td><td>0.669</td><td>0.673</td><td>0.708</td><td>0.69</td><td>0.7</td><td>0.636</td><td>0.642</td><td>0.669</td><td>0.642</td><td>0.729</td><td>0.708</td><td>0.648</td><td>0.632</td><td>0.911</td><td>0.696</td><td>0.947</td><td>0.946</td><td>0.698</td><td>0.633</td><td>0.863</td><td>0.873</td><td>0.702</td><td>0.64</td><td>0.577</td><td>0.638</td><td>0.72</td><td>0.634</td><td>0.847</td><td>0.649</td><td>0.679</td><td>0.711</td><td>0.679</td><td>0.667</td><td>0.66</td><td>0.62</td><td>0.655</td><td>0.688</td><td>0.722</td><td>0.74</td><td>0.707</td><td>0.717</td><td>0.68</td><td>0.681</td><td>0.761</td><td>0.831</td></tr><tr><td>&quot;11:53:10&quot;</td><td>0.953</td><td>0.946</td><td>0.633</td><td>0.936</td><td>0.762</td><td>0.888</td><td>0.901</td><td>1.009</td><td>0.722</td><td>0.712</td><td>0.667</td><td>0.721</td><td>0.703</td><td>0.678</td><td>0.684</td><td>0.616</td><td>0.689</td><td>0.794</td><td>0.699</td><td>0.669</td><td>0.675</td><td>0.709</td><td>0.69</td><td>0.7</td><td>0.636</td><td>0.641</td><td>0.67</td><td>0.642</td><td>0.729</td><td>0.708</td><td>0.648</td><td>0.634</td><td>0.914</td><td>0.697</td><td>0.949</td><td>0.948</td><td>0.699</td><td>0.634</td><td>0.866</td><td>0.875</td><td>0.702</td><td>0.64</td><td>0.577</td><td>0.637</td><td>0.721</td><td>0.634</td><td>0.838</td><td>0.648</td><td>0.681</td><td>0.712</td><td>0.679</td><td>0.667</td><td>0.663</td><td>0.619</td><td>0.655</td><td>0.689</td><td>0.725</td><td>0.739</td><td>0.707</td><td>0.719</td><td>0.683</td><td>0.68</td><td>0.764</td><td>0.833</td></tr><tr><td>&quot;11:56:10&quot;</td><td>0.953</td><td>0.946</td><td>0.633</td><td>0.935</td><td>0.762</td><td>0.887</td><td>0.901</td><td>1.01</td><td>0.723</td><td>0.712</td><td>0.668</td><td>0.718</td><td>0.703</td><td>0.678</td><td>0.683</td><td>0.614</td><td>0.689</td><td>0.795</td><td>0.7</td><td>0.67</td><td>0.676</td><td>0.709</td><td>0.691</td><td>0.701</td><td>0.636</td><td>0.64</td><td>0.669</td><td>0.641</td><td>0.73</td><td>0.708</td><td>0.647</td><td>0.634</td><td>0.916</td><td>0.698</td><td>0.95</td><td>0.951</td><td>0.699</td><td>0.634</td><td>0.869</td><td>0.878</td><td>0.703</td><td>0.64</td><td>0.577</td><td>0.636</td><td>0.721</td><td>0.632</td><td>0.827</td><td>0.647</td><td>0.681</td><td>0.712</td><td>0.679</td><td>0.668</td><td>0.662</td><td>0.619</td><td>0.656</td><td>0.688</td><td>0.726</td><td>0.741</td><td>0.707</td><td>0.719</td><td>0.684</td><td>0.68</td><td>0.767</td><td>0.835</td></tr><tr><td>&quot;11:59:10&quot;</td><td>0.956</td><td>0.949</td><td>0.633</td><td>0.934</td><td>0.761</td><td>0.887</td><td>0.901</td><td>1.01</td><td>0.722</td><td>0.714</td><td>0.668</td><td>0.716</td><td>0.704</td><td>0.678</td><td>0.683</td><td>0.614</td><td>0.69</td><td>0.796</td><td>0.7</td><td>0.67</td><td>0.677</td><td>0.709</td><td>0.69</td><td>0.7</td><td>0.635</td><td>0.64</td><td>0.669</td><td>0.641</td><td>0.729</td><td>0.709</td><td>0.647</td><td>0.634</td><td>0.917</td><td>0.699</td><td>0.952</td><td>0.954</td><td>0.699</td><td>0.634</td><td>0.871</td><td>0.878</td><td>0.704</td><td>0.641</td><td>0.577</td><td>0.636</td><td>0.721</td><td>0.632</td><td>0.825</td><td>0.647</td><td>0.681</td><td>0.713</td><td>0.678</td><td>0.668</td><td>0.663</td><td>0.619</td><td>0.657</td><td>0.688</td><td>0.727</td><td>0.742</td><td>0.708</td><td>0.72</td><td>0.686</td><td>0.679</td><td>0.769</td><td>0.839</td></tr><tr><td>&quot;12:02:10&quot;</td><td>0.956</td><td>0.949</td><td>0.634</td><td>0.936</td><td>0.762</td><td>0.889</td><td>0.901</td><td>1.011</td><td>0.724</td><td>0.713</td><td>0.668</td><td>0.713</td><td>0.704</td><td>0.679</td><td>0.685</td><td>0.614</td><td>0.69</td><td>0.796</td><td>0.7</td><td>0.67</td><td>0.676</td><td>0.709</td><td>0.692</td><td>0.701</td><td>0.634</td><td>0.639</td><td>0.671</td><td>0.64</td><td>0.73</td><td>0.71</td><td>0.647</td><td>0.634</td><td>0.919</td><td>0.699</td><td>0.953</td><td>0.956</td><td>0.699</td><td>0.636</td><td>0.872</td><td>0.88</td><td>0.703</td><td>0.642</td><td>0.578</td><td>0.636</td><td>0.723</td><td>0.631</td><td>0.833</td><td>0.646</td><td>0.679</td><td>0.713</td><td>0.677</td><td>0.667</td><td>0.663</td><td>0.619</td><td>0.659</td><td>0.688</td><td>0.728</td><td>0.741</td><td>0.709</td><td>0.72</td><td>0.687</td><td>0.679</td><td>0.771</td><td>0.842</td></tr></tbody></table></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[361]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bf</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/cyrus_012624_blanks.csv&quot;</span><span class="p">)</span>
<span class="n">bf</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>
<span class="n">bfm</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">bfm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">bfm</span> <span class="o">=</span> <span class="n">bfm</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">bfm</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[362]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/cyrus_012624.csv&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T600&#39;</span><span class="p">)</span>
<span class="n">df</span>

<span class="c1"># time conversion</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">to_time</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="mi">3600</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">minute</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span><span class="p">())</span>

<span class="c1"># zero by first measurement</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

<span class="c1"># melt to experiments</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Experiment&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">))</span>
<span class="n">df</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[362]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (15_424, 5)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Experiment</th><th>Replicate</th></tr><tr><td>i64</td><td>str</td><td>f64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>0</td><td>&quot;A3&quot;</td><td>0.0</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>180</td><td>&quot;A3&quot;</td><td>-0.007</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>360</td><td>&quot;A3&quot;</td><td>-0.007</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>540</td><td>&quot;A3&quot;</td><td>-0.008</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>720</td><td>&quot;A3&quot;</td><td>-0.008</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>900</td><td>&quot;A3&quot;</td><td>-0.008</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>1080</td><td>&quot;A3&quot;</td><td>-0.008</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>1260</td><td>&quot;A3&quot;</td><td>-0.008</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>1440</td><td>&quot;A3&quot;</td><td>-0.007</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>1620</td><td>&quot;A3&quot;</td><td>-0.005</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>1800</td><td>&quot;A3&quot;</td><td>-0.004</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>1980</td><td>&quot;A3&quot;</td><td>-0.002</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>41220</td><td>&quot;H10&quot;</td><td>0.599</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr><tr><td>41400</td><td>&quot;H10&quot;</td><td>0.601</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr><tr><td>41580</td><td>&quot;H10&quot;</td><td>0.604</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr><tr><td>41760</td><td>&quot;H10&quot;</td><td>0.607</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr><tr><td>41940</td><td>&quot;H10&quot;</td><td>0.61</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr><tr><td>42120</td><td>&quot;H10&quot;</td><td>0.613</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr><tr><td>42300</td><td>&quot;H10&quot;</td><td>0.615</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr><tr><td>42480</td><td>&quot;H10&quot;</td><td>0.62</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr><tr><td>42660</td><td>&quot;H10&quot;</td><td>0.622</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr><tr><td>42840</td><td>&quot;H10&quot;</td><td>0.624</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr><tr><td>43020</td><td>&quot;H10&quot;</td><td>0.628</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr><tr><td>43200</td><td>&quot;H10&quot;</td><td>0.631</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[363]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># join with experiment type</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">,</span> <span class="s2">&quot;Abb&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="s2">&quot;Additive&quot;</span><span class="p">]</span>
<span class="n">conversion</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;Rrm&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich + met, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;met&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;Rr&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;RrZ&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met + Zn, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;zinc&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;Rrb&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met + B12, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;B12&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;rm&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich + met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;met&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;rz&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;zinc&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;B12&quot;</span><span class="p">]]</span>

<span class="n">exp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<span class="n">exp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span>

<span class="n">exp</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[363]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (8, 5)</small><table border="1" class="dataframe"><thead><tr><th>Experiment</th><th>Abb</th><th>Description</th><th>Pre-met</th><th>Additive</th></tr><tr><td>str</td><td>str</td><td>str</td><td>bool</td><td>str</td></tr></thead><tbody><tr><td>&quot;A&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td></tr><tr><td>&quot;B&quot;</td><td>&quot;Rr&quot;</td><td>&quot;Rich - met, ++‚Ä¶</td><td>true</td><td>&quot;none&quot;</td></tr><tr><td>&quot;C&quot;</td><td>&quot;RrZ&quot;</td><td>&quot;Rich - met + Z‚Ä¶</td><td>true</td><td>&quot;zinc&quot;</td></tr><tr><td>&quot;D&quot;</td><td>&quot;Rrb&quot;</td><td>&quot;Rich - met + B‚Ä¶</td><td>true</td><td>&quot;B12&quot;</td></tr><tr><td>&quot;E&quot;</td><td>&quot;rm&quot;</td><td>&quot;Rich + met, --‚Ä¶</td><td>false</td><td>&quot;met&quot;</td></tr><tr><td>&quot;F&quot;</td><td>&quot;r&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;none&quot;</td></tr><tr><td>&quot;G&quot;</td><td>&quot;rz&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;zinc&quot;</td></tr><tr><td>&quot;H&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td></tr></tbody></table></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[364]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Experiment&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[365]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span>  <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">15000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[365]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x4376b2860&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_90_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_90_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[366]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">20000</span><span class="p">)</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;3&quot;</span><span class="p">)</span>
           <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[366]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x437805db0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_91_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_91_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[367]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">20000</span><span class="p">)</span>
           <span class="p">)</span>


<span class="n">minimum_start_times</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.06</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">)</span>
<span class="n">minimum_end_times</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.30</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)</span>

<span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_start_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">growth_rate_precise</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">minimum_end_times</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">growth_rate_precise</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_end&quot;</span><span class="p">)))</span>
<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time_exp_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">))</span>

<span class="c1"># correct all od values to start at 0</span>
<span class="c1"># start_od = gr_time_filter.group_by(&quot;Well&quot;).agg(pl.min(&quot;OD&quot;).alias(&quot;Start_OD&quot;)).sort(&quot;Start_OD&quot;)</span>
<span class="c1"># gr_time_filter = gr_time_filter.join(start_od, on=&quot;Well&quot;)</span>
<span class="c1"># gr_time_filter = gr_time_filter.with_columns((pl.col(&quot;OD&quot;) - pl.col(&quot;Start_OD&quot;)).alias(&quot;Corrected_OD&quot;))</span>

<span class="c1"># correct by linear fit</span>

<span class="c1">#This is what you need</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Well&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress</span><span class="p">,</span> <span class="s1">&#39;OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">correction_offset</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">correction_offset</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">correction_offset</span><span class="p">)</span>

<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">correction_offset</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">)</span>
<span class="n">gr_time_filter</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;intercept&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Corrected_OD&quot;</span><span class="p">))</span>

<span class="n">gr_time_filter</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[367]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1_388, 15)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Experiment</th><th>Replicate</th><th>Abb</th><th>Description</th><th>Pre-met</th><th>Additive</th><th>Time_exp_start</th><th>Time_exp_end</th><th>Corrected_time</th><th>Corrected_time_right</th><th>intercept</th><th>Corrected_OD</th></tr><tr><td>i64</td><td>str</td><td>f64</td><td>str</td><td>str</td><td>str</td><td>str</td><td>bool</td><td>str</td><td>i64</td><td>i64</td><td>i64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>4140</td><td>&quot;A3&quot;</td><td>0.066</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>180</td><td>0.000069</td><td>0.032632</td><td>0.033368</td></tr><tr><td>4320</td><td>&quot;A3&quot;</td><td>0.075</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>360</td><td>0.000069</td><td>0.032632</td><td>0.042368</td></tr><tr><td>4500</td><td>&quot;A3&quot;</td><td>0.085</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>540</td><td>0.000069</td><td>0.032632</td><td>0.052368</td></tr><tr><td>4680</td><td>&quot;A3&quot;</td><td>0.082</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>720</td><td>0.000069</td><td>0.032632</td><td>0.049368</td></tr><tr><td>4860</td><td>&quot;A3&quot;</td><td>0.087</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>900</td><td>0.000069</td><td>0.032632</td><td>0.054368</td></tr><tr><td>5040</td><td>&quot;A3&quot;</td><td>0.09</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>1080</td><td>0.000069</td><td>0.032632</td><td>0.057368</td></tr><tr><td>5220</td><td>&quot;A3&quot;</td><td>0.105</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>1260</td><td>0.000069</td><td>0.032632</td><td>0.072368</td></tr><tr><td>5400</td><td>&quot;A3&quot;</td><td>0.115</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>1440</td><td>0.000069</td><td>0.032632</td><td>0.082368</td></tr><tr><td>5580</td><td>&quot;A3&quot;</td><td>0.129</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>1620</td><td>0.000069</td><td>0.032632</td><td>0.096368</td></tr><tr><td>5760</td><td>&quot;A3&quot;</td><td>0.135</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>1800</td><td>0.000069</td><td>0.032632</td><td>0.102368</td></tr><tr><td>5940</td><td>&quot;A3&quot;</td><td>0.188</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>1980</td><td>0.000069</td><td>0.032632</td><td>0.155368</td></tr><tr><td>6120</td><td>&quot;A3&quot;</td><td>0.183</td><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td><td>3960</td><td>7560</td><td>2160</td><td>0.000069</td><td>0.032632</td><td>0.150368</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>9900</td><td>&quot;H10&quot;</td><td>0.163</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>2160</td><td>0.00006</td><td>0.046715</td><td>0.116285</td></tr><tr><td>10080</td><td>&quot;H10&quot;</td><td>0.171</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>2340</td><td>0.00006</td><td>0.046715</td><td>0.124285</td></tr><tr><td>10260</td><td>&quot;H10&quot;</td><td>0.205</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>2520</td><td>0.00006</td><td>0.046715</td><td>0.158285</td></tr><tr><td>10440</td><td>&quot;H10&quot;</td><td>0.208</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>2700</td><td>0.00006</td><td>0.046715</td><td>0.161285</td></tr><tr><td>10620</td><td>&quot;H10&quot;</td><td>0.248</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>2880</td><td>0.00006</td><td>0.046715</td><td>0.201285</td></tr><tr><td>10800</td><td>&quot;H10&quot;</td><td>0.244</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>3060</td><td>0.00006</td><td>0.046715</td><td>0.197285</td></tr><tr><td>10980</td><td>&quot;H10&quot;</td><td>0.261</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>3240</td><td>0.00006</td><td>0.046715</td><td>0.214285</td></tr><tr><td>11160</td><td>&quot;H10&quot;</td><td>0.254</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>3420</td><td>0.00006</td><td>0.046715</td><td>0.207285</td></tr><tr><td>11340</td><td>&quot;H10&quot;</td><td>0.258</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>3600</td><td>0.00006</td><td>0.046715</td><td>0.211285</td></tr><tr><td>11520</td><td>&quot;H10&quot;</td><td>0.27</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>3780</td><td>0.00006</td><td>0.046715</td><td>0.223285</td></tr><tr><td>11700</td><td>&quot;H10&quot;</td><td>0.276</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>3960</td><td>0.00006</td><td>0.046715</td><td>0.229285</td></tr><tr><td>11880</td><td>&quot;H10&quot;</td><td>0.283</td><td>&quot;H&quot;</td><td>&quot;10&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td><td>7740</td><td>12060</td><td>4140</td><td>0.00006</td><td>0.046715</td><td>0.236285</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[368]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> \
            <span class="n">data</span><span class="o">=</span><span class="n">gr_time_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[368]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x3f39c0a30&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_93_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_93_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[369]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">gr_time_filter</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[369]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x438f4e1d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_94_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_94_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[370]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Corrected_time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Corrected_OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">gr_time_filter</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[370]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x412a01960&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_95_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_95_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[371]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">gr_time_filter</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Additive&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">regress_error</span><span class="p">,</span> <span class="s1">&#39;Corrected_OD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Corrected_time&#39;</span><span class="p">])</span>
<span class="n">predicted_gr</span> <span class="o">=</span> <span class="n">predicted_gr</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">predicted_gr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[371]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Additive</th>
      <th>slope</th>
      <th>intercept</th>
      <th>slope_e</th>
      <th>intercept_e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B12</td>
      <td>0.000064</td>
      <td>0.005133</td>
      <td>8.400059e-07</td>
      <td>0.001903</td>
    </tr>
    <tr>
      <th>1</th>
      <td>met</td>
      <td>0.000064</td>
      <td>0.002766</td>
      <td>1.026165e-06</td>
      <td>0.002208</td>
    </tr>
    <tr>
      <th>2</th>
      <td>none</td>
      <td>0.000058</td>
      <td>0.003657</td>
      <td>7.807927e-07</td>
      <td>0.001988</td>
    </tr>
    <tr>
      <th>3</th>
      <td>zinc</td>
      <td>0.000057</td>
      <td>0.003028</td>
      <td>8.443688e-07</td>
      <td>0.002128</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="2nd-round,-different-overnight-media-+/--met">
<h1>2nd round, different overnight media +/- met<a class="headerlink" href="#2nd-round,-different-overnight-media-+/--met" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[372]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bf</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/adrian_growth_jan25_blanks.csv&quot;</span><span class="p">)</span>
<span class="n">bf</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;TÔøΩ 600&#39;</span><span class="p">)</span>
<span class="n">bfm</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">bfm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">bfm</span> <span class="o">=</span> <span class="n">bfm</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">bfm</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[373]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/adrian_growth_jan25_v2.csv&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;T‚àû 600&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[373]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (217, 66)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>T600</th><th>A2</th><th>A3</th><th>A4</th><th>A5</th><th>A6</th><th>A7</th><th>A8</th><th>A9</th><th>B2</th><th>B3</th><th>B4</th><th>B5</th><th>B6</th><th>B7</th><th>B8</th><th>B9</th><th>C2</th><th>C3</th><th>C4</th><th>C5</th><th>C6</th><th>C7</th><th>C8</th><th>C9</th><th>D2</th><th>D3</th><th>D4</th><th>D5</th><th>D6</th><th>D7</th><th>D8</th><th>D9</th><th>E2</th><th>E3</th><th>E4</th><th>E5</th><th>E6</th><th>E7</th><th>E8</th><th>E9</th><th>F2</th><th>F3</th><th>F4</th><th>F5</th><th>F6</th><th>F7</th><th>F8</th><th>F9</th><th>G2</th><th>G3</th><th>G4</th><th>G5</th><th>G6</th><th>G7</th><th>G8</th><th>G9</th><th>H2</th><th>H3</th><th>H4</th><th>H5</th><th>H6</th><th>H7</th><th>H8</th><th>H9</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;00:04:10&quot;</td><td>36.9</td><td>0.924</td><td>0.844</td><td>0.944</td><td>0.963</td><td>1.081</td><td>0.823</td><td>0.942</td><td>1.072</td><td>0.928</td><td>0.939</td><td>1.04</td><td>0.863</td><td>0.742</td><td>0.71</td><td>0.998</td><td>0.749</td><td>0.916</td><td>0.917</td><td>0.81</td><td>0.801</td><td>0.842</td><td>0.968</td><td>0.85</td><td>1.086</td><td>0.836</td><td>0.896</td><td>0.934</td><td>0.848</td><td>0.966</td><td>1.031</td><td>1.074</td><td>0.894</td><td>0.859</td><td>0.81</td><td>0.927</td><td>1.08</td><td>0.833</td><td>0.924</td><td>0.873</td><td>0.783</td><td>0.641</td><td>0.742</td><td>0.962</td><td>0.663</td><td>0.772</td><td>0.93</td><td>0.882</td><td>0.894</td><td>0.834</td><td>0.818</td><td>0.704</td><td>0.911</td><td>0.743</td><td>0.864</td><td>0.841</td><td>0.774</td><td>0.951</td><td>0.848</td><td>0.932</td><td>0.916</td><td>0.786</td><td>0.768</td><td>0.883</td><td>0.938</td></tr><tr><td>&quot;00:09:10&quot;</td><td>37.1</td><td>0.923</td><td>0.842</td><td>0.944</td><td>0.964</td><td>1.08</td><td>0.823</td><td>0.943</td><td>1.067</td><td>0.93</td><td>0.942</td><td>1.041</td><td>0.862</td><td>0.737</td><td>0.71</td><td>0.998</td><td>0.748</td><td>0.917</td><td>0.916</td><td>0.812</td><td>0.797</td><td>0.837</td><td>0.97</td><td>0.85</td><td>1.087</td><td>0.837</td><td>0.896</td><td>0.932</td><td>0.851</td><td>0.965</td><td>1.028</td><td>1.074</td><td>0.893</td><td>0.858</td><td>0.808</td><td>0.928</td><td>1.079</td><td>0.836</td><td>0.926</td><td>0.875</td><td>0.782</td><td>0.645</td><td>0.738</td><td>0.96</td><td>0.664</td><td>0.772</td><td>0.93</td><td>0.882</td><td>0.894</td><td>0.843</td><td>0.819</td><td>0.704</td><td>0.911</td><td>0.744</td><td>0.863</td><td>0.841</td><td>0.77</td><td>0.947</td><td>0.847</td><td>0.931</td><td>0.914</td><td>0.784</td><td>0.768</td><td>0.881</td><td>0.936</td></tr><tr><td>&quot;00:14:10&quot;</td><td>37.0</td><td>0.924</td><td>0.842</td><td>0.941</td><td>0.962</td><td>1.079</td><td>0.829</td><td>0.945</td><td>1.065</td><td>0.932</td><td>0.946</td><td>1.042</td><td>0.86</td><td>0.737</td><td>0.712</td><td>0.999</td><td>0.747</td><td>0.917</td><td>0.919</td><td>0.811</td><td>0.793</td><td>0.838</td><td>0.966</td><td>0.85</td><td>1.087</td><td>0.835</td><td>0.897</td><td>0.93</td><td>0.852</td><td>0.963</td><td>1.025</td><td>1.076</td><td>0.894</td><td>0.858</td><td>0.808</td><td>0.928</td><td>1.077</td><td>0.834</td><td>0.929</td><td>0.878</td><td>0.783</td><td>0.646</td><td>0.736</td><td>0.959</td><td>0.663</td><td>0.771</td><td>0.929</td><td>0.881</td><td>0.892</td><td>0.843</td><td>0.823</td><td>0.703</td><td>0.909</td><td>0.743</td><td>0.864</td><td>0.842</td><td>0.767</td><td>0.938</td><td>0.847</td><td>0.931</td><td>0.914</td><td>0.786</td><td>0.768</td><td>0.882</td><td>0.935</td></tr><tr><td>&quot;00:19:10&quot;</td><td>37.0</td><td>0.925</td><td>0.84</td><td>0.941</td><td>0.962</td><td>1.082</td><td>0.831</td><td>0.946</td><td>1.065</td><td>0.93</td><td>0.951</td><td>1.042</td><td>0.859</td><td>0.739</td><td>0.713</td><td>0.998</td><td>0.747</td><td>0.917</td><td>0.92</td><td>0.812</td><td>0.791</td><td>0.832</td><td>0.967</td><td>0.85</td><td>1.087</td><td>0.836</td><td>0.899</td><td>0.928</td><td>0.852</td><td>0.961</td><td>1.025</td><td>1.076</td><td>0.894</td><td>0.858</td><td>0.808</td><td>0.927</td><td>1.078</td><td>0.832</td><td>0.932</td><td>0.877</td><td>0.782</td><td>0.65</td><td>0.736</td><td>0.959</td><td>0.667</td><td>0.77</td><td>0.929</td><td>0.881</td><td>0.892</td><td>0.845</td><td>0.821</td><td>0.703</td><td>0.91</td><td>0.742</td><td>0.862</td><td>0.842</td><td>0.767</td><td>0.937</td><td>0.847</td><td>0.931</td><td>0.915</td><td>0.785</td><td>0.768</td><td>0.882</td><td>0.934</td></tr><tr><td>&quot;00:24:10&quot;</td><td>37.1</td><td>0.924</td><td>0.841</td><td>0.942</td><td>0.961</td><td>1.083</td><td>0.845</td><td>0.946</td><td>1.064</td><td>0.932</td><td>0.953</td><td>1.042</td><td>0.859</td><td>0.747</td><td>0.716</td><td>0.999</td><td>0.747</td><td>0.918</td><td>0.919</td><td>0.811</td><td>0.792</td><td>0.833</td><td>0.968</td><td>0.848</td><td>1.087</td><td>0.836</td><td>0.9</td><td>0.928</td><td>0.854</td><td>0.96</td><td>1.026</td><td>1.075</td><td>0.894</td><td>0.858</td><td>0.808</td><td>0.926</td><td>1.076</td><td>0.832</td><td>0.935</td><td>0.879</td><td>0.784</td><td>0.652</td><td>0.735</td><td>0.957</td><td>0.669</td><td>0.771</td><td>0.928</td><td>0.881</td><td>0.89</td><td>0.846</td><td>0.822</td><td>0.704</td><td>0.909</td><td>0.743</td><td>0.861</td><td>0.841</td><td>0.768</td><td>0.936</td><td>0.847</td><td>0.931</td><td>0.915</td><td>0.786</td><td>0.768</td><td>0.883</td><td>0.936</td></tr><tr><td>&quot;00:29:10&quot;</td><td>37.0</td><td>0.923</td><td>0.838</td><td>0.942</td><td>0.96</td><td>1.082</td><td>0.851</td><td>0.95</td><td>1.064</td><td>0.93</td><td>0.955</td><td>1.041</td><td>0.857</td><td>0.75</td><td>0.718</td><td>0.998</td><td>0.747</td><td>0.916</td><td>0.924</td><td>0.81</td><td>0.791</td><td>0.826</td><td>0.97</td><td>0.848</td><td>1.086</td><td>0.835</td><td>0.902</td><td>0.927</td><td>0.855</td><td>0.96</td><td>1.026</td><td>1.076</td><td>0.895</td><td>0.857</td><td>0.809</td><td>0.926</td><td>1.074</td><td>0.832</td><td>0.937</td><td>0.88</td><td>0.785</td><td>0.656</td><td>0.735</td><td>0.957</td><td>0.67</td><td>0.77</td><td>0.927</td><td>0.882</td><td>0.89</td><td>0.847</td><td>0.822</td><td>0.704</td><td>0.909</td><td>0.742</td><td>0.861</td><td>0.841</td><td>0.772</td><td>0.937</td><td>0.846</td><td>0.931</td><td>0.915</td><td>0.786</td><td>0.768</td><td>0.884</td><td>0.937</td></tr><tr><td>&quot;00:34:10&quot;</td><td>37.0</td><td>0.923</td><td>0.842</td><td>0.942</td><td>0.96</td><td>1.082</td><td>0.862</td><td>0.947</td><td>1.064</td><td>0.931</td><td>0.957</td><td>1.042</td><td>0.859</td><td>0.748</td><td>0.722</td><td>0.999</td><td>0.749</td><td>0.915</td><td>0.923</td><td>0.811</td><td>0.79</td><td>0.823</td><td>0.968</td><td>0.848</td><td>1.085</td><td>0.835</td><td>0.903</td><td>0.926</td><td>0.855</td><td>0.958</td><td>1.026</td><td>1.076</td><td>0.893</td><td>0.858</td><td>0.81</td><td>0.925</td><td>1.073</td><td>0.832</td><td>0.94</td><td>0.88</td><td>0.786</td><td>0.657</td><td>0.734</td><td>0.956</td><td>0.673</td><td>0.771</td><td>0.928</td><td>0.881</td><td>0.889</td><td>0.848</td><td>0.823</td><td>0.705</td><td>0.909</td><td>0.742</td><td>0.859</td><td>0.842</td><td>0.773</td><td>0.932</td><td>0.847</td><td>0.931</td><td>0.916</td><td>0.786</td><td>0.769</td><td>0.883</td><td>0.935</td></tr><tr><td>&quot;00:39:10&quot;</td><td>37.0</td><td>0.921</td><td>0.841</td><td>0.94</td><td>0.96</td><td>1.081</td><td>0.86</td><td>0.947</td><td>1.064</td><td>0.931</td><td>0.959</td><td>1.041</td><td>0.859</td><td>0.745</td><td>0.72</td><td>0.999</td><td>0.749</td><td>0.915</td><td>0.92</td><td>0.81</td><td>0.791</td><td>0.819</td><td>0.969</td><td>0.846</td><td>1.085</td><td>0.834</td><td>0.905</td><td>0.926</td><td>0.855</td><td>0.958</td><td>1.026</td><td>1.078</td><td>0.893</td><td>0.86</td><td>0.811</td><td>0.925</td><td>1.073</td><td>0.83</td><td>0.942</td><td>0.883</td><td>0.787</td><td>0.661</td><td>0.736</td><td>0.957</td><td>0.676</td><td>0.771</td><td>0.927</td><td>0.882</td><td>0.89</td><td>0.849</td><td>0.823</td><td>0.704</td><td>0.912</td><td>0.745</td><td>0.858</td><td>0.843</td><td>0.775</td><td>0.936</td><td>0.847</td><td>0.932</td><td>0.918</td><td>0.787</td><td>0.769</td><td>0.886</td><td>0.935</td></tr><tr><td>&quot;00:44:10&quot;</td><td>37.0</td><td>0.919</td><td>0.84</td><td>0.94</td><td>0.959</td><td>1.081</td><td>0.865</td><td>0.948</td><td>1.063</td><td>0.931</td><td>0.959</td><td>1.04</td><td>0.86</td><td>0.746</td><td>0.726</td><td>1.0</td><td>0.751</td><td>0.916</td><td>0.919</td><td>0.809</td><td>0.791</td><td>0.811</td><td>0.969</td><td>0.847</td><td>1.085</td><td>0.834</td><td>0.906</td><td>0.926</td><td>0.854</td><td>0.958</td><td>1.028</td><td>1.078</td><td>0.894</td><td>0.863</td><td>0.811</td><td>0.925</td><td>1.072</td><td>0.829</td><td>0.944</td><td>0.88</td><td>0.789</td><td>0.663</td><td>0.726</td><td>0.956</td><td>0.676</td><td>0.771</td><td>0.927</td><td>0.882</td><td>0.889</td><td>0.849</td><td>0.822</td><td>0.706</td><td>0.908</td><td>0.741</td><td>0.857</td><td>0.843</td><td>0.772</td><td>0.941</td><td>0.847</td><td>0.93</td><td>0.918</td><td>0.787</td><td>0.774</td><td>0.886</td><td>0.938</td></tr><tr><td>&quot;00:49:10&quot;</td><td>37.0</td><td>0.921</td><td>0.839</td><td>0.94</td><td>0.96</td><td>1.082</td><td>0.87</td><td>0.948</td><td>1.064</td><td>0.928</td><td>0.96</td><td>1.039</td><td>0.858</td><td>0.748</td><td>0.726</td><td>1.0</td><td>0.75</td><td>0.917</td><td>0.921</td><td>0.81</td><td>0.791</td><td>0.81</td><td>0.97</td><td>0.848</td><td>1.085</td><td>0.835</td><td>0.908</td><td>0.925</td><td>0.854</td><td>0.958</td><td>1.027</td><td>1.077</td><td>0.893</td><td>0.863</td><td>0.813</td><td>0.925</td><td>1.072</td><td>0.828</td><td>0.946</td><td>0.884</td><td>0.791</td><td>0.664</td><td>0.727</td><td>0.957</td><td>0.679</td><td>0.772</td><td>0.928</td><td>0.883</td><td>0.89</td><td>0.854</td><td>0.824</td><td>0.707</td><td>0.912</td><td>0.742</td><td>0.857</td><td>0.844</td><td>0.774</td><td>0.946</td><td>0.851</td><td>0.934</td><td>0.92</td><td>0.79</td><td>0.772</td><td>0.891</td><td>0.94</td></tr><tr><td>&quot;00:54:10&quot;</td><td>37.1</td><td>0.92</td><td>0.842</td><td>0.943</td><td>0.96</td><td>1.082</td><td>0.871</td><td>0.95</td><td>1.065</td><td>0.928</td><td>0.963</td><td>1.039</td><td>0.862</td><td>0.748</td><td>0.726</td><td>1.0</td><td>0.753</td><td>0.916</td><td>0.918</td><td>0.81</td><td>0.791</td><td>0.81</td><td>0.976</td><td>0.848</td><td>1.085</td><td>0.836</td><td>0.91</td><td>0.926</td><td>0.857</td><td>0.958</td><td>1.028</td><td>1.077</td><td>0.893</td><td>0.863</td><td>0.814</td><td>0.926</td><td>1.074</td><td>0.83</td><td>0.946</td><td>0.882</td><td>0.792</td><td>0.668</td><td>0.733</td><td>0.959</td><td>0.682</td><td>0.773</td><td>0.928</td><td>0.884</td><td>0.89</td><td>0.854</td><td>0.827</td><td>0.718</td><td>0.913</td><td>0.742</td><td>0.856</td><td>0.845</td><td>0.774</td><td>0.935</td><td>0.853</td><td>0.932</td><td>0.92</td><td>0.793</td><td>0.774</td><td>0.887</td><td>0.934</td></tr><tr><td>&quot;00:59:10&quot;</td><td>37.0</td><td>0.92</td><td>0.842</td><td>0.942</td><td>0.96</td><td>1.081</td><td>0.876</td><td>0.952</td><td>1.065</td><td>0.929</td><td>0.963</td><td>1.039</td><td>0.862</td><td>0.749</td><td>0.731</td><td>1.001</td><td>0.753</td><td>0.917</td><td>0.917</td><td>0.809</td><td>0.791</td><td>0.808</td><td>0.977</td><td>0.848</td><td>1.086</td><td>0.837</td><td>0.911</td><td>0.927</td><td>0.857</td><td>0.958</td><td>1.03</td><td>1.076</td><td>0.897</td><td>0.865</td><td>0.816</td><td>0.927</td><td>1.074</td><td>0.83</td><td>0.947</td><td>0.885</td><td>0.796</td><td>0.669</td><td>0.732</td><td>0.961</td><td>0.683</td><td>0.775</td><td>0.929</td><td>0.884</td><td>0.89</td><td>0.855</td><td>0.825</td><td>0.71</td><td>0.916</td><td>0.742</td><td>0.863</td><td>0.846</td><td>0.776</td><td>0.939</td><td>0.85</td><td>0.932</td><td>0.925</td><td>0.8</td><td>0.781</td><td>0.899</td><td>0.945</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;17:09:10&quot;</td><td>37.1</td><td>1.925</td><td>1.831</td><td>1.892</td><td>1.885</td><td>1.994</td><td>1.879</td><td>1.873</td><td>1.997</td><td>1.6</td><td>1.716</td><td>1.736</td><td>1.612</td><td>1.605</td><td>1.569</td><td>1.711</td><td>1.616</td><td>1.542</td><td>1.583</td><td>1.518</td><td>1.486</td><td>1.474</td><td>1.595</td><td>1.547</td><td>1.696</td><td>1.584</td><td>1.7</td><td>1.686</td><td>1.651</td><td>1.646</td><td>1.748</td><td>1.759</td><td>1.715</td><td>1.913</td><td>1.718</td><td>1.775</td><td>1.857</td><td>1.758</td><td>1.831</td><td>1.849</td><td>1.839</td><td>1.614</td><td>1.587</td><td>1.742</td><td>1.67</td><td>1.688</td><td>1.732</td><td>1.728</td><td>1.695</td><td>1.526</td><td>1.491</td><td>1.502</td><td>1.647</td><td>1.541</td><td>1.575</td><td>1.58</td><td>1.55</td><td>1.74</td><td>1.605</td><td>1.699</td><td>1.705</td><td>1.634</td><td>1.652</td><td>1.773</td><td>1.73</td></tr><tr><td>&quot;17:14:10&quot;</td><td>37.0</td><td>1.927</td><td>1.834</td><td>1.895</td><td>1.888</td><td>1.995</td><td>1.879</td><td>1.876</td><td>1.999</td><td>1.602</td><td>1.719</td><td>1.737</td><td>1.613</td><td>1.608</td><td>1.571</td><td>1.711</td><td>1.619</td><td>1.546</td><td>1.587</td><td>1.521</td><td>1.488</td><td>1.478</td><td>1.599</td><td>1.551</td><td>1.699</td><td>1.588</td><td>1.701</td><td>1.688</td><td>1.651</td><td>1.65</td><td>1.75</td><td>1.761</td><td>1.718</td><td>1.914</td><td>1.719</td><td>1.776</td><td>1.859</td><td>1.76</td><td>1.833</td><td>1.852</td><td>1.84</td><td>1.618</td><td>1.589</td><td>1.744</td><td>1.673</td><td>1.69</td><td>1.736</td><td>1.731</td><td>1.697</td><td>1.53</td><td>1.494</td><td>1.506</td><td>1.649</td><td>1.537</td><td>1.578</td><td>1.58</td><td>1.555</td><td>1.747</td><td>1.609</td><td>1.703</td><td>1.708</td><td>1.636</td><td>1.655</td><td>1.776</td><td>1.735</td></tr><tr><td>&quot;17:19:10&quot;</td><td>37.0</td><td>1.931</td><td>1.838</td><td>1.898</td><td>1.889</td><td>1.997</td><td>1.882</td><td>1.877</td><td>1.999</td><td>1.606</td><td>1.724</td><td>1.739</td><td>1.618</td><td>1.612</td><td>1.573</td><td>1.714</td><td>1.622</td><td>1.552</td><td>1.588</td><td>1.524</td><td>1.491</td><td>1.48</td><td>1.602</td><td>1.555</td><td>1.702</td><td>1.589</td><td>1.702</td><td>1.691</td><td>1.652</td><td>1.651</td><td>1.753</td><td>1.763</td><td>1.721</td><td>1.917</td><td>1.722</td><td>1.779</td><td>1.86</td><td>1.763</td><td>1.835</td><td>1.854</td><td>1.841</td><td>1.621</td><td>1.591</td><td>1.745</td><td>1.674</td><td>1.691</td><td>1.738</td><td>1.732</td><td>1.702</td><td>1.534</td><td>1.498</td><td>1.508</td><td>1.642</td><td>1.541</td><td>1.582</td><td>1.581</td><td>1.56</td><td>1.752</td><td>1.611</td><td>1.706</td><td>1.71</td><td>1.641</td><td>1.657</td><td>1.779</td><td>1.738</td></tr><tr><td>&quot;17:24:10&quot;</td><td>37.1</td><td>1.934</td><td>1.84</td><td>1.902</td><td>1.893</td><td>2.0</td><td>1.883</td><td>1.881</td><td>2.004</td><td>1.608</td><td>1.726</td><td>1.739</td><td>1.617</td><td>1.611</td><td>1.573</td><td>1.715</td><td>1.624</td><td>1.555</td><td>1.592</td><td>1.526</td><td>1.492</td><td>1.483</td><td>1.603</td><td>1.557</td><td>1.704</td><td>1.593</td><td>1.706</td><td>1.693</td><td>1.654</td><td>1.655</td><td>1.752</td><td>1.764</td><td>1.721</td><td>1.919</td><td>1.723</td><td>1.78</td><td>1.861</td><td>1.763</td><td>1.836</td><td>1.855</td><td>1.843</td><td>1.624</td><td>1.593</td><td>1.748</td><td>1.677</td><td>1.694</td><td>1.74</td><td>1.736</td><td>1.703</td><td>1.538</td><td>1.502</td><td>1.513</td><td>1.643</td><td>1.545</td><td>1.585</td><td>1.585</td><td>1.563</td><td>1.758</td><td>1.614</td><td>1.709</td><td>1.712</td><td>1.642</td><td>1.659</td><td>1.781</td><td>1.741</td></tr><tr><td>&quot;17:29:10&quot;</td><td>37.0</td><td>1.938</td><td>1.843</td><td>1.906</td><td>1.897</td><td>2.002</td><td>1.887</td><td>1.884</td><td>2.005</td><td>1.61</td><td>1.728</td><td>1.742</td><td>1.618</td><td>1.612</td><td>1.575</td><td>1.718</td><td>1.625</td><td>1.561</td><td>1.595</td><td>1.527</td><td>1.496</td><td>1.487</td><td>1.607</td><td>1.559</td><td>1.704</td><td>1.597</td><td>1.706</td><td>1.697</td><td>1.657</td><td>1.658</td><td>1.756</td><td>1.767</td><td>1.726</td><td>1.921</td><td>1.723</td><td>1.78</td><td>1.861</td><td>1.765</td><td>1.837</td><td>1.857</td><td>1.845</td><td>1.628</td><td>1.594</td><td>1.748</td><td>1.678</td><td>1.696</td><td>1.743</td><td>1.737</td><td>1.708</td><td>1.544</td><td>1.506</td><td>1.515</td><td>1.646</td><td>1.549</td><td>1.587</td><td>1.588</td><td>1.569</td><td>1.767</td><td>1.621</td><td>1.714</td><td>1.717</td><td>1.648</td><td>1.664</td><td>1.786</td><td>1.746</td></tr><tr><td>&quot;17:34:10&quot;</td><td>37.0</td><td>1.941</td><td>1.847</td><td>1.909</td><td>1.899</td><td>2.005</td><td>1.89</td><td>1.886</td><td>2.007</td><td>1.613</td><td>1.73</td><td>1.742</td><td>1.62</td><td>1.614</td><td>1.576</td><td>1.719</td><td>1.631</td><td>1.565</td><td>1.597</td><td>1.53</td><td>1.499</td><td>1.489</td><td>1.608</td><td>1.563</td><td>1.716</td><td>1.599</td><td>1.708</td><td>1.701</td><td>1.657</td><td>1.659</td><td>1.76</td><td>1.77</td><td>1.727</td><td>1.924</td><td>1.726</td><td>1.783</td><td>1.864</td><td>1.767</td><td>1.84</td><td>1.86</td><td>1.847</td><td>1.631</td><td>1.595</td><td>1.75</td><td>1.679</td><td>1.698</td><td>1.744</td><td>1.74</td><td>1.709</td><td>1.549</td><td>1.509</td><td>1.519</td><td>1.649</td><td>1.549</td><td>1.585</td><td>1.589</td><td>1.573</td><td>1.773</td><td>1.623</td><td>1.717</td><td>1.718</td><td>1.651</td><td>1.666</td><td>1.788</td><td>1.749</td></tr><tr><td>&quot;17:39:10&quot;</td><td>37.0</td><td>1.943</td><td>1.852</td><td>1.914</td><td>1.905</td><td>2.008</td><td>1.893</td><td>1.89</td><td>2.011</td><td>1.615</td><td>1.732</td><td>1.744</td><td>1.622</td><td>1.616</td><td>1.579</td><td>1.72</td><td>1.633</td><td>1.569</td><td>1.599</td><td>1.532</td><td>1.499</td><td>1.492</td><td>1.611</td><td>1.565</td><td>1.716</td><td>1.602</td><td>1.712</td><td>1.706</td><td>1.661</td><td>1.663</td><td>1.76</td><td>1.771</td><td>1.729</td><td>1.927</td><td>1.726</td><td>1.784</td><td>1.864</td><td>1.768</td><td>1.84</td><td>1.859</td><td>1.849</td><td>1.633</td><td>1.6</td><td>1.752</td><td>1.682</td><td>1.701</td><td>1.747</td><td>1.742</td><td>1.714</td><td>1.554</td><td>1.514</td><td>1.522</td><td>1.653</td><td>1.553</td><td>1.594</td><td>1.591</td><td>1.578</td><td>1.78</td><td>1.626</td><td>1.72</td><td>1.721</td><td>1.654</td><td>1.669</td><td>1.79</td><td>1.754</td></tr><tr><td>&quot;17:44:10&quot;</td><td>37.0</td><td>1.946</td><td>1.854</td><td>1.916</td><td>1.907</td><td>2.008</td><td>1.893</td><td>1.891</td><td>2.01</td><td>1.617</td><td>1.735</td><td>1.746</td><td>1.623</td><td>1.616</td><td>1.58</td><td>1.722</td><td>1.637</td><td>1.571</td><td>1.603</td><td>1.536</td><td>1.504</td><td>1.494</td><td>1.613</td><td>1.57</td><td>1.722</td><td>1.605</td><td>1.71</td><td>1.706</td><td>1.661</td><td>1.666</td><td>1.763</td><td>1.773</td><td>1.732</td><td>1.928</td><td>1.728</td><td>1.784</td><td>1.865</td><td>1.769</td><td>1.843</td><td>1.863</td><td>1.851</td><td>1.637</td><td>1.6</td><td>1.754</td><td>1.684</td><td>1.702</td><td>1.748</td><td>1.744</td><td>1.715</td><td>1.557</td><td>1.516</td><td>1.516</td><td>1.652</td><td>1.551</td><td>1.596</td><td>1.59</td><td>1.58</td><td>1.786</td><td>1.63</td><td>1.724</td><td>1.721</td><td>1.656</td><td>1.671</td><td>1.793</td><td>1.758</td></tr><tr><td>&quot;17:49:10&quot;</td><td>37.0</td><td>1.949</td><td>1.859</td><td>1.921</td><td>1.913</td><td>2.012</td><td>1.898</td><td>1.895</td><td>2.015</td><td>1.618</td><td>1.734</td><td>1.745</td><td>1.622</td><td>1.616</td><td>1.579</td><td>1.72</td><td>1.636</td><td>1.574</td><td>1.604</td><td>1.538</td><td>1.505</td><td>1.496</td><td>1.615</td><td>1.571</td><td>1.719</td><td>1.608</td><td>1.716</td><td>1.71</td><td>1.664</td><td>1.669</td><td>1.765</td><td>1.774</td><td>1.732</td><td>1.931</td><td>1.728</td><td>1.786</td><td>1.865</td><td>1.77</td><td>1.843</td><td>1.863</td><td>1.851</td><td>1.641</td><td>1.603</td><td>1.758</td><td>1.688</td><td>1.706</td><td>1.752</td><td>1.747</td><td>1.718</td><td>1.56</td><td>1.518</td><td>1.522</td><td>1.654</td><td>1.551</td><td>1.596</td><td>1.59</td><td>1.581</td><td>1.79</td><td>1.632</td><td>1.727</td><td>1.725</td><td>1.659</td><td>1.671</td><td>1.795</td><td>1.761</td></tr><tr><td>&quot;17:54:10&quot;</td><td>37.0</td><td>1.953</td><td>1.861</td><td>1.922</td><td>1.914</td><td>2.013</td><td>1.899</td><td>1.896</td><td>2.014</td><td>1.622</td><td>1.738</td><td>1.749</td><td>1.625</td><td>1.618</td><td>1.582</td><td>1.724</td><td>1.641</td><td>1.58</td><td>1.606</td><td>1.54</td><td>1.509</td><td>1.499</td><td>1.617</td><td>1.574</td><td>1.722</td><td>1.612</td><td>1.716</td><td>1.711</td><td>1.664</td><td>1.672</td><td>1.769</td><td>1.776</td><td>1.736</td><td>1.932</td><td>1.73</td><td>1.787</td><td>1.867</td><td>1.772</td><td>1.846</td><td>1.867</td><td>1.853</td><td>1.645</td><td>1.603</td><td>1.758</td><td>1.689</td><td>1.706</td><td>1.753</td><td>1.748</td><td>1.72</td><td>1.565</td><td>1.522</td><td>1.524</td><td>1.655</td><td>1.551</td><td>1.596</td><td>1.591</td><td>1.583</td><td>1.798</td><td>1.637</td><td>1.732</td><td>1.728</td><td>1.664</td><td>1.676</td><td>1.798</td><td>1.764</td></tr><tr><td>&quot;17:59:10&quot;</td><td>37.0</td><td>1.955</td><td>1.866</td><td>1.926</td><td>1.919</td><td>2.017</td><td>1.903</td><td>1.899</td><td>2.018</td><td>1.624</td><td>1.739</td><td>1.749</td><td>1.626</td><td>1.618</td><td>1.583</td><td>1.725</td><td>1.645</td><td>1.583</td><td>1.609</td><td>1.543</td><td>1.512</td><td>1.499</td><td>1.618</td><td>1.576</td><td>1.727</td><td>1.615</td><td>1.718</td><td>1.714</td><td>1.666</td><td>1.673</td><td>1.77</td><td>1.778</td><td>1.738</td><td>1.935</td><td>1.731</td><td>1.789</td><td>1.868</td><td>1.774</td><td>1.848</td><td>1.869</td><td>1.855</td><td>1.648</td><td>1.604</td><td>1.76</td><td>1.688</td><td>1.708</td><td>1.754</td><td>1.749</td><td>1.724</td><td>1.567</td><td>1.525</td><td>1.526</td><td>1.655</td><td>1.552</td><td>1.597</td><td>1.593</td><td>1.586</td><td>1.805</td><td>1.641</td><td>1.736</td><td>1.731</td><td>1.667</td><td>1.679</td><td>1.8</td><td>1.769</td></tr><tr><td>&quot;18:04:10&quot;</td><td>37.0</td><td>1.958</td><td>1.868</td><td>1.929</td><td>1.922</td><td>2.018</td><td>1.906</td><td>1.903</td><td>2.022</td><td>1.627</td><td>1.74</td><td>1.752</td><td>1.629</td><td>1.62</td><td>1.582</td><td>1.726</td><td>1.647</td><td>1.585</td><td>1.609</td><td>1.543</td><td>1.511</td><td>1.502</td><td>1.619</td><td>1.579</td><td>1.726</td><td>1.617</td><td>1.718</td><td>1.716</td><td>1.667</td><td>1.674</td><td>1.773</td><td>1.781</td><td>1.739</td><td>1.938</td><td>1.733</td><td>1.79</td><td>1.869</td><td>1.775</td><td>1.849</td><td>1.87</td><td>1.856</td><td>1.652</td><td>1.606</td><td>1.762</td><td>1.69</td><td>1.709</td><td>1.756</td><td>1.752</td><td>1.726</td><td>1.574</td><td>1.528</td><td>1.528</td><td>1.658</td><td>1.554</td><td>1.598</td><td>1.594</td><td>1.59</td><td>1.809</td><td>1.641</td><td>1.737</td><td>1.732</td><td>1.668</td><td>1.68</td><td>1.803</td><td>1.772</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[374]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">to_time</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="mi">3600</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">minute</span><span class="p">()</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span><span class="p">())</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[374]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (217, 66)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>T600</th><th>A2</th><th>A3</th><th>A4</th><th>A5</th><th>A6</th><th>A7</th><th>A8</th><th>A9</th><th>B2</th><th>B3</th><th>B4</th><th>B5</th><th>B6</th><th>B7</th><th>B8</th><th>B9</th><th>C2</th><th>C3</th><th>C4</th><th>C5</th><th>C6</th><th>C7</th><th>C8</th><th>C9</th><th>D2</th><th>D3</th><th>D4</th><th>D5</th><th>D6</th><th>D7</th><th>D8</th><th>D9</th><th>E2</th><th>E3</th><th>E4</th><th>E5</th><th>E6</th><th>E7</th><th>E8</th><th>E9</th><th>F2</th><th>F3</th><th>F4</th><th>F5</th><th>F6</th><th>F7</th><th>F8</th><th>F9</th><th>G2</th><th>G3</th><th>G4</th><th>G5</th><th>G6</th><th>G7</th><th>G8</th><th>G9</th><th>H2</th><th>H3</th><th>H4</th><th>H5</th><th>H6</th><th>H7</th><th>H8</th><th>H9</th></tr><tr><td>i64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>250</td><td>36.9</td><td>0.924</td><td>0.844</td><td>0.944</td><td>0.963</td><td>1.081</td><td>0.823</td><td>0.942</td><td>1.072</td><td>0.928</td><td>0.939</td><td>1.04</td><td>0.863</td><td>0.742</td><td>0.71</td><td>0.998</td><td>0.749</td><td>0.916</td><td>0.917</td><td>0.81</td><td>0.801</td><td>0.842</td><td>0.968</td><td>0.85</td><td>1.086</td><td>0.836</td><td>0.896</td><td>0.934</td><td>0.848</td><td>0.966</td><td>1.031</td><td>1.074</td><td>0.894</td><td>0.859</td><td>0.81</td><td>0.927</td><td>1.08</td><td>0.833</td><td>0.924</td><td>0.873</td><td>0.783</td><td>0.641</td><td>0.742</td><td>0.962</td><td>0.663</td><td>0.772</td><td>0.93</td><td>0.882</td><td>0.894</td><td>0.834</td><td>0.818</td><td>0.704</td><td>0.911</td><td>0.743</td><td>0.864</td><td>0.841</td><td>0.774</td><td>0.951</td><td>0.848</td><td>0.932</td><td>0.916</td><td>0.786</td><td>0.768</td><td>0.883</td><td>0.938</td></tr><tr><td>550</td><td>37.1</td><td>0.923</td><td>0.842</td><td>0.944</td><td>0.964</td><td>1.08</td><td>0.823</td><td>0.943</td><td>1.067</td><td>0.93</td><td>0.942</td><td>1.041</td><td>0.862</td><td>0.737</td><td>0.71</td><td>0.998</td><td>0.748</td><td>0.917</td><td>0.916</td><td>0.812</td><td>0.797</td><td>0.837</td><td>0.97</td><td>0.85</td><td>1.087</td><td>0.837</td><td>0.896</td><td>0.932</td><td>0.851</td><td>0.965</td><td>1.028</td><td>1.074</td><td>0.893</td><td>0.858</td><td>0.808</td><td>0.928</td><td>1.079</td><td>0.836</td><td>0.926</td><td>0.875</td><td>0.782</td><td>0.645</td><td>0.738</td><td>0.96</td><td>0.664</td><td>0.772</td><td>0.93</td><td>0.882</td><td>0.894</td><td>0.843</td><td>0.819</td><td>0.704</td><td>0.911</td><td>0.744</td><td>0.863</td><td>0.841</td><td>0.77</td><td>0.947</td><td>0.847</td><td>0.931</td><td>0.914</td><td>0.784</td><td>0.768</td><td>0.881</td><td>0.936</td></tr><tr><td>850</td><td>37.0</td><td>0.924</td><td>0.842</td><td>0.941</td><td>0.962</td><td>1.079</td><td>0.829</td><td>0.945</td><td>1.065</td><td>0.932</td><td>0.946</td><td>1.042</td><td>0.86</td><td>0.737</td><td>0.712</td><td>0.999</td><td>0.747</td><td>0.917</td><td>0.919</td><td>0.811</td><td>0.793</td><td>0.838</td><td>0.966</td><td>0.85</td><td>1.087</td><td>0.835</td><td>0.897</td><td>0.93</td><td>0.852</td><td>0.963</td><td>1.025</td><td>1.076</td><td>0.894</td><td>0.858</td><td>0.808</td><td>0.928</td><td>1.077</td><td>0.834</td><td>0.929</td><td>0.878</td><td>0.783</td><td>0.646</td><td>0.736</td><td>0.959</td><td>0.663</td><td>0.771</td><td>0.929</td><td>0.881</td><td>0.892</td><td>0.843</td><td>0.823</td><td>0.703</td><td>0.909</td><td>0.743</td><td>0.864</td><td>0.842</td><td>0.767</td><td>0.938</td><td>0.847</td><td>0.931</td><td>0.914</td><td>0.786</td><td>0.768</td><td>0.882</td><td>0.935</td></tr><tr><td>1150</td><td>37.0</td><td>0.925</td><td>0.84</td><td>0.941</td><td>0.962</td><td>1.082</td><td>0.831</td><td>0.946</td><td>1.065</td><td>0.93</td><td>0.951</td><td>1.042</td><td>0.859</td><td>0.739</td><td>0.713</td><td>0.998</td><td>0.747</td><td>0.917</td><td>0.92</td><td>0.812</td><td>0.791</td><td>0.832</td><td>0.967</td><td>0.85</td><td>1.087</td><td>0.836</td><td>0.899</td><td>0.928</td><td>0.852</td><td>0.961</td><td>1.025</td><td>1.076</td><td>0.894</td><td>0.858</td><td>0.808</td><td>0.927</td><td>1.078</td><td>0.832</td><td>0.932</td><td>0.877</td><td>0.782</td><td>0.65</td><td>0.736</td><td>0.959</td><td>0.667</td><td>0.77</td><td>0.929</td><td>0.881</td><td>0.892</td><td>0.845</td><td>0.821</td><td>0.703</td><td>0.91</td><td>0.742</td><td>0.862</td><td>0.842</td><td>0.767</td><td>0.937</td><td>0.847</td><td>0.931</td><td>0.915</td><td>0.785</td><td>0.768</td><td>0.882</td><td>0.934</td></tr><tr><td>1450</td><td>37.1</td><td>0.924</td><td>0.841</td><td>0.942</td><td>0.961</td><td>1.083</td><td>0.845</td><td>0.946</td><td>1.064</td><td>0.932</td><td>0.953</td><td>1.042</td><td>0.859</td><td>0.747</td><td>0.716</td><td>0.999</td><td>0.747</td><td>0.918</td><td>0.919</td><td>0.811</td><td>0.792</td><td>0.833</td><td>0.968</td><td>0.848</td><td>1.087</td><td>0.836</td><td>0.9</td><td>0.928</td><td>0.854</td><td>0.96</td><td>1.026</td><td>1.075</td><td>0.894</td><td>0.858</td><td>0.808</td><td>0.926</td><td>1.076</td><td>0.832</td><td>0.935</td><td>0.879</td><td>0.784</td><td>0.652</td><td>0.735</td><td>0.957</td><td>0.669</td><td>0.771</td><td>0.928</td><td>0.881</td><td>0.89</td><td>0.846</td><td>0.822</td><td>0.704</td><td>0.909</td><td>0.743</td><td>0.861</td><td>0.841</td><td>0.768</td><td>0.936</td><td>0.847</td><td>0.931</td><td>0.915</td><td>0.786</td><td>0.768</td><td>0.883</td><td>0.936</td></tr><tr><td>1750</td><td>37.0</td><td>0.923</td><td>0.838</td><td>0.942</td><td>0.96</td><td>1.082</td><td>0.851</td><td>0.95</td><td>1.064</td><td>0.93</td><td>0.955</td><td>1.041</td><td>0.857</td><td>0.75</td><td>0.718</td><td>0.998</td><td>0.747</td><td>0.916</td><td>0.924</td><td>0.81</td><td>0.791</td><td>0.826</td><td>0.97</td><td>0.848</td><td>1.086</td><td>0.835</td><td>0.902</td><td>0.927</td><td>0.855</td><td>0.96</td><td>1.026</td><td>1.076</td><td>0.895</td><td>0.857</td><td>0.809</td><td>0.926</td><td>1.074</td><td>0.832</td><td>0.937</td><td>0.88</td><td>0.785</td><td>0.656</td><td>0.735</td><td>0.957</td><td>0.67</td><td>0.77</td><td>0.927</td><td>0.882</td><td>0.89</td><td>0.847</td><td>0.822</td><td>0.704</td><td>0.909</td><td>0.742</td><td>0.861</td><td>0.841</td><td>0.772</td><td>0.937</td><td>0.846</td><td>0.931</td><td>0.915</td><td>0.786</td><td>0.768</td><td>0.884</td><td>0.937</td></tr><tr><td>2050</td><td>37.0</td><td>0.923</td><td>0.842</td><td>0.942</td><td>0.96</td><td>1.082</td><td>0.862</td><td>0.947</td><td>1.064</td><td>0.931</td><td>0.957</td><td>1.042</td><td>0.859</td><td>0.748</td><td>0.722</td><td>0.999</td><td>0.749</td><td>0.915</td><td>0.923</td><td>0.811</td><td>0.79</td><td>0.823</td><td>0.968</td><td>0.848</td><td>1.085</td><td>0.835</td><td>0.903</td><td>0.926</td><td>0.855</td><td>0.958</td><td>1.026</td><td>1.076</td><td>0.893</td><td>0.858</td><td>0.81</td><td>0.925</td><td>1.073</td><td>0.832</td><td>0.94</td><td>0.88</td><td>0.786</td><td>0.657</td><td>0.734</td><td>0.956</td><td>0.673</td><td>0.771</td><td>0.928</td><td>0.881</td><td>0.889</td><td>0.848</td><td>0.823</td><td>0.705</td><td>0.909</td><td>0.742</td><td>0.859</td><td>0.842</td><td>0.773</td><td>0.932</td><td>0.847</td><td>0.931</td><td>0.916</td><td>0.786</td><td>0.769</td><td>0.883</td><td>0.935</td></tr><tr><td>2350</td><td>37.0</td><td>0.921</td><td>0.841</td><td>0.94</td><td>0.96</td><td>1.081</td><td>0.86</td><td>0.947</td><td>1.064</td><td>0.931</td><td>0.959</td><td>1.041</td><td>0.859</td><td>0.745</td><td>0.72</td><td>0.999</td><td>0.749</td><td>0.915</td><td>0.92</td><td>0.81</td><td>0.791</td><td>0.819</td><td>0.969</td><td>0.846</td><td>1.085</td><td>0.834</td><td>0.905</td><td>0.926</td><td>0.855</td><td>0.958</td><td>1.026</td><td>1.078</td><td>0.893</td><td>0.86</td><td>0.811</td><td>0.925</td><td>1.073</td><td>0.83</td><td>0.942</td><td>0.883</td><td>0.787</td><td>0.661</td><td>0.736</td><td>0.957</td><td>0.676</td><td>0.771</td><td>0.927</td><td>0.882</td><td>0.89</td><td>0.849</td><td>0.823</td><td>0.704</td><td>0.912</td><td>0.745</td><td>0.858</td><td>0.843</td><td>0.775</td><td>0.936</td><td>0.847</td><td>0.932</td><td>0.918</td><td>0.787</td><td>0.769</td><td>0.886</td><td>0.935</td></tr><tr><td>2650</td><td>37.0</td><td>0.919</td><td>0.84</td><td>0.94</td><td>0.959</td><td>1.081</td><td>0.865</td><td>0.948</td><td>1.063</td><td>0.931</td><td>0.959</td><td>1.04</td><td>0.86</td><td>0.746</td><td>0.726</td><td>1.0</td><td>0.751</td><td>0.916</td><td>0.919</td><td>0.809</td><td>0.791</td><td>0.811</td><td>0.969</td><td>0.847</td><td>1.085</td><td>0.834</td><td>0.906</td><td>0.926</td><td>0.854</td><td>0.958</td><td>1.028</td><td>1.078</td><td>0.894</td><td>0.863</td><td>0.811</td><td>0.925</td><td>1.072</td><td>0.829</td><td>0.944</td><td>0.88</td><td>0.789</td><td>0.663</td><td>0.726</td><td>0.956</td><td>0.676</td><td>0.771</td><td>0.927</td><td>0.882</td><td>0.889</td><td>0.849</td><td>0.822</td><td>0.706</td><td>0.908</td><td>0.741</td><td>0.857</td><td>0.843</td><td>0.772</td><td>0.941</td><td>0.847</td><td>0.93</td><td>0.918</td><td>0.787</td><td>0.774</td><td>0.886</td><td>0.938</td></tr><tr><td>2950</td><td>37.0</td><td>0.921</td><td>0.839</td><td>0.94</td><td>0.96</td><td>1.082</td><td>0.87</td><td>0.948</td><td>1.064</td><td>0.928</td><td>0.96</td><td>1.039</td><td>0.858</td><td>0.748</td><td>0.726</td><td>1.0</td><td>0.75</td><td>0.917</td><td>0.921</td><td>0.81</td><td>0.791</td><td>0.81</td><td>0.97</td><td>0.848</td><td>1.085</td><td>0.835</td><td>0.908</td><td>0.925</td><td>0.854</td><td>0.958</td><td>1.027</td><td>1.077</td><td>0.893</td><td>0.863</td><td>0.813</td><td>0.925</td><td>1.072</td><td>0.828</td><td>0.946</td><td>0.884</td><td>0.791</td><td>0.664</td><td>0.727</td><td>0.957</td><td>0.679</td><td>0.772</td><td>0.928</td><td>0.883</td><td>0.89</td><td>0.854</td><td>0.824</td><td>0.707</td><td>0.912</td><td>0.742</td><td>0.857</td><td>0.844</td><td>0.774</td><td>0.946</td><td>0.851</td><td>0.934</td><td>0.92</td><td>0.79</td><td>0.772</td><td>0.891</td><td>0.94</td></tr><tr><td>3250</td><td>37.1</td><td>0.92</td><td>0.842</td><td>0.943</td><td>0.96</td><td>1.082</td><td>0.871</td><td>0.95</td><td>1.065</td><td>0.928</td><td>0.963</td><td>1.039</td><td>0.862</td><td>0.748</td><td>0.726</td><td>1.0</td><td>0.753</td><td>0.916</td><td>0.918</td><td>0.81</td><td>0.791</td><td>0.81</td><td>0.976</td><td>0.848</td><td>1.085</td><td>0.836</td><td>0.91</td><td>0.926</td><td>0.857</td><td>0.958</td><td>1.028</td><td>1.077</td><td>0.893</td><td>0.863</td><td>0.814</td><td>0.926</td><td>1.074</td><td>0.83</td><td>0.946</td><td>0.882</td><td>0.792</td><td>0.668</td><td>0.733</td><td>0.959</td><td>0.682</td><td>0.773</td><td>0.928</td><td>0.884</td><td>0.89</td><td>0.854</td><td>0.827</td><td>0.718</td><td>0.913</td><td>0.742</td><td>0.856</td><td>0.845</td><td>0.774</td><td>0.935</td><td>0.853</td><td>0.932</td><td>0.92</td><td>0.793</td><td>0.774</td><td>0.887</td><td>0.934</td></tr><tr><td>3550</td><td>37.0</td><td>0.92</td><td>0.842</td><td>0.942</td><td>0.96</td><td>1.081</td><td>0.876</td><td>0.952</td><td>1.065</td><td>0.929</td><td>0.963</td><td>1.039</td><td>0.862</td><td>0.749</td><td>0.731</td><td>1.001</td><td>0.753</td><td>0.917</td><td>0.917</td><td>0.809</td><td>0.791</td><td>0.808</td><td>0.977</td><td>0.848</td><td>1.086</td><td>0.837</td><td>0.911</td><td>0.927</td><td>0.857</td><td>0.958</td><td>1.03</td><td>1.076</td><td>0.897</td><td>0.865</td><td>0.816</td><td>0.927</td><td>1.074</td><td>0.83</td><td>0.947</td><td>0.885</td><td>0.796</td><td>0.669</td><td>0.732</td><td>0.961</td><td>0.683</td><td>0.775</td><td>0.929</td><td>0.884</td><td>0.89</td><td>0.855</td><td>0.825</td><td>0.71</td><td>0.916</td><td>0.742</td><td>0.863</td><td>0.846</td><td>0.776</td><td>0.939</td><td>0.85</td><td>0.932</td><td>0.925</td><td>0.8</td><td>0.781</td><td>0.899</td><td>0.945</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>61750</td><td>37.1</td><td>1.925</td><td>1.831</td><td>1.892</td><td>1.885</td><td>1.994</td><td>1.879</td><td>1.873</td><td>1.997</td><td>1.6</td><td>1.716</td><td>1.736</td><td>1.612</td><td>1.605</td><td>1.569</td><td>1.711</td><td>1.616</td><td>1.542</td><td>1.583</td><td>1.518</td><td>1.486</td><td>1.474</td><td>1.595</td><td>1.547</td><td>1.696</td><td>1.584</td><td>1.7</td><td>1.686</td><td>1.651</td><td>1.646</td><td>1.748</td><td>1.759</td><td>1.715</td><td>1.913</td><td>1.718</td><td>1.775</td><td>1.857</td><td>1.758</td><td>1.831</td><td>1.849</td><td>1.839</td><td>1.614</td><td>1.587</td><td>1.742</td><td>1.67</td><td>1.688</td><td>1.732</td><td>1.728</td><td>1.695</td><td>1.526</td><td>1.491</td><td>1.502</td><td>1.647</td><td>1.541</td><td>1.575</td><td>1.58</td><td>1.55</td><td>1.74</td><td>1.605</td><td>1.699</td><td>1.705</td><td>1.634</td><td>1.652</td><td>1.773</td><td>1.73</td></tr><tr><td>62050</td><td>37.0</td><td>1.927</td><td>1.834</td><td>1.895</td><td>1.888</td><td>1.995</td><td>1.879</td><td>1.876</td><td>1.999</td><td>1.602</td><td>1.719</td><td>1.737</td><td>1.613</td><td>1.608</td><td>1.571</td><td>1.711</td><td>1.619</td><td>1.546</td><td>1.587</td><td>1.521</td><td>1.488</td><td>1.478</td><td>1.599</td><td>1.551</td><td>1.699</td><td>1.588</td><td>1.701</td><td>1.688</td><td>1.651</td><td>1.65</td><td>1.75</td><td>1.761</td><td>1.718</td><td>1.914</td><td>1.719</td><td>1.776</td><td>1.859</td><td>1.76</td><td>1.833</td><td>1.852</td><td>1.84</td><td>1.618</td><td>1.589</td><td>1.744</td><td>1.673</td><td>1.69</td><td>1.736</td><td>1.731</td><td>1.697</td><td>1.53</td><td>1.494</td><td>1.506</td><td>1.649</td><td>1.537</td><td>1.578</td><td>1.58</td><td>1.555</td><td>1.747</td><td>1.609</td><td>1.703</td><td>1.708</td><td>1.636</td><td>1.655</td><td>1.776</td><td>1.735</td></tr><tr><td>62350</td><td>37.0</td><td>1.931</td><td>1.838</td><td>1.898</td><td>1.889</td><td>1.997</td><td>1.882</td><td>1.877</td><td>1.999</td><td>1.606</td><td>1.724</td><td>1.739</td><td>1.618</td><td>1.612</td><td>1.573</td><td>1.714</td><td>1.622</td><td>1.552</td><td>1.588</td><td>1.524</td><td>1.491</td><td>1.48</td><td>1.602</td><td>1.555</td><td>1.702</td><td>1.589</td><td>1.702</td><td>1.691</td><td>1.652</td><td>1.651</td><td>1.753</td><td>1.763</td><td>1.721</td><td>1.917</td><td>1.722</td><td>1.779</td><td>1.86</td><td>1.763</td><td>1.835</td><td>1.854</td><td>1.841</td><td>1.621</td><td>1.591</td><td>1.745</td><td>1.674</td><td>1.691</td><td>1.738</td><td>1.732</td><td>1.702</td><td>1.534</td><td>1.498</td><td>1.508</td><td>1.642</td><td>1.541</td><td>1.582</td><td>1.581</td><td>1.56</td><td>1.752</td><td>1.611</td><td>1.706</td><td>1.71</td><td>1.641</td><td>1.657</td><td>1.779</td><td>1.738</td></tr><tr><td>62650</td><td>37.1</td><td>1.934</td><td>1.84</td><td>1.902</td><td>1.893</td><td>2.0</td><td>1.883</td><td>1.881</td><td>2.004</td><td>1.608</td><td>1.726</td><td>1.739</td><td>1.617</td><td>1.611</td><td>1.573</td><td>1.715</td><td>1.624</td><td>1.555</td><td>1.592</td><td>1.526</td><td>1.492</td><td>1.483</td><td>1.603</td><td>1.557</td><td>1.704</td><td>1.593</td><td>1.706</td><td>1.693</td><td>1.654</td><td>1.655</td><td>1.752</td><td>1.764</td><td>1.721</td><td>1.919</td><td>1.723</td><td>1.78</td><td>1.861</td><td>1.763</td><td>1.836</td><td>1.855</td><td>1.843</td><td>1.624</td><td>1.593</td><td>1.748</td><td>1.677</td><td>1.694</td><td>1.74</td><td>1.736</td><td>1.703</td><td>1.538</td><td>1.502</td><td>1.513</td><td>1.643</td><td>1.545</td><td>1.585</td><td>1.585</td><td>1.563</td><td>1.758</td><td>1.614</td><td>1.709</td><td>1.712</td><td>1.642</td><td>1.659</td><td>1.781</td><td>1.741</td></tr><tr><td>62950</td><td>37.0</td><td>1.938</td><td>1.843</td><td>1.906</td><td>1.897</td><td>2.002</td><td>1.887</td><td>1.884</td><td>2.005</td><td>1.61</td><td>1.728</td><td>1.742</td><td>1.618</td><td>1.612</td><td>1.575</td><td>1.718</td><td>1.625</td><td>1.561</td><td>1.595</td><td>1.527</td><td>1.496</td><td>1.487</td><td>1.607</td><td>1.559</td><td>1.704</td><td>1.597</td><td>1.706</td><td>1.697</td><td>1.657</td><td>1.658</td><td>1.756</td><td>1.767</td><td>1.726</td><td>1.921</td><td>1.723</td><td>1.78</td><td>1.861</td><td>1.765</td><td>1.837</td><td>1.857</td><td>1.845</td><td>1.628</td><td>1.594</td><td>1.748</td><td>1.678</td><td>1.696</td><td>1.743</td><td>1.737</td><td>1.708</td><td>1.544</td><td>1.506</td><td>1.515</td><td>1.646</td><td>1.549</td><td>1.587</td><td>1.588</td><td>1.569</td><td>1.767</td><td>1.621</td><td>1.714</td><td>1.717</td><td>1.648</td><td>1.664</td><td>1.786</td><td>1.746</td></tr><tr><td>63250</td><td>37.0</td><td>1.941</td><td>1.847</td><td>1.909</td><td>1.899</td><td>2.005</td><td>1.89</td><td>1.886</td><td>2.007</td><td>1.613</td><td>1.73</td><td>1.742</td><td>1.62</td><td>1.614</td><td>1.576</td><td>1.719</td><td>1.631</td><td>1.565</td><td>1.597</td><td>1.53</td><td>1.499</td><td>1.489</td><td>1.608</td><td>1.563</td><td>1.716</td><td>1.599</td><td>1.708</td><td>1.701</td><td>1.657</td><td>1.659</td><td>1.76</td><td>1.77</td><td>1.727</td><td>1.924</td><td>1.726</td><td>1.783</td><td>1.864</td><td>1.767</td><td>1.84</td><td>1.86</td><td>1.847</td><td>1.631</td><td>1.595</td><td>1.75</td><td>1.679</td><td>1.698</td><td>1.744</td><td>1.74</td><td>1.709</td><td>1.549</td><td>1.509</td><td>1.519</td><td>1.649</td><td>1.549</td><td>1.585</td><td>1.589</td><td>1.573</td><td>1.773</td><td>1.623</td><td>1.717</td><td>1.718</td><td>1.651</td><td>1.666</td><td>1.788</td><td>1.749</td></tr><tr><td>63550</td><td>37.0</td><td>1.943</td><td>1.852</td><td>1.914</td><td>1.905</td><td>2.008</td><td>1.893</td><td>1.89</td><td>2.011</td><td>1.615</td><td>1.732</td><td>1.744</td><td>1.622</td><td>1.616</td><td>1.579</td><td>1.72</td><td>1.633</td><td>1.569</td><td>1.599</td><td>1.532</td><td>1.499</td><td>1.492</td><td>1.611</td><td>1.565</td><td>1.716</td><td>1.602</td><td>1.712</td><td>1.706</td><td>1.661</td><td>1.663</td><td>1.76</td><td>1.771</td><td>1.729</td><td>1.927</td><td>1.726</td><td>1.784</td><td>1.864</td><td>1.768</td><td>1.84</td><td>1.859</td><td>1.849</td><td>1.633</td><td>1.6</td><td>1.752</td><td>1.682</td><td>1.701</td><td>1.747</td><td>1.742</td><td>1.714</td><td>1.554</td><td>1.514</td><td>1.522</td><td>1.653</td><td>1.553</td><td>1.594</td><td>1.591</td><td>1.578</td><td>1.78</td><td>1.626</td><td>1.72</td><td>1.721</td><td>1.654</td><td>1.669</td><td>1.79</td><td>1.754</td></tr><tr><td>63850</td><td>37.0</td><td>1.946</td><td>1.854</td><td>1.916</td><td>1.907</td><td>2.008</td><td>1.893</td><td>1.891</td><td>2.01</td><td>1.617</td><td>1.735</td><td>1.746</td><td>1.623</td><td>1.616</td><td>1.58</td><td>1.722</td><td>1.637</td><td>1.571</td><td>1.603</td><td>1.536</td><td>1.504</td><td>1.494</td><td>1.613</td><td>1.57</td><td>1.722</td><td>1.605</td><td>1.71</td><td>1.706</td><td>1.661</td><td>1.666</td><td>1.763</td><td>1.773</td><td>1.732</td><td>1.928</td><td>1.728</td><td>1.784</td><td>1.865</td><td>1.769</td><td>1.843</td><td>1.863</td><td>1.851</td><td>1.637</td><td>1.6</td><td>1.754</td><td>1.684</td><td>1.702</td><td>1.748</td><td>1.744</td><td>1.715</td><td>1.557</td><td>1.516</td><td>1.516</td><td>1.652</td><td>1.551</td><td>1.596</td><td>1.59</td><td>1.58</td><td>1.786</td><td>1.63</td><td>1.724</td><td>1.721</td><td>1.656</td><td>1.671</td><td>1.793</td><td>1.758</td></tr><tr><td>64150</td><td>37.0</td><td>1.949</td><td>1.859</td><td>1.921</td><td>1.913</td><td>2.012</td><td>1.898</td><td>1.895</td><td>2.015</td><td>1.618</td><td>1.734</td><td>1.745</td><td>1.622</td><td>1.616</td><td>1.579</td><td>1.72</td><td>1.636</td><td>1.574</td><td>1.604</td><td>1.538</td><td>1.505</td><td>1.496</td><td>1.615</td><td>1.571</td><td>1.719</td><td>1.608</td><td>1.716</td><td>1.71</td><td>1.664</td><td>1.669</td><td>1.765</td><td>1.774</td><td>1.732</td><td>1.931</td><td>1.728</td><td>1.786</td><td>1.865</td><td>1.77</td><td>1.843</td><td>1.863</td><td>1.851</td><td>1.641</td><td>1.603</td><td>1.758</td><td>1.688</td><td>1.706</td><td>1.752</td><td>1.747</td><td>1.718</td><td>1.56</td><td>1.518</td><td>1.522</td><td>1.654</td><td>1.551</td><td>1.596</td><td>1.59</td><td>1.581</td><td>1.79</td><td>1.632</td><td>1.727</td><td>1.725</td><td>1.659</td><td>1.671</td><td>1.795</td><td>1.761</td></tr><tr><td>64450</td><td>37.0</td><td>1.953</td><td>1.861</td><td>1.922</td><td>1.914</td><td>2.013</td><td>1.899</td><td>1.896</td><td>2.014</td><td>1.622</td><td>1.738</td><td>1.749</td><td>1.625</td><td>1.618</td><td>1.582</td><td>1.724</td><td>1.641</td><td>1.58</td><td>1.606</td><td>1.54</td><td>1.509</td><td>1.499</td><td>1.617</td><td>1.574</td><td>1.722</td><td>1.612</td><td>1.716</td><td>1.711</td><td>1.664</td><td>1.672</td><td>1.769</td><td>1.776</td><td>1.736</td><td>1.932</td><td>1.73</td><td>1.787</td><td>1.867</td><td>1.772</td><td>1.846</td><td>1.867</td><td>1.853</td><td>1.645</td><td>1.603</td><td>1.758</td><td>1.689</td><td>1.706</td><td>1.753</td><td>1.748</td><td>1.72</td><td>1.565</td><td>1.522</td><td>1.524</td><td>1.655</td><td>1.551</td><td>1.596</td><td>1.591</td><td>1.583</td><td>1.798</td><td>1.637</td><td>1.732</td><td>1.728</td><td>1.664</td><td>1.676</td><td>1.798</td><td>1.764</td></tr><tr><td>64750</td><td>37.0</td><td>1.955</td><td>1.866</td><td>1.926</td><td>1.919</td><td>2.017</td><td>1.903</td><td>1.899</td><td>2.018</td><td>1.624</td><td>1.739</td><td>1.749</td><td>1.626</td><td>1.618</td><td>1.583</td><td>1.725</td><td>1.645</td><td>1.583</td><td>1.609</td><td>1.543</td><td>1.512</td><td>1.499</td><td>1.618</td><td>1.576</td><td>1.727</td><td>1.615</td><td>1.718</td><td>1.714</td><td>1.666</td><td>1.673</td><td>1.77</td><td>1.778</td><td>1.738</td><td>1.935</td><td>1.731</td><td>1.789</td><td>1.868</td><td>1.774</td><td>1.848</td><td>1.869</td><td>1.855</td><td>1.648</td><td>1.604</td><td>1.76</td><td>1.688</td><td>1.708</td><td>1.754</td><td>1.749</td><td>1.724</td><td>1.567</td><td>1.525</td><td>1.526</td><td>1.655</td><td>1.552</td><td>1.597</td><td>1.593</td><td>1.586</td><td>1.805</td><td>1.641</td><td>1.736</td><td>1.731</td><td>1.667</td><td>1.679</td><td>1.8</td><td>1.769</td></tr><tr><td>65050</td><td>37.0</td><td>1.958</td><td>1.868</td><td>1.929</td><td>1.922</td><td>2.018</td><td>1.906</td><td>1.903</td><td>2.022</td><td>1.627</td><td>1.74</td><td>1.752</td><td>1.629</td><td>1.62</td><td>1.582</td><td>1.726</td><td>1.647</td><td>1.585</td><td>1.609</td><td>1.543</td><td>1.511</td><td>1.502</td><td>1.619</td><td>1.579</td><td>1.726</td><td>1.617</td><td>1.718</td><td>1.716</td><td>1.667</td><td>1.674</td><td>1.773</td><td>1.781</td><td>1.739</td><td>1.938</td><td>1.733</td><td>1.79</td><td>1.869</td><td>1.775</td><td>1.849</td><td>1.87</td><td>1.856</td><td>1.652</td><td>1.606</td><td>1.762</td><td>1.69</td><td>1.709</td><td>1.756</td><td>1.752</td><td>1.726</td><td>1.574</td><td>1.528</td><td>1.528</td><td>1.658</td><td>1.554</td><td>1.598</td><td>1.594</td><td>1.59</td><td>1.809</td><td>1.641</td><td>1.737</td><td>1.732</td><td>1.668</td><td>1.68</td><td>1.803</td><td>1.772</td></tr></tbody></table></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[375]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[376]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;Well&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Experiment&quot;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Well&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;Replicate&quot;</span><span class="p">))</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[376]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (14_105, 5)</small><table border="1" class="dataframe"><thead><tr><th>Time</th><th>Well</th><th>OD</th><th>Experiment</th><th>Replicate</th></tr><tr><td>i64</td><td>str</td><td>f64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>0</td><td>&quot;T600&quot;</td><td>0.0</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>300</td><td>&quot;T600&quot;</td><td>0.2</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>600</td><td>&quot;T600&quot;</td><td>0.1</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>900</td><td>&quot;T600&quot;</td><td>0.1</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>1200</td><td>&quot;T600&quot;</td><td>0.2</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>1500</td><td>&quot;T600&quot;</td><td>0.1</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>1800</td><td>&quot;T600&quot;</td><td>0.1</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>2100</td><td>&quot;T600&quot;</td><td>0.1</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>2400</td><td>&quot;T600&quot;</td><td>0.1</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>2700</td><td>&quot;T600&quot;</td><td>0.1</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>3000</td><td>&quot;T600&quot;</td><td>0.2</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>3300</td><td>&quot;T600&quot;</td><td>0.1</td><td>&quot;T&quot;</td><td>&quot;600&quot;</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>61500</td><td>&quot;H9&quot;</td><td>0.792</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr><tr><td>61800</td><td>&quot;H9&quot;</td><td>0.797</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr><tr><td>62100</td><td>&quot;H9&quot;</td><td>0.8</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr><tr><td>62400</td><td>&quot;H9&quot;</td><td>0.803</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr><tr><td>62700</td><td>&quot;H9&quot;</td><td>0.808</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr><tr><td>63000</td><td>&quot;H9&quot;</td><td>0.811</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr><tr><td>63300</td><td>&quot;H9&quot;</td><td>0.816</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr><tr><td>63600</td><td>&quot;H9&quot;</td><td>0.82</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr><tr><td>63900</td><td>&quot;H9&quot;</td><td>0.823</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr><tr><td>64200</td><td>&quot;H9&quot;</td><td>0.826</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr><tr><td>64500</td><td>&quot;H9&quot;</td><td>0.831</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr><tr><td>64800</td><td>&quot;H9&quot;</td><td>0.834</td><td>&quot;H&quot;</td><td>&quot;9&quot;</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[377]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Experiment&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">30000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[377]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x439f425f0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_103_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_103_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[378]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Experiment&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">15000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[378]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x43a21c670&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_104_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_104_1.png" />
</div>
</div>
<p>R First overnight culture in rich + met (otherwise overnight was in media without met)</p>
<p>r rich</p>
<p>m met</p>
<p>z with Zn</p>
<p>z with B12</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[379]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">,</span> <span class="s2">&quot;Abb&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="s2">&quot;Additive&quot;</span><span class="p">]</span>
<span class="n">conversion</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;Rrm&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich + met, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;met&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;Rr&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;RrZ&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met + Zn, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;zinc&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;Rrb&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met + B12, ++met&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;B12&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;rm&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich + met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;met&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;rz&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;zinc&quot;</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;Rich - met, --met&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;B12&quot;</span><span class="p">]]</span>

<span class="n">exp</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<span class="n">exp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span>

<span class="n">exp</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[379]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (8, 5)</small><table border="1" class="dataframe"><thead><tr><th>Experiment</th><th>Abb</th><th>Description</th><th>Pre-met</th><th>Additive</th></tr><tr><td>str</td><td>str</td><td>str</td><td>bool</td><td>str</td></tr></thead><tbody><tr><td>&quot;A&quot;</td><td>&quot;Rrm&quot;</td><td>&quot;Rich + met, ++‚Ä¶</td><td>true</td><td>&quot;met&quot;</td></tr><tr><td>&quot;B&quot;</td><td>&quot;Rr&quot;</td><td>&quot;Rich - met, ++‚Ä¶</td><td>true</td><td>&quot;none&quot;</td></tr><tr><td>&quot;C&quot;</td><td>&quot;RrZ&quot;</td><td>&quot;Rich - met + Z‚Ä¶</td><td>true</td><td>&quot;zinc&quot;</td></tr><tr><td>&quot;D&quot;</td><td>&quot;Rrb&quot;</td><td>&quot;Rich - met + B‚Ä¶</td><td>true</td><td>&quot;B12&quot;</td></tr><tr><td>&quot;E&quot;</td><td>&quot;rm&quot;</td><td>&quot;Rich + met, --‚Ä¶</td><td>false</td><td>&quot;met&quot;</td></tr><tr><td>&quot;F&quot;</td><td>&quot;r&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;none&quot;</td></tr><tr><td>&quot;G&quot;</td><td>&quot;rz&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;zinc&quot;</td></tr><tr><td>&quot;H&quot;</td><td>&quot;rb&quot;</td><td>&quot;Rich - met, --‚Ä¶</td><td>false</td><td>&quot;B12&quot;</td></tr></tbody></table></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[380]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Experiment&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[381]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Replicate&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">15000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[381]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x43a6577f0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_108_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_108_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[382]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span>  <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">15000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[382]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x3fe5b0df0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_109_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_109_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[383]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pdf</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">15000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">))</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[384]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pdf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[384]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x43aca2dd0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_111_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_111_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[385]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Additive&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Pre-met&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">15000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[385]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.FacetGrid at 0x43aca2bc0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_cofactors_growth_rates-old_112_1.png" src="../../_images/notebooks_cofactors_growth_rates-old_112_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[386]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/adrian_growth_jan25_indicator.csv&quot;</span><span class="p">)</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;experiment&quot;</span><span class="p">)</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">drop_nulls</span><span class="p">()</span>
<span class="n">meta</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[386]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (64, 3)</small><table border="1" class="dataframe"><thead><tr><th>row</th><th>col</th><th>experiment</th></tr><tr><td>str</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;A&quot;</td><td>&quot;2&quot;</td><td>&quot;Rrm1&quot;</td></tr><tr><td>&quot;B&quot;</td><td>&quot;2&quot;</td><td>&quot;Rr1&quot;</td></tr><tr><td>&quot;C&quot;</td><td>&quot;2&quot;</td><td>&quot;RrZ1&quot;</td></tr><tr><td>&quot;D&quot;</td><td>&quot;2&quot;</td><td>&quot;Rrb1&quot;</td></tr><tr><td>&quot;E&quot;</td><td>&quot;2&quot;</td><td>&quot;rm1&quot;</td></tr><tr><td>&quot;F&quot;</td><td>&quot;2&quot;</td><td>&quot;r1&quot;</td></tr><tr><td>&quot;G&quot;</td><td>&quot;2&quot;</td><td>&quot;rz1&quot;</td></tr><tr><td>&quot;H&quot;</td><td>&quot;2&quot;</td><td>&quot;rb1&quot;</td></tr><tr><td>&quot;A&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrm2&quot;</td></tr><tr><td>&quot;B&quot;</td><td>&quot;3&quot;</td><td>&quot;Rr2&quot;</td></tr><tr><td>&quot;C&quot;</td><td>&quot;3&quot;</td><td>&quot;RrZ2&quot;</td></tr><tr><td>&quot;D&quot;</td><td>&quot;3&quot;</td><td>&quot;Rrb2&quot;</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;E&quot;</td><td>&quot;8&quot;</td><td>&quot;rm7&quot;</td></tr><tr><td>&quot;F&quot;</td><td>&quot;8&quot;</td><td>&quot;r7&quot;</td></tr><tr><td>&quot;G&quot;</td><td>&quot;8&quot;</td><td>&quot;rz7&quot;</td></tr><tr><td>&quot;H&quot;</td><td>&quot;8&quot;</td><td>&quot;rb7&quot;</td></tr><tr><td>&quot;A&quot;</td><td>&quot;9&quot;</td><td>&quot;Rrm8&quot;</td></tr><tr><td>&quot;B&quot;</td><td>&quot;9&quot;</td><td>&quot;Rr8&quot;</td></tr><tr><td>&quot;C&quot;</td><td>&quot;9&quot;</td><td>&quot;RrZ8&quot;</td></tr><tr><td>&quot;D&quot;</td><td>&quot;9&quot;</td><td>&quot;Rrb8&quot;</td></tr><tr><td>&quot;E&quot;</td><td>&quot;9&quot;</td><td>&quot;rm8&quot;</td></tr><tr><td>&quot;F&quot;</td><td>&quot;9&quot;</td><td>&quot;r8&quot;</td></tr><tr><td>&quot;G&quot;</td><td>&quot;9&quot;</td><td>&quot;rz8&quot;</td></tr><tr><td>&quot;H&quot;</td><td>&quot;9&quot;</td><td>&quot;rb8&quot;</td></tr></tbody></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[387]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/adrian_growth_jan25_v2.csv&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;T‚àû 600&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="nb">format</span><span class="o">=</span> <span class="s1">&#39;%H:%M:%S&#39;</span><span class="p">,</span> <span class="n">coerce</span><span class="o">=</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-cyan-fg">  Cell </span><span class="ansi-green-fg">In[387], line 3</span>
<span class="ansi-red-fg">    df[&#34;Time&#34;] = pd.to_datetime(df[&#39;Time&#39;],format= &#39;%H:%M:%S&#39;, coerce=).dt.time</span>
                                                                      ^
<span class="ansi-red-fg">SyntaxError</span><span class="ansi-red-fg">:</span> invalid syntax

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="nb">format</span><span class="o">=</span> <span class="s1">&#39;%H:%M:%S&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;growth_data/adrian_growth_jan24.csv&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;Series1&quot;</span><span class="p">,</span> <span class="s2">&quot;Series2&quot;</span><span class="p">,</span> <span class="s2">&quot;Series3&quot;</span><span class="p">,</span> <span class="s2">&quot;Series4&quot;</span><span class="p">,</span> <span class="s2">&quot;Series5&quot;</span><span class="p">,</span> <span class="s2">&quot;Series6&quot;</span><span class="p">,</span> <span class="s2">&quot;Time_seconds&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Time_seconds&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Series&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Time_seconds&quot;</span><span class="p">:</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="s2">&quot;Experiment&quot;</span><span class="p">})</span>

<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;RM&quot;</span><span class="p">:</span> <span class="s2">&quot;+met&quot;</span><span class="p">,</span> <span class="s2">&quot;RZ&quot;</span><span class="p">:</span> <span class="s2">&quot;+Zn&quot;</span><span class="p">,</span> <span class="s2">&quot;RB&quot;</span><span class="p">:</span> <span class="s2">&quot;+B12&quot;</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">:</span> <span class="s2">&quot;-met&quot;</span><span class="p">,</span> <span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_truncated</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">df_truncated</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_truncated</span><span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;+B12&quot;</span><span class="p">,</span> <span class="s2">&quot;+Zn&quot;</span><span class="p">]),</span> <span class="s2">&quot;Time&quot;</span><span class="p">]</span> <span class="o">=</span> \
<span class="n">df_truncated</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_truncated</span><span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;+B12&quot;</span><span class="p">,</span> <span class="s2">&quot;+Zn&quot;</span><span class="p">]),</span> <span class="s2">&quot;Time&quot;</span><span class="p">]</span> <span class="o">+</span><span class="mi">1100</span>


<span class="n">df_truncated</span> <span class="o">=</span> <span class="n">df_truncated</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_truncated</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">7500</span><span class="p">,</span> <span class="mi">100000</span><span class="p">),</span> <span class="p">:]</span>


<span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Experiment&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_truncated</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_truncated</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">df_truncated</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_truncated</span><span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;+B12&quot;</span><span class="p">,</span> <span class="s2">&quot;+Zn&quot;</span><span class="p">]),</span> <span class="s2">&quot;Time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_truncated</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_truncated</span><span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;+B12&quot;</span><span class="p">,</span> <span class="s2">&quot;+Zn&quot;</span><span class="p">]),</span> <span class="s2">&quot;Time&quot;</span><span class="p">]</span> <span class="o">+</span><span class="mi">1000</span>

<span class="n">df_truncated</span> <span class="o">=</span> <span class="n">df_truncated</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_truncated</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">7500</span><span class="p">,</span> <span class="mi">20000</span><span class="p">),</span> <span class="p">:]</span>



<span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;OD&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Experiment&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Series&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Experiment&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_truncated</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2024, The Vivarium E. coli Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>